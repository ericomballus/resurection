(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[9754],{9754:(t,e,s)=>{"use strict";s.r(e),s.d(e,{ProductResourceItemPageModule:()=>Z});var o=s(1511),n=s(6073),i=s(8777),r=s(8158),l=s(4762),c=s(1572),a=s(4892),u=s(731),d=s(1611),h=s(1064);function g(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",10),c.TgZ(1,"ion-label"),c._uU(2),c.qZA(),c.TgZ(3,"ion-button",11),c.NdJ("click",function(){c.CHM(t);const s=e.$implicit;return c.oxw(2).updateStore(s)}),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"ion-label"),c.TgZ(7,"p",12),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"p",13),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(2),c.hij(" ",t.name,""),c.xp6(2),c.Oqu(c.lcZ(5,7,"MENU.update_store")),c.xp6(4),c.lnq(" ",c.lcZ(9,9,"MENU.in_stock"),": ",t.quantityItems," ",t.unitName," "),c.xp6(3),c.AsE(" ",c.lcZ(12,11,"MENU.in_store"),": ",t.quantityStore," ")}}function m(t,e){if(1&t&&(c.TgZ(0,"ion-list",8),c._UZ(1,"ion-list-header"),c.YNc(2,g,13,13,"ion-item",9),c.qZA()),2&t){const t=c.oxw();c.Q6J("hidden",!t.btnProducts),c.xp6(2),c.Q6J("ngForOf",t.resources)}}function p(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",10),c.TgZ(1,"ion-avatar",2),c._UZ(2,"img",14),c.qZA(),c.TgZ(3,"ion-button",15),c.NdJ("click",function(){c.CHM(t);const s=e.$implicit;return c.oxw(2).updateStoreResto(s)}),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.TgZ(6,"ion-label"),c.TgZ(7,"p",12),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"p",13),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(2),c.s9C("src",t.url,c.LSH),c.xp6(2),c.Oqu(c.lcZ(5,6,"MENU.update_store")),c.xp6(4),c.AsE(" ",c.lcZ(9,8,"MENU.in_stock"),": ",t.quantityItems," "),c.xp6(3),c.AsE(" ",c.lcZ(12,10,"MENU.in_store"),": ",t.quantityStore," ")}}function f(t,e){if(1&t&&(c.TgZ(0,"ion-list",8),c._UZ(1,"ion-list-header"),c.YNc(2,p,13,12,"ion-item",9),c.qZA()),2&t){const t=c.oxw();c.Q6J("hidden",!t.btnResto),c.xp6(2),c.Q6J("ngForOf",t.productResto)}}const b=[{path:"",component:(()=>{class t{constructor(t,e,s,o,n,i,r,l,c){this.modalController=t,this.alertController=e,this.actionSheetController=s,this.toastController=o,this.socket=n,this.router=i,this.translateConfigService=r,this.resourceService=l,this.translate=c,this.tabRoles=[],this.num=2,this.btnProducts=!0,this.btnResto=!1,JSON.parse(localStorage.getItem("user")).name&&(this.userName=JSON.parse(localStorage.getItem("user")).name),this.tabRoles=JSON.parse(localStorage.getItem("roles")),(this.tabRoles.includes(1)||this.tabRoles.includes(3)||this.tabRoles.includes(2))&&(this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId)),this.languageChanged()}ngOnInit(){this.languageChanged(),this.getResources()}languageChanged(){console.log("lang shop page");let t=localStorage.getItem("language");t&&this.translateConfigService.setLanguage(t)}getResources(){this.resourceService.getResources().subscribe(t=>{console.log(t),this.resources=t.resources,this.resources.forEach(t=>{t.quantityItems=0,this.resourceService.getResourcesItem().subscribe(e=>{console.log(e),e.resources.forEach(e=>{t.quantityItems=t.quantityItems+e.quantity})})})})}webServerSocket(t){this.socket.connect(),this.socket.emit("set-name",name),this.socket.fromEvent(`${t}newProductItem`).subscribe(t=>(0,l.mG)(this,void 0,void 0,function*(){this.productsItem.unshift(t)})),this.socket.fromEvent(`${t}productItem`).subscribe(t=>(0,l.mG)(this,void 0,void 0,function*(){if(console.log("pack item change ",t),t&&t._id){let e=yield this.productsItem.findIndex(e=>e._id===t._id);this.productsItem.splice(e,1,t)}})),this.socket.fromEvent(`${t}productItemDelete`).subscribe(t=>(0,l.mG)(this,void 0,void 0,function*(){console.log("items delete",t)})),this.socket.fromEvent(`${t}manufacturedItem`).subscribe(t=>(0,l.mG)(this,void 0,void 0,function*(){if(console.log("manufactured item",t),t&&t._id){let e=yield this.productResto.findIndex(e=>e._id===t._id);this.productResto.splice(e,1,t)}}))}updateStore(t){return(0,l.mG)(this,void 0,void 0,function*(){let e={};this.translate.get("add").subscribe(t=>{e.title=t}),this.translate.get("cancel").subscribe(t=>{e.cancel=t}),this.translate.get("placeholder").subscribe(t=>{e.placeholder=t});const s=yield this.alertController.create({header:`Available ${t.quantityItems}`,inputs:[{name:"quantity",type:"number",placeholder:"quantity"}],buttons:[{text:e.cancel,role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:e.title,handler:e=>{console.log("Confirm Ok"),console.log(e),this.resourceService.addUserResourcesItem({resourceId:t._id,quantity:parseInt(e.quantity),name:t.name,unitName:t.unitName}).subscribe(t=>{console.log(t),this.getResources()},t=>{console.log(t)})}}]});yield s.present()})}callShowMessage(){this.updateStore(this.translate.instant("toast.message.available"))}updateStoreResto(t){return(0,l.mG)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:`Avaible ${t.quantityItems}`,inputs:[{name:"quantity",type:"number",placeholder:"Enter quantity"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:e=>{console.log("Confirm Ok"),console.log(e),t.quantityItems-parseInt(e.quantity)<0&&this.presentAlert()}}]});yield e.present()})}presentAlert(){return(0,l.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"ALERT",message:"NOT ENOUGTH IN STOCK.",cssClass:"AlertStock",buttons:["OK"]});yield t.present()})}segmentChanged(t){console.log("Segment changed",t.target.value);let e=t.target.value;"product"===e?(this.btnProducts=!0,this.btnResto=!1):"productResto"===e&&(this.btnResto=!0,this.btnProducts=!1)}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(r.IN),c.Y36(r.Br),c.Y36(r.BX),c.Y36(r.yF),c.Y36(a.sk),c.Y36(i.F0),c.Y36(u.w),c.Y36(d.z),c.Y36(h.sK))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-product-resource-item"]],decls:20,vars:11,consts:[[1,"titre"],["slot","end"],["slot","start"],["autoHide","false"],["color","tertiary",3,"ionChange"],["value","product","checked",""],["value","productResto"],["lines","full",3,"hidden",4,"ngIf"],["lines","full",3,"hidden"],["lines","full",4,"ngFor","ngForOf"],["lines","full"],["fill","outline","size","small","slot","end",1,"btnWarehouse",3,"click"],[1,"instock"],[1,"instore"],[3,"src"],["fill","outline","slot","end",3,"click"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title",0),c._uU(3),c.ALo(4,"translate"),c.qZA(),c._UZ(5,"ion-buttons",1),c.TgZ(6,"ion-buttons",2),c._UZ(7,"ion-menu-button",3),c.qZA(),c.qZA(),c.qZA(),c.TgZ(8,"ion-content"),c.TgZ(9,"ion-segment",4),c.NdJ("ionChange",function(t){return e.segmentChanged(t)}),c.TgZ(10,"ion-segment-button",5),c.TgZ(11,"ion-label"),c._uU(12),c.ALo(13,"translate"),c.qZA(),c.qZA(),c.TgZ(14,"ion-segment-button",6),c.TgZ(15,"ion-label"),c._uU(16),c.ALo(17,"translate"),c.qZA(),c.qZA(),c.qZA(),c.YNc(18,m,3,2,"ion-list",7),c.YNc(19,f,3,2,"ion-list",7),c.qZA()),2&t&&(c.xp6(3),c.Oqu(c.lcZ(4,5,"MENU.item_resource")),c.xp6(9),c.Oqu(c.lcZ(13,7,"MENU.drinks")),c.xp6(4),c.Oqu(c.lcZ(17,9,"MENU.dishes")),c.xp6(2),c.Q6J("ngIf",e.resources),c.xp6(1),c.Q6J("ngIf",e.productsItem))},directives:[r.Gu,r.sr,r.wd,r.Sm,r.fG,r.W2,r.cJ,r.QI,r.GO,r.Q$,o.O5,r.q_,r.yh,o.sg,r.Ie,r.YG,r.BJ],pipes:[h.X$],styles:[".instock[_ngcontent-%COMP%], .instore[_ngcontent-%COMP%]{font-size:60%;font-weight:700}.instore[_ngcontent-%COMP%]{color:#1c74f7}.btnWarehouse[_ngcontent-%COMP%]{font-size:50%}"]}),t})()}];let Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.ez,n.u5,r.Pc,i.Bz.forChild(b),h.aw.forChild()]]}),t})()}}]);