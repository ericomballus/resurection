(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[4072],{4418:(t,e,o)=>{"use strict";o.d(e,{W:()=>a});var n=o(1344),i=o.n(n),s=o(8512),r=o(1572),c=o(2968);let a=(()=>{class t{constructor(t){this.urlService=t,this.mysocket=new s.X(null),this.sock=!1,this.takeUrl()}takeUrl(){console.log("je demmare ici url"),this.urlService.getUrl().subscribe(t=>{this.url=t,this.adminId=localStorage.getItem("adminId"),this.sockets=i()(this.url),this.mysocket.next(this.sockets)})}getSocket(){return this.mysocket}disconnectSocket(){this.sockets.disconnect()}getMySocket(){return this.sockets}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(c.i))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},1044:(t,e,o)=>{"use strict";o.d(e,{n:()=>r});var n=o(4762),i=o(1572),s=o(9719);let r=(()=>{class t{constructor(t){this.getStoreName=t}rangeProductByStore(t){return new Promise((e,o)=>{let i=t.reduce((t,e)=>(t[e.storeId]=[...t[e.storeId]||[],e],t),{}),s=[];for(const t in i)s.push(i[t]);s.forEach(t=>(0,n.mG)(this,void 0,void 0,function*(){let e=yield this.getStoreName.takeName(t);t.storeName=e})),e(s)})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(s.$))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4072:(t,e,o)=>{"use strict";o.r(e),o.d(e,{WharehousePageModule:()=>V});var n=o(1511),i=o(6073),s=o(8777),r=o(8158),c=o(4762),a=o(857),l=o(1572),d=o(4144),u=o(731),g=o(866),p=o(1064),h=o(5946),m=o(2968),f=o(9719),Z=o(1611),S=o(1044),v=o(4418),q=o(8732),T=o(4375);const b=function(t){return{"background-color":t}};function I(t,e){if(1&t&&(l.TgZ(0,"ion-row",5),l.TgZ(1,"ion-col",1),l.TgZ(2,"div",6),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",1),l.TgZ(5,"div",7),l._uU(6),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",1),l.TgZ(8,"div",7),l._uU(9),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",1),l.TgZ(11,"div",7),l._uU(12),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",3),l.TgZ(14,"div",7),l._uU(15),l.qZA(),l.qZA(),l.TgZ(16,"ion-col",3),l.TgZ(17,"div",7),l._uU(18),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(10,b,t.quantityItems<=t.quantityToAlert?"red":"white")),l.xp6(3),l.hij(" ",t.name," "),l.xp6(3),l.AsE(" ",t.cassier?t.cassier:0," cassier ",t.btls?t.btls:0," btl "),l.xp6(3),l.AsE(" ",t.cassierStore?t.cassierStore:0," cassier ",t.btlsStore?t.btlsStore:0," btl "),l.xp6(3),l.AsE(" ",t.cassierTotal?t.cassierTotal:0," cassier ",t.btlsTotal?t.btlsTotal:0," btl "),l.xp6(3),l.hij(" ",t.consigne," "),l.xp6(3),l.hij(" ",t.ristourneGenerate," ")}}let A=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-displaystock"]],inputs:{products:"products"},decls:23,vars:10,consts:[[1,"header-component"],["size-sm","3","size-md","3","size-lg","2"],[1,"ion-text-center"],["size-lg","2",1,"ion-hide-lg-down"],["class","data-row data-update",3,"ngStyle",4,"ngFor","ngForOf"],[1,"data-row","data-update",3,"ngStyle"],[1,"ion-text-start","ion-text-uppercase","smallSize"],[1,"ion-text-center","ion-text-uppercase","smallSize"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-row",0),l.TgZ(1,"ion-col",1),l.TgZ(2,"div",2),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.qZA(),l.TgZ(5,"ion-col",1),l.TgZ(6,"div",2),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.qZA(),l.TgZ(9,"ion-col",1),l.TgZ(10,"div",2),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",1),l.TgZ(14,"div",2),l._uU(15,"Total"),l.qZA(),l.qZA(),l.TgZ(16,"ion-col",3),l.TgZ(17,"div",2),l._uU(18,"consigne"),l.qZA(),l.qZA(),l.TgZ(19,"ion-col",3),l.TgZ(20,"div",2),l._uU(21,"ristourne"),l.qZA(),l.qZA(),l.qZA(),l.YNc(22,I,19,12,"ion-row",4)),2&t&&(l.xp6(3),l.Oqu(l.lcZ(4,4,"MENU.name")),l.xp6(4),l.Oqu(l.lcZ(8,6,"MENU.warehouse")),l.xp6(4),l.Oqu(l.lcZ(12,8,"MENU.in_stock")),l.xp6(11),l.Q6J("ngForOf",e.products))},directives:[r.Nd,r.wI,n.sg,n.PC],pipes:[p.X$],styles:[".round[_ngcontent-%COMP%]{--width:3px;--height:3px;--vertical-align:middle;margin:5px;font-size:9px}.h3[_ngcontent-%COMP%]{text-transform:uppercase}.productname[_ngcontent-%COMP%]{background-color:#f1f1f1;font-size:10px}.montant[_ngcontent-%COMP%], .productname[_ngcontent-%COMP%]{font-weight:700}.divprod[_ngcontent-%COMP%]{width:100%}ion-col[_ngcontent-%COMP%]   .inte[_ngcontent-%COMP%]{font-size:9px}.data-lastrow[_ngcontent-%COMP%]{background-color:#f1f1f1}.data-lastrow[_ngcontent-%COMP%], .header-component[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.header-component[_ngcontent-%COMP%]{background-color:#202020;color:#fff;text-transform:uppercase}.header-component[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:11px}.calcul[_ngcontent-%COMP%]{border:1px solid #f1f1f1}.pad[_ngcontent-%COMP%]{padding-top:15px}.header-row[_ngcontent-%COMP%]{background-color:#f1f1f1;color:#000}.smalle[_ngcontent-%COMP%]{font-weight:700;font-size:15px;padding:5px}.smallSize[_ngcontent-%COMP%]{font-size:10px}.offline[_ngcontent-%COMP%]{color:red}.online[_ngcontent-%COMP%]{color:#12f312}.userconnect[_ngcontent-%COMP%]{margin-top:35px}.enable[_ngcontent-%COMP%]{color:#1f8df3}ion-input[_ngcontent-%COMP%]{--background:#f1f1f1;--padding-start:15px;--padding-end:15px;--padding-top:15px;--padding-bottom:15px;font-weight:700}ion-col[_ngcontent-%COMP%]   .commande[_ngcontent-%COMP%], ion-input[_ngcontent-%COMP%]{font-size:11px}"]}),t})();const _=function(t){return{"background-color":t}};function y(t,e){if(1&t&&(l.TgZ(0,"ion-row",6),l.TgZ(1,"ion-col",1),l.TgZ(2,"div",7),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",3),l.TgZ(5,"div",8),l._uU(6),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",4),l.TgZ(8,"div",8),l._uU(9),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",4),l.TgZ(11,"div",8),l._uU(12),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",4),l.TgZ(14,"div",8),l._uU(15),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(7,_,e.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.hij(" ",t.name," "),l.xp6(3),l.AsE(" ",t.sizeUnit,"",t.unitName," "),l.xp6(3),l.hij(" ",t.quantityItems," "),l.xp6(3),l.hij(" ",t.quantityStoreFixed," "),l.xp6(3),l.hij(" ",t.total," ")}}let C=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-resources"]],inputs:{products:"products"},decls:17,vars:1,consts:[[1,"header-component"],["size-sm","2","size-md","2","size-lg","2"],[1,"ion-text-center"],["size-sm","1","size-md","1","size-lg","1"],["size-sm","3","size-md","3","size-lg","3"],["class","data-row data-update",3,"ngStyle",4,"ngFor","ngForOf"],[1,"data-row","data-update",3,"ngStyle"],[1,"ion-text-start","ion-text-uppercase","smallSize"],[1,"ion-text-center","ion-text-uppercase","smallSize"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-row",0),l.TgZ(1,"ion-col",1),l.TgZ(2,"div",2),l._uU(3,"name"),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",3),l.TgZ(5,"div",2),l._uU(6,"Unit"),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",4),l.TgZ(8,"div",2),l._uU(9,"En stock"),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",4),l.TgZ(11,"div",2),l._uU(12,"En vente"),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",4),l.TgZ(14,"div",2),l._uU(15,"Total"),l.qZA(),l.qZA(),l.qZA(),l.YNc(16,y,16,9,"ion-row",5)),2&t&&(l.xp6(16),l.Q6J("ngForOf",e.products))},directives:[r.Nd,r.wI,n.sg,n.PC],styles:[".round[_ngcontent-%COMP%]{--width:3px;--height:3px;--vertical-align:middle;margin:5px;font-size:9px}.h3[_ngcontent-%COMP%]{text-transform:uppercase}.productname[_ngcontent-%COMP%]{background-color:#f1f1f1;font-size:10px}.montant[_ngcontent-%COMP%], .productname[_ngcontent-%COMP%]{font-weight:700}.divprod[_ngcontent-%COMP%]{width:100%}ion-col[_ngcontent-%COMP%]   .inte[_ngcontent-%COMP%]{font-size:9px}.data-lastrow[_ngcontent-%COMP%]{background-color:#f1f1f1}.data-lastrow[_ngcontent-%COMP%], .header-component[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.header-component[_ngcontent-%COMP%]{background-color:#202020;color:#fff;text-transform:uppercase}.header-component[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:11px}.calcul[_ngcontent-%COMP%]{border:1px solid #f1f1f1}.pad[_ngcontent-%COMP%]{padding-top:15px}.header-row[_ngcontent-%COMP%]{background-color:#f1f1f1;color:#000}.smalle[_ngcontent-%COMP%]{font-weight:700;font-size:15px;padding:5px}.smallSize[_ngcontent-%COMP%]{font-size:11px;text-align:center}.offline[_ngcontent-%COMP%]{color:red}.online[_ngcontent-%COMP%]{color:#12f312}.userconnect[_ngcontent-%COMP%]{margin-top:35px}.enable[_ngcontent-%COMP%]{color:#1f8df3}ion-input[_ngcontent-%COMP%]{--background:#f1f1f1;--padding-start:15px;--padding-end:15px;--padding-top:15px;--padding-bottom:15px;font-weight:700}ion-col[_ngcontent-%COMP%]   .commande[_ngcontent-%COMP%], ion-input[_ngcontent-%COMP%]{font-size:11px}"]}),t})();function x(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"ion-button",11),l.NdJ("click",function(){return l.CHM(t),l.oxw().router.navigateByUrl("ravitaillement")}),l._uU(1," Ravitaillement "),l.qZA()}}function O(t,e){1&t&&l._UZ(0,"ion-back-button",12)}function P(t,e){1&t&&l._UZ(0,"ion-back-button",13)}function k(t,e){if(1&t&&(l.TgZ(0,"ion-segment-button",16),l._uU(1),l.qZA()),2&t){const t=e.$implicit;l.s9C("value",t),l.xp6(1),l.hij(" ",t," ")}}function w(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"ion-segment",14),l.NdJ("ionChange",function(e){return l.CHM(t),l.oxw().segmentChanged(e)})("ngModelChange",function(e){return l.CHM(t),l.oxw().pet=e}),l.YNc(1,k,2,2,"ion-segment-button",15),l.qZA()}if(2&t){const t=l.oxw();l.s9C("value",t.pet),l.Q6J("ngModel",t.pet),l.xp6(1),l.Q6J("ngForOf",t.storeTypeTab)}}function M(t,e){if(1&t&&(l.TgZ(0,"ion-slide"),l.TgZ(1,"ion-grid"),l.TgZ(2,"ion-row"),l.TgZ(3,"ion-col"),l.TgZ(4,"div",19),l.TgZ(5,"h4"),l._uU(6),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l._UZ(7,"app-displaystock",20),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(6),l.hij("store ",t.storeName?t.storeName:"no name",""),l.xp6(1),l.Q6J("products",t)}}function N(t,e){if(1&t&&(l.TgZ(0,"div"),l.TgZ(1,"ion-slides",17),l.YNc(2,M,8,2,"ion-slide",18),l.qZA(),l.qZA()),2&t){const t=l.oxw();l.xp6(2),l.Q6J("ngForOf",t.multiStoreProductitem)}}const U=function(t){return{"background-color":t}};function z(t,e){if(1&t&&(l.TgZ(0,"ion-row",27),l.TgZ(1,"ion-col",22),l.TgZ(2,"div",28),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",24),l._UZ(5,"div",29),l.qZA(),l.TgZ(6,"ion-col",25),l.TgZ(7,"div",29),l._uU(8),l.qZA(),l.qZA(),l.TgZ(9,"ion-col",25),l.TgZ(10,"div",29),l._uU(11),l.qZA(),l.qZA(),l.TgZ(12,"ion-col",25),l.TgZ(13,"div",29),l._uU(14),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(5,U,e.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.hij(" ",t.name," "),l.xp6(5),l.hij(" ",t.quantityItems," "),l.xp6(3),l.hij(" ",t.quantityStore," "),l.xp6(3),l.hij(" ",t.quantityItems+t.quantityStore," ")}}function R(t,e){if(1&t&&(l.TgZ(0,"ion-slide"),l.TgZ(1,"ion-grid"),l.TgZ(2,"ion-row"),l.TgZ(3,"ion-col"),l.TgZ(4,"div",19),l.TgZ(5,"h4"),l._uU(6),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(7,"ion-row",21),l.TgZ(8,"ion-col",22),l.TgZ(9,"div",23),l._uU(10,"name"),l.qZA(),l.qZA(),l.TgZ(11,"ion-col",24),l.TgZ(12,"div",23),l._uU(13,"Unit"),l.qZA(),l.qZA(),l.TgZ(14,"ion-col",25),l.TgZ(15,"div",23),l._uU(16,"En stock"),l.qZA(),l.qZA(),l.TgZ(17,"ion-col",25),l.TgZ(18,"div",23),l._uU(19,"En vente"),l.qZA(),l.qZA(),l.TgZ(20,"ion-col",25),l.TgZ(21,"div",23),l._uU(22,"Total"),l.qZA(),l.qZA(),l.qZA(),l.YNc(23,z,15,7,"ion-row",26),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(6),l.hij(" store ",t.storeName?t.storeName:"no name"," "),l.xp6(17),l.Q6J("ngForOf",t)}}function J(t,e){if(1&t&&(l.TgZ(0,"ion-slides",17),l.YNc(1,R,24,2,"ion-slide",18),l.qZA()),2&t){const t=l.oxw();l.xp6(1),l.Q6J("ngForOf",t.multiStoreService)}}function Y(t,e){1&t&&(l.TgZ(0,"ion-row",21),l.TgZ(1,"ion-col",22),l.TgZ(2,"div",23),l._uU(3,"name"),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",24),l.TgZ(5,"div",23),l._uU(6,"Unit"),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",25),l.TgZ(8,"div",23),l._uU(9,"En stock"),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",25),l.TgZ(11,"div",23),l._uU(12,"En vente"),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",25),l.TgZ(14,"div",23),l._uU(15,"Total"),l.qZA(),l.qZA(),l.qZA())}function F(t,e){1&t&&(l.TgZ(0,"ion-row",21),l.TgZ(1,"ion-col",22),l.TgZ(2,"div",23),l._uU(3,"name"),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",22),l.TgZ(5,"div",23),l._uU(6,"Pleine"),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",22),l.TgZ(8,"div",23),l._uU(9,"vide"),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",22),l.TgZ(11,"div",23),l._uU(12,"En stock"),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",22),l.TgZ(14,"div",23),l._uU(15,"En vente"),l.qZA(),l.qZA(),l.TgZ(16,"ion-col",22),l.TgZ(17,"div",23),l._uU(18,"Total"),l.qZA(),l.qZA(),l.qZA())}function G(t,e){if(1&t&&(l.TgZ(0,"ion-row",27),l.TgZ(1,"ion-col",22),l.TgZ(2,"div",28),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",24),l._UZ(5,"div",29),l.qZA(),l.TgZ(6,"ion-col",25),l.TgZ(7,"div",29),l._uU(8),l.qZA(),l.qZA(),l.TgZ(9,"ion-col",25),l.TgZ(10,"div",29),l._uU(11),l.qZA(),l.qZA(),l.TgZ(12,"ion-col",25),l.TgZ(13,"div",29),l._uU(14),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(5,U,e.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.hij(" ",t.name," "),l.xp6(5),l.hij(" ",t.quantityItems," "),l.xp6(3),l.hij(" ",t.quantityStore," "),l.xp6(3),l.hij(" ",t.quantityItems+t.quantityStore," ")}}function E(t,e){if(1&t&&(l.TgZ(0,"div"),l.YNc(1,G,15,7,"ion-row",26),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(1),l.Q6J("ngForOf",t)}}function j(t,e){if(1&t&&(l.TgZ(0,"ion-row",27),l.TgZ(1,"ion-col",22),l.TgZ(2,"div",28),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",22),l.TgZ(5,"div",29),l._uU(6),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",22),l.TgZ(8,"div",29),l._uU(9),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",22),l.TgZ(11,"div",29),l._uU(12),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",22),l.TgZ(14,"div",29),l._uU(15),l.qZA(),l.qZA(),l.TgZ(16,"ion-col",22),l.TgZ(17,"div",29),l._uU(18),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(7,U,e.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.hij(" ",t.name," "),l.xp6(3),l.hij(" ",t.bottle_full?t.bottle_full:0," "),l.xp6(3),l.hij(" ",t.bottle_empty?t.bottle_empty:0," "),l.xp6(3),l.hij(" ",t.quantityItems," "),l.xp6(3),l.hij(" ",t.quantityStore," "),l.xp6(3),l.hij(" ",t.quantityItems+t.quantityStore," ")}}function Q(t,e){if(1&t&&(l.TgZ(0,"div"),l.YNc(1,j,19,9,"ion-row",26),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(1),l.Q6J("ngForOf",t)}}function $(t,e){if(1&t&&(l.TgZ(0,"ion-slide"),l.TgZ(1,"ion-grid"),l.TgZ(2,"ion-row"),l.TgZ(3,"ion-col"),l.TgZ(4,"div",19),l.TgZ(5,"h4"),l._uU(6),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.YNc(7,Y,16,0,"ion-row",30),l.YNc(8,F,19,0,"ion-row",30),l.YNc(9,E,2,1,"div",8),l.YNc(10,Q,2,1,"div",8),l.qZA(),l.qZA()),2&t){const t=e.$implicit,o=l.oxw(2);l.xp6(6),l.hij(" store ",t.storeName?t.storeName:"no name"," "),l.xp6(1),l.Q6J("ngIf",!o.saveRandom.getSetting().sale_Gaz),l.xp6(1),l.Q6J("ngIf",o.saveRandom.getSetting().sale_Gaz),l.xp6(1),l.Q6J("ngIf",!o.saveRandom.getSetting().sale_Gaz),l.xp6(1),l.Q6J("ngIf",o.saveRandom.getSetting().sale_Gaz)}}function L(t,e){if(1&t&&(l.TgZ(0,"ion-slides",17),l.YNc(1,$,11,5,"ion-slide",18),l.qZA()),2&t){const t=l.oxw();l.xp6(1),l.Q6J("ngForOf",t.multiStoreList)}}function D(t,e){if(1&t&&l._UZ(0,"app-resources",31),2&t){const t=l.oxw();l.Q6J("products",t.resourceItem)}}let B=(()=>{class t{constructor(t,e,o,n,i,s,r,c,a,l,d,u,g,p,h,m,f,Z){this.restApiService=t,this.modalController=e,this.alertController=o,this.actionSheetController=n,this.toastController=i,this.router=s,this.translateConfigService=r,this.warehouseService=c,this.warehouService=a,this.translate=l,this.adminService=d,this.urlService=u,this.getStoreName=g,this.resourceService=p,this.rangeByStoreService=h,this.manageSocket=m,this.convert=f,this.saveRandom=Z,this.tabRoles=[],this.num=2,this.btnProducts=!0,this.btnResto=!1,this.btnResource=!1,this.lat=0,this.lng=0,this.viewMode="invoices",this.shopAutorisation=!1,this.totalItems=0,this.desktopTab=[],this.transaction=[],this.manageStockWithService=!1,this.vendorRole=!1,this.multiStore=!1,this.multiStoreProductitem=[],this.warehousman=!1,this.storeTypeTab=[],console.log(JSON.parse(localStorage.getItem("user"))),JSON.parse(localStorage.getItem("user"))[0]&&JSON.parse(localStorage.getItem("user"))[0].venderRole&&(this.vendorRole=JSON.parse(localStorage.getItem("user"))[0].venderRole),"true"===localStorage.getItem("manageStockWithService")&&(this.manageStockWithService=!0),JSON.parse(localStorage.getItem("user")).name&&(this.userName=JSON.parse(localStorage.getItem("user")).name),this.tabRoles=JSON.parse(localStorage.getItem("roles")),(this.tabRoles.includes(1)||this.tabRoles.includes(3)||this.tabRoles.includes(2)||this.tabRoles.includes(6))&&(setTimeout(()=>{}),setTimeout(()=>{this.takeProductResto()},2e3)),this.tabRoles.includes(3)&&(this.warehousman=!0),this.languageChanged()}ionViewDidEnter(){this.setting=this.saveRandom.getSetting();let t=JSON.parse(localStorage.getItem("adminUser")).storeType;this.storeTypeTab=this.setting.check_service_quantity?t:t.filter(t=>"services"!==t),(this.storeTypeTab.includes("bar")||this.storeTypeTab.includes("resto"))&&this.storeTypeTab.push("resource"),this.storeTypeTab=this.storeTypeTab.filter(t=>"resto"!=t),this.pet=this.storeTypeTab[0],this.getSetting(),this.takeUrl()}ngOnInit(){}takeUrl(){this.urlService.getUrl().subscribe(t=>{this.url=t,this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId)})}languageChanged(){console.log("lang shop page");let t=localStorage.getItem("language");t&&this.translateConfigService.setLanguage(t)}takeProductItems(){this.restApiService.getProductItem().subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){if(JSON.parse(localStorage.getItem("setting")),this.tabRoles.includes(3)||this.tabRoles.includes(2)){let e=JSON.parse(localStorage.getItem("user")).storeId;console.log(e);const o=t.filter(t=>t.storeId==e&&0==t.resourceList.length);this.productsItem=o}else this.productsItem=t.filter(t=>0==t.resourceList.length);this.productsItem=yield this.convert.convertToPack(this.productsItem),console.log("hello result===>",this.productsItem);let e=this.productsItem.reduce((t,e)=>(t[e.storeId]=[...t[e.storeId]||[],e],t),{});this.multiStoreProductitem=[];for(const t in e)this.multiStoreProductitem.push(e[t]);this.multiStoreProductitem.forEach(t=>(0,c.mG)(this,void 0,void 0,function*(){let e=yield this.getStoreName.takeName(t);t.storeName=e}))}))}webServerSocket(t){this.manageSocket.getSocket().subscribe(e=>{e.on(`${t}productItem`,t=>{if(t.quantityToConfirm>0){let e=t.quantityStore+t.quantityToConfirm,o=e/t.packSize;t.cassier=parseInt((t.quantityItems/t.packSize).toString()),t.btls=t.quantityItems%t.packSize,t.cassierStore=parseInt(o.toString()),t.btlsStore=e%t.packSize}else{let e=t.quantityStore/t.packSize;t.cassier=parseInt((t.quantityItems/t.packSize).toString()),t.btls=t.quantityItems%t.packSize,t.cassierStore=parseInt(e.toString()),t.btlsStore=t.quantityStore%t.packSize}if(t&&t._id){let e=this.productsItem.findIndex(e=>e._id===t._id),o=this.productsItem[e].url;this.productsItem.splice(e,1,t),this.productsItem[e].url=o}}),e.on(`${t}newProductItem`,t=>{console.log("product item check"),this.productsItem.unshift(t)}),e.on(`${t}productItemToWarehouse`,t=>(0,c.mG)(this,void 0,void 0,function*(){if(console.log("pack item change ",t),t&&t._id){let e=t.quantityStore+t.quantityToConfirm,o=e/t.packSize;t.cassier=parseInt((t.quantityItems/t.packSize).toString()),t.btls=t.quantityItems%t.packSize,t.cassierStore=parseInt(o.toString()),t.btlsStore=e%t.packSize;let n=yield this.productsItem.findIndex(e=>e._id===t._id),i=this.productsItem[n].url;this.productsItem.splice(n,1,t),this.productsItem[n].url=i}})),e.on(`${t}productItemToShop`,t=>(0,c.mG)(this,void 0,void 0,function*(){if(console.log("pack item change ti shop ",t),t&&t._id){let e=yield this.productsItem.findIndex(e=>e._id===t._id);console.log("ce qui es la ",this.productsItem[e]),this.productsItem[e].quantityToConfirm=t.quantityToConfirm;let o=this.productsItem[e].url;this.productsItem.splice(e,1,this.productsItem[e]),this.productsItem[e].url=o}})),e.on(`${t}productItemDelete`,t=>(0,c.mG)(this,void 0,void 0,function*(){console.log("items delete",t)})),e.on(`${t}manufacturedItem`,t=>(0,c.mG)(this,void 0,void 0,function*(){if(console.log("manufactured item",t),t&&t._id){let e=yield this.productResto.findIndex(e=>e._id===t._id),o=this.productResto[e].url;this.productResto.splice(e,1,t),this.productResto[e].url=o}})),e.on(`${t}transactionNewItem`,t=>(0,c.mG)(this,void 0,void 0,function*(){console.log("transaction item",t)})),e.on(`${t}productlist`,t=>(0,c.mG)(this,void 0,void 0,function*(){this.takeProductListShop()})),e.on(`${t}billardItem`,t=>(0,c.mG)(this,void 0,void 0,function*(){this.takeProductServiceList()}))})}updateStore(t){return(0,c.mG)(this,void 0,void 0,function*(){if(this.multiStore){console.log(t),this.warehouService.setProductItem(t);const e=yield this.modalController.create({component:a.w,cssClass:"my-custom-class",backdropDismiss:!1,componentProps:{}});return e.onWillDismiss().then(t=>{console.log(t)}),yield e.present()}{let e={};console.log(t),this.translate.get("add").subscribe(t=>{e.title=t}),this.translate.get("cancel").subscribe(t=>{e.cancel=t}),this.translate.get("placeholder").subscribe(t=>{e.placeholder=t});const o=yield this.alertController.create({header:`Available ${t.quantityItems}`,inputs:[{name:"quantity",type:"number",placeholder:"quantity"}],buttons:[{text:e.cancel,role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:e.title,handler:e=>{console.log(e);let o=e;if(t.quantityItems-parseInt(e.quantity)<0)this.presentAlert();else{let n={id:t._id,quantity:parseInt(e.quantity),prod:t,sender:this.userName};this.warehouseService.updateProductItemStore1(n).subscribe(e=>{let n={idprod:t._id,_id:t._id,quantityItems:parseInt(o.quantity),sender:this.userName};this.confirmTransaction(n)},t=>{console.log(t)})}}}]});yield o.present()}})}callShowMessage(){this.updateStore(this.translate.instant("toast.message.available"))}confirmProd(t){console.log(t);let e={idprod:t._id,_id:t._id,quantityItems:parseInt(t.quantityToConfirm),sender:this.userName},o={idprod:t.itemStoreId,_id:t.itemStoreId,quantityItems:parseInt(t.quantityToConfirm),sender:this.userName};this.confirmTransaction(e),this.confirmTransaction(o)}updateStoreResto(t){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:`Avaible ${t.quantityItems}`,inputs:[{name:"quantity",type:"number",placeholder:"Enter quantity"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:e=>{console.log("Confirm Ok"),console.log(e),t.quantityItems-parseInt(e.quantity)<0?this.presentAlert():this.warehouseService.updateManufacturedItemStore({id:t._id,quantity:parseInt(e.quantity),sender:this.userName,productType:t.productType}).subscribe(t=>{console.log(t),localStorage.getItem("manageStockWithService"),this.presentAlertConfirm()},t=>{console.log(t)})}}]});yield e.present()})}presentAlert(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"ALERT",message:"NOT ENOUGTH IN STOCK.",cssClass:"AlertStock",buttons:["OK"]});yield t.present()})}takeProductResto(){this.restApiService.getManufacturedProductItemResto2().subscribe(t=>{if(console.log(t),this.tabRoles.includes(3)||this.tabRoles.includes(2)){let e=JSON.parse(localStorage.getItem("user")).storeId;console.log(e);const o=t.filter(t=>t.storeId==e);this.productResto=o}else this.productResto=t})}segmentChanged(t){console.log("Segment changed",t.target.value);let e=t.target.value;"product"===e?(this.btnProducts=!0,this.btnResto=!1,this.btnResource=!1):"productResto"===e?(this.btnResto=!0,this.btnProducts=!1,this.btnResource=!1):"resourceItem"===e&&(this.btnResto=!1,this.btnProducts=!1,this.btnResource=!0)}getSetting(){this.saveRandom.getSetting().multi_store&&(this.multiStore=!0),this.takeProductItems(),this.getResources(),this.takeProductListShop(),this.takeProductServiceList()}takePackItems(){this.restApiService.getPackItem().subscribe(t=>{t.items.forEach(t=>{t.totalItems=t.quantity*t.itemsInPack}),console.log(t),this.productsItem=t.items})}presentAlertConfirm(){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"update successfuly!.",duration:2e3,position:"top",animated:!0,cssClass:"my-custom-classIn"})).present()})}presentActionSheet(t){return(0,c.mG)(this,void 0,void 0,function*(){console.log(t);const e=yield this.actionSheetController.create({buttons:[{text:"View Details",icon:"heart",handler:()=>{}},{text:"Reset one",icon:"close",handler:()=>{console.log("Cancel clicked"),console.log(t),this.restApiService.resetProductItem({id:t._id}).subscribe(t=>{console.log(t)})}},{text:"Reset all",icon:"close",handler:()=>{console.log("Cancel clicked"),console.log(t),this.productsItem.forEach(t=>{setTimeout(()=>{this.restApiService.resetProductItem({id:t._id}).subscribe(t=>{console.log(t)})},1e3)})}}]});yield e.present()})}presentActionSheet2(t){return(0,c.mG)(this,void 0,void 0,function*(){console.log(t);const e=yield this.actionSheetController.create({buttons:[{text:"View Details",icon:"heart",handler:()=>{}},{text:"Reset",icon:"close",handler:()=>{console.log("Cancel clicked"),console.log(t),this.restApiService.resetManufacturedItem({id:t._id}).subscribe(t=>{console.log(t)})}}]});yield e.present()})}confirmTransactionResto(t,e){console.log(e);let o={id:e.productId,quantity:t.quantityItems,receiver:this.userName};this.adminService.confirmTransaction(t._id,this.userName).subscribe(e=>{t.confirm=!0,t.receiver=this.userName,this.warehouService.updateManufacturedItemStoreConfirm({id:o.id,quantity:t.quantityItems,receiver:this.userName}).subscribe(t=>{console.log(t)})})}confirmTransaction(t){console.log(t),"manufacturedItems"==t.productType?this.adminService.confirmTransaction(t._id,this.userName).subscribe(e=>{t.confirm=!0,t.receiver=this.userName,this.warehouService.updateManufacturedItemStoreConfirm({id:t._id,quantity:t.quantityItems,receiver:this.userName}).subscribe(t=>{console.log(t)})}):(this.userName=JSON.parse(localStorage.getItem("user")).name,this.warehouService.updateProductItemStore({id:t.idprod,quantity:t.quantityItems,receiver:this.userName}).subscribe(e=>{t.confirm=!0,this.adminService.confirmTransaction(t._id,this.userName).subscribe(e=>{this.restApiService.clearProvision(),this.warehouService.confirmProductItemStore({id:t.idprod,receiver:this.userName}).subscribe(t=>{})})}))}presentAlertPrompt(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"closeCash",message:`open: ${this.casgData.cashFund}`,inputs:[{name:"closing_cash",type:"number",placeholder:"closing cash"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:t=>{parseInt(t.cashFund)&&(t.cashFund=parseInt(t.cashFund)),t.closing_cash=parseInt(t.closing_cash)?parseInt(t.closing_cash):0,this.casgData.closing_cash=parseInt(t.closing_cash),this.closeCash(t),console.log(t),console.log(this.casgData)}}]});yield t.present()})}postCashOpen(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"CASH OPEN",inputs:[{name:"cashFund",type:"number"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"alertCancel",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",cssClass:"alertButton",handler:t=>{t&&this.adminService.postCashOpen(t).subscribe(t=>{this.takeCashOpen(),localStorage.removeItem("firstTime"),localStorage.setItem("firstTime","ok"),this.cashOpened=!1,localStorage.setItem("openCashDate",t.message.openDate),this.presentToast("CASH IS OPEN!")})}}]});yield t.present()})}closeCash(t){console.log(this.casgData),this.adminService.closeCashOpen(this.casgData).subscribe(t=>{this.cashOpened=!1,this.presentToast("CASH IS CLOSE!"),localStorage.removeItem("openCashDate")})}takeCashOpen(){this.adminService.getOpenCash().subscribe(t=>{t.docs.length>0?(this.cashOpened=!0,this.openCashDate=t.docs[0].openDate,this.casgData=t.docs[0],this.openCashDateId=t.docs[0]._id,localStorage.setItem("openCashDate",this.openCashDate),localStorage.setItem("openCashDateId",t.docs[0]._id),localStorage.setItem("openCashDateObj",JSON.stringify(t.docs[0]))):this.presentToast("PLEASE OPEN CASH!")})}presentToast(t){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:`${t}`,duration:2e3,position:"top",animated:!0})).present()})}getResources(){this.resourceService.getStoreResourcesItem().subscribe(t=>{console.log(t),this.resourceItem=t.items.filter(t=>0==t.desabled),this.resourceItem.forEach(t=>{t.quantityStore=Number(t.quantityStore),console.log(t.quantityStore),t.quantityStoreFixed=Number.isInteger(t.quantityStore)?t.quantityStore:t.quantityStore.toFixed(2),t.total=Number.isInteger(t.total)?t.quantityStore+t.quantityItems:(t.quantityStore+t.quantityItems).toFixed(2)}),this.rangeByStoreService.rangeProductByStore(this.resourceItem).then(t=>{console.log(t),this.multiStoreResourceitem=t})})}takeProductServiceList(){this.restApiService.getBillardList().subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){if(this.tabRoles.includes(3)||this.tabRoles.includes(2)){let e=JSON.parse(localStorage.getItem("user")).storeId;console.log(e);const o=t.product.filter(t=>t.storeId==e);this.productServiceTab=yield this.rangeByStoreService.rangeProductByStore(o)}else this.productServiceTab=yield this.rangeByStoreService.rangeProductByStore(t.product);this.multiStoreService=this.productServiceTab}))}takeProductListShop(){this.restApiService.getShopList().subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){if(console.log(t),!this.tabRoles.includes(3)&&!this.tabRoles.includes(2)||this.saveRandom.getSetting().manage_expenses)this.productListTab=yield this.rangeByStoreService.rangeProductByStore(t.product);else{let e=JSON.parse(localStorage.getItem("user")).storeId;console.log(e);const o=t.product.filter(t=>t.storeId==e);this.productListTab=yield this.rangeByStoreService.rangeProductByStore(o)}console.log(this.productListTab),this.multiStoreList=this.productListTab}))}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(d.e),l.Y36(r.IN),l.Y36(r.Br),l.Y36(r.BX),l.Y36(r.yF),l.Y36(s.F0),l.Y36(u.w),l.Y36(g.l),l.Y36(g.l),l.Y36(p.sK),l.Y36(h.l),l.Y36(m.i),l.Y36(f.$),l.Y36(Z.z),l.Y36(S.n),l.Y36(v.W),l.Y36(q.k),l.Y36(T.i))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-wharehouse"]],decls:19,vars:12,consts:[["slot","end"],["size","small"],["slot","end","name","contact"],["fill","clear","size","small",3,"click",4,"ngIf"],["slot","start"],["defaultHref","/start",4,"ngIf"],["defaultHref","/vendor-start",4,"ngIf"],["scrollable","",3,"value","ngModel","ionChange","ngModelChange",4,"ngIf"],[4,"ngIf"],["pager","true",4,"ngIf"],["lines","full",3,"products",4,"ngIf"],["fill","clear","size","small",3,"click"],["defaultHref","/start"],["defaultHref","/vendor-start"],["scrollable","",3,"value","ngModel","ionChange","ngModelChange"],["class","btnseg",3,"value",4,"ngFor","ngForOf"],[1,"btnseg",3,"value"],["pager","true"],[4,"ngFor","ngForOf"],[1,"ion-text-center","ion-text-uppercase"],["lines","full",1,"compo",3,"products"],[1,"header-component"],["size-sm","2","size-md","2","size-lg","2"],[1,"ion-text-center"],["size-sm","1","size-md","1","size-lg","1"],["size-sm","3","size-md","3","size-lg","3"],["class","data-row data-update",3,"ngStyle",4,"ngFor","ngForOf"],[1,"data-row","data-update",3,"ngStyle"],[1,"ion-text-start","ion-text-uppercase","smallSize"],[1,"ion-text-center","ion-text-uppercase","smallSize"],["class","header-component",4,"ngIf"],["lines","full",3,"products"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-title"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"ion-buttons",0),l.TgZ(6,"ion-button",1),l._uU(7),l._UZ(8,"ion-icon",2),l.qZA(),l.YNc(9,x,2,0,"ion-button",3),l.qZA(),l.TgZ(10,"ion-buttons",4),l.YNc(11,O,1,0,"ion-back-button",5),l.YNc(12,P,1,0,"ion-back-button",6),l.qZA(),l.qZA(),l.qZA(),l.TgZ(13,"ion-content"),l.YNc(14,w,2,3,"ion-segment",7),l.YNc(15,N,3,1,"div",8),l.YNc(16,J,2,1,"ion-slides",9),l.YNc(17,L,2,1,"ion-slides",9),l.YNc(18,D,1,1,"app-resources",10),l.qZA()),2&t&&(l.xp6(3),l.Oqu(l.lcZ(4,10,"MENU.stock")),l.xp6(4),l.hij(" ",e.userName," "),l.xp6(2),l.Q6J("ngIf",e.warehousman),l.xp6(2),l.Q6J("ngIf",!e.vendorRole&&!e.warehousman),l.xp6(1),l.Q6J("ngIf",e.vendorRole&&!e.warehousman),l.xp6(2),l.Q6J("ngIf",e.storeTypeTab.length>1),l.xp6(1),l.Q6J("ngIf","bar"===e.pet),l.xp6(1),l.Q6J("ngIf","services"===e.pet),l.xp6(1),l.Q6J("ngIf","shop"===e.pet),l.xp6(1),l.Q6J("ngIf",e.resourceItem&&"resource"===e.pet))},directives:[r.Gu,r.sr,r.wd,r.Sm,r.YG,r.gu,n.O5,r.W2,r.oU,r.cs,r.cJ,r.QI,i.JJ,i.On,n.sg,r.GO,r.Hr,r.A$,r.jY,r.Nd,r.wI,A,n.PC,C],pipes:[p.X$],styles:[".instock[_ngcontent-%COMP%], .instore[_ngcontent-%COMP%]{font-size:60%;font-weight:700;display:block}.instore[_ngcontent-%COMP%]{color:#1c74f7}.btnWarehouse[_ngcontent-%COMP%]{font-size:65%}.stock-alert[_ngcontent-%COMP%]{--ion-background-color:#f85252;--color:#fff;opacity:.9}.stock-alert[_ngcontent-%COMP%]   .instock[_ngcontent-%COMP%], .stock-alert[_ngcontent-%COMP%]   .instore[_ngcontent-%COMP%]{color:#fff}.stock-alert[_ngcontent-%COMP%]   .btnWarehouse[_ngcontent-%COMP%]{--border-color:#000;--color:#000}.confirm[_ngcontent-%COMP%]{padding:0;color:red;font-size:10px}.divG[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.compo[_ngcontent-%COMP%]{width:100%}.data-lastrow[_ngcontent-%COMP%]{background-color:#f1f1f1;padding-top:10px;padding-bottom:10px}.header-row[_ngcontent-%COMP%]{background-color:#f1f1f1;color:#000}.smalle[_ngcontent-%COMP%]{font-weight:700;font-size:15px;padding:5px}.smallSize[_ngcontent-%COMP%]{font-size:11px;text-align:center}"]}),t})();var W=o(9547),H=o(3117);const K=[{path:"",component:B}];let V=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[n.ez,i.u5,r.Pc,s.Bz.forChild(K),p.aw.forChild(),W.G,H.K]]}),t})()}}]);