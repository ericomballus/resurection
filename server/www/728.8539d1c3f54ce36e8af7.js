(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[728],{728:(e,t,o)=>{"use strict";o.d(t,{W:()=>A});var i=o(4762),n=o(2034),a=o(3685),r=o(1572),s=o(8158),m=o(2874),l=o(1714),c=o(4375),g=o(1511),d=o(6073);function u(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item",16),r.NdJ("click",function(){return r.CHM(e),r.oxw().pickResource()}),r._UZ(1,"ion-icon",17),r.TgZ(2,"ion-label"),r._uU(3,"Products"),r.qZA(),r.qZA()}}function h(e,t){if(1&e&&r._UZ(0,"ion-input",24),2&e){const e=r.oxw().$implicit;r.s9C("placeholder",e.toRemove)}}function p(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-input",25),r.NdJ("ionChange",function(t){r.CHM(e);const o=r.oxw(),i=o.$implicit,n=o.index;return r.oxw().removeQuantity(t,i,n)}),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.s9C("placeholder",e.toRemove)}}const v=function(e){return{"background-color":e}};function Z(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-row",18,19),r.TgZ(2,"ion-col",6),r.TgZ(3,"div",7),r._uU(4),r.qZA(),r.qZA(),r.TgZ(5,"ion-col",6),r.TgZ(6,"div",7),r._uU(7),r.qZA(),r.qZA(),r.TgZ(8,"ion-col",8),r.TgZ(9,"div",7),r.YNc(10,h,1,1,"ion-input",20),r.YNc(11,p,1,1,"ion-input",21),r.qZA(),r.qZA(),r.TgZ(12,"ion-col",8),r.TgZ(13,"div",7),r.TgZ(14,"ion-button",22),r.NdJ("click",function(){r.CHM(e);const o=t.$implicit;return r.oxw().remove(o)}),r._UZ(15,"ion-icon",23),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=t.index,i=r.oxw();r.Q6J("ngStyle",r.VKq(6,v,o%2==0?"#f1f1f1":"white")),r.xp6(4),r.Oqu(e.name),r.xp6(3),r.Oqu(e.sellingPrice),r.xp6(3),r.Q6J("ngIf",!i.removeToList),r.xp6(1),r.Q6J("ngIf",i.removeToList),r.xp6(3),r.Q6J("disabled",i.removeToList)}}function f(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-input",26),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().gamme.sellingPrice=t}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.gamme.sellingPrice)}}function T(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-input",27),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().gamme.sellingPrice=t}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.gamme.sellingPrice)}}function q(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-input",28),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().gamme.quantityToSale=t}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.gamme.quantityToSale)}}function L(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-input",29),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().gamme.quantityToSale=t}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.gamme.quantityToSale)}}function y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-button",30),r.NdJ("click",function(){return r.CHM(e),r.oxw().saveToCart()}),r._uU(1,"BUY"),r.qZA()}}function b(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-button",31),r.NdJ("click",function(){return r.CHM(e),r.oxw().saveToCart()}),r._uU(1,"SAVE"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",0==e.removeProductList.length)}}let A=(()=>{class e{constructor(e,t,o,i,n,a){this.modalController=e,this.toastController=t,this.loadingController=o,this.notifi=i,this.gammeService=n,this.randomStorage=a,this.removeProductList=[],this.remainingProductList=[],this.removeToList=!1,this.objRandom={},this.allEqual=e=>e.every(t=>t===e[0])}ngOnInit(){let e=this.gammeService.getGamme();e.remove&&(this.removeToList=!0,e.productList.forEach(e=>{this.objRandom[e._id]=e})),this.gamme=new n.R(e.name,e.productList,e.sellingPrice,e._id,e.created),e.qty&&(this.gamme.quantityToSale=e.qty),localStorage.setItem("oldGamme",JSON.stringify(e))}saveToCart(){this.generateArray(),this.gamme.removeProductList=this.gammeService.getRemoveProductList(),this.gamme.addProductList=this.gammeService.getaddProductList(),this.modalController.dismiss({add:!0,quantity:this.gamme.quantityToSale,removeToList:this.removeProductList,reste:this.remainingProductList,prix:this.gamme.sellingPrice,gamme:this.gamme})}closeModal(){localStorage.removeItem("oldGamme"),this.modalController.dismiss({cancel:!0})}pickResource(){return(0,i.mG)(this,void 0,void 0,function*(){this.gammeService.setGamme(this.gamme);const e=yield this.modalController.create({component:a.E,componentProps:{}});return e.onDidDismiss().then(e=>{e.data&&1==e.data.cancel?(this.gamme.productList=[],this.gamme.productList=JSON.parse(localStorage.getItem("oldGamme")).productList,this.gammeService.setGamme(this.gamme)):(this.gamme=this.gammeService.getGamme(),console.log(this.gamme))}),yield e.present()})}remove(e){if(this.gamme.removeToProductList(e),this.removeToList&&this.removeProductList.push(e),this.gammeService.saveToRemoveList(e),this.remainingProductList=this.gamme.getProductList(),console.log("ce qui reste est===>",this.remainingProductList),JSON.parse(localStorage.getItem("oldGamme")).productList.length-this.remainingProductList.length>=2){let e=0;this.remainingProductList.forEach(t=>{e+=t.sellingPrice}),this.gamme.sellingPrice=e}}removeQuantity(e,t,o){let i=parseInt(e.detail.value),n=this.gamme.productList[o];if(Number.isNaN(i)){let e=JSON.parse(localStorage.getItem("oldGamme"));this.gamme.productList[o].toRemove=e.productList[o].toRemove,this.removeProductList.length&&(this.removeProductList=this.removeProductList.filter(e=>e._id!==n._id)),this.checkGammeQuantity(),this.removeToObjRandom(o)}else i<=this.gamme.quantityToSale?(this.gamme.productList[o].toRemove=i,this.removeProductList.length?(this.removeProductList=this.removeProductList.filter(e=>e._id!==n._id),this.removeProductList.push(n),this.checkGammeQuantity()):(this.removeProductList.push(n),this.checkGammeQuantity()),this.manageGammeUtils(o,i)):i>this.gamme.productList[o].toRemove?(this.notifi.presentAlert(`incorrect value, value is greather than ${this.gamme.productList[o].toRemove}`),this.removeProductList.length&&(this.removeProductList=this.removeProductList.filter(e=>e._id!==n._id)),this.checkGammeQuantity(),this.removeToObjRandom(o)):this.checkGammeQuantity()}checkGammeQuantity(){let e=[];if(this.removeProductList.length===this.gamme.productList.length)if(this.removeProductList.forEach(t=>{e.push(t.toRemove)}),this.allEqual(e))this.gamme.quantityToSale=this.gamme.quantityToSale-this.removeProductList[0].toRemove;else{let e=JSON.parse(localStorage.getItem("oldGamme"));this.gamme.quantityToSale=e.quantityToSale}else{let e=JSON.parse(localStorage.getItem("oldGamme"));this.gamme.quantityToSale=e.quantityToSale}this.gammeService.setGamme(this.gamme)}manageGammeUtils(e,t){let o=JSON.parse(localStorage.getItem("oldGamme")).productList[e];o.toRemove=o.toRemove-t,this.objRandom[o._id]=o,console.log(this.objRandom)}removeToObjRandom(e){let t=JSON.parse(localStorage.getItem("oldGamme"));delete this.objRandom[t.productList[e]._id],console.log(this.objRandom)}generateArray(){const e=[];for(var t in this.objRandom)e.push(this.objRandom[t]);this.randomStorage.setProducListGamme(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.IN),r.Y36(s.yF),r.Y36(s.HT),r.Y36(m.g),r.Y36(l.K),r.Y36(c.i))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-gamme-before-sale"]],decls:39,vars:9,consts:[["slot","end"],[3,"click"],["slot","icon-only","name","close"],[2,"text-align","center","text-transform","uppercase","background-color","#f1f1f1","padding","5px"],["button","",3,"click",4,"ngIf"],[1,"header-row"],["size","4",1,"ion-align-self-center"],[1,"ion-text-center"],["size","2",1,"ion-align-self-center"],["class","data-row data-update",3,"ngStyle",4,"ngFor","ngForOf"],["type","number","placeholder","prix de vente",3,"ngModel","ngModelChange",4,"ngIf"],["readonly","","type","number","placeholder","prix de vente",3,"ngModel","ngModelChange",4,"ngIf"],["type","number","placeholder","quantity to sale",3,"ngModel","ngModelChange",4,"ngIf"],["readonly","","type","number","placeholder","quantity to sale",3,"ngModel","ngModelChange",4,"ngIf"],["color","danger","size","large",3,"click",4,"ngIf"],["color","danger","size","large",3,"disabled","click",4,"ngIf"],["button","",3,"click"],["slot","end","name","add-circle-outline"],[1,"data-row","data-update",3,"ngStyle"],["itemlist",""],["readonly","","type","number",3,"placeholder",4,"ngIf"],["debounce","500","type","number",3,"placeholder","ionChange",4,"ngIf"],["color","danger","size","small",2,"font-size","10px",3,"disabled","click"],["slot","icon-only","name","trash"],["readonly","","type","number",3,"placeholder"],["debounce","500","type","number",3,"placeholder","ionChange"],["type","number","placeholder","prix de vente",3,"ngModel","ngModelChange"],["readonly","","type","number","placeholder","prix de vente",3,"ngModel","ngModelChange"],["type","number","placeholder","quantity to sale",3,"ngModel","ngModelChange"],["readonly","","type","number","placeholder","quantity to sale",3,"ngModel","ngModelChange"],["color","danger","size","large",3,"click"],["color","danger","size","large",3,"disabled","click"]],template:function(e,t){1&e&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r._UZ(2,"ion-title"),r.TgZ(3,"ion-buttons",0),r.TgZ(4,"ion-button",1),r.NdJ("click",function(){return t.closeModal()}),r._UZ(5,"ion-icon",2),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"ion-content"),r.TgZ(7,"div",3),r.TgZ(8,"h4"),r._uU(9),r.qZA(),r.qZA(),r.TgZ(10,"ion-grid"),r.TgZ(11,"ion-row"),r.TgZ(12,"ion-col"),r.TgZ(13,"div"),r.YNc(14,u,4,0,"ion-item",4),r.TgZ(15,"ion-row",5),r.TgZ(16,"ion-col",6),r.TgZ(17,"div",7),r._uU(18,"Name"),r.qZA(),r.qZA(),r.TgZ(19,"ion-col",6),r.TgZ(20,"div",7),r._uU(21,"Price"),r.qZA(),r.qZA(),r.TgZ(22,"ion-col",8),r.TgZ(23,"div",7),r._uU(24,"toRemove"),r.qZA(),r.qZA(),r.TgZ(25,"ion-col",8),r._UZ(26,"div",7),r.qZA(),r.qZA(),r.YNc(27,Z,16,8,"ion-row",9),r.TgZ(28,"ion-item"),r.YNc(29,f,1,1,"ion-input",10),r.YNc(30,T,1,1,"ion-input",11),r.qZA(),r.TgZ(31,"ion-item"),r.YNc(32,q,1,1,"ion-input",12),r.YNc(33,L,1,1,"ion-input",13),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(34,"ion-row"),r.TgZ(35,"ion-col"),r.TgZ(36,"div",7),r.YNc(37,y,2,0,"ion-button",14),r.YNc(38,b,2,1,"ion-button",15),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Oqu(t.gamme.name),r.xp6(5),r.Q6J("ngIf",!t.removeToList),r.xp6(13),r.Q6J("ngForOf",t.gamme.productList),r.xp6(2),r.Q6J("ngIf",!t.removeToList),r.xp6(1),r.Q6J("ngIf",t.removeToList),r.xp6(2),r.Q6J("ngIf",!t.removeToList),r.xp6(1),r.Q6J("ngIf",t.removeToList),r.xp6(4),r.Q6J("ngIf",!t.removeToList),r.xp6(1),r.Q6J("ngIf",t.removeToList))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.YG,s.gu,s.W2,s.jY,s.Nd,s.wI,g.O5,g.sg,s.Ie,s.Q$,g.PC,s.pK,s.as,d.JJ,d.On],styles:[""]}),e})()}}]);