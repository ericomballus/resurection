(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[8484],{8484:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ShopPageModule:()=>Le});var o=i(1511),s=i(6073),r=i(8777),n=i(8158),a=i(4762),c=i(1572),l=i(9942),u=i(7149);class d{constructor(t){this.quantityItems=t.quantityItems||0,this.quantityStore=t.quantityStore||0,this.nonglace=t.nonglace||0,this.modeNG=t.modeNG||0,this.modeG=t.modeG||0,this.glace=t.glace||0,this.resourceList=t.resourceList||[],this.CA=t.CA||0,this.cassierStore=t.cassierStore||0,this.BTL=t.BTL||0,this.btlsStore=t.btlsStore||0}add(t){return console.log(this),"NG"==t?this.resourceList.length?(this.modeNG++,this):this.quantityStore?(this.modeNG++,this.quantityStore=this.quantityStore-1,this):void 0:"G"==t?this.resourceList.length?(this.modeG++,this):this.glace?(this.modeG++,this.glace=this.glace-1,this.quantityStore=this.quantityStore-1,this):void 0:"CA"==t?this.resourceList.length?(this.CA++,this):this.cassierStore?(this.CA++,this.cassierStore=this.cassierStore-1,this):void 0:"BTL"==t?this.resourceList.length?(this.BTL++,this):this.btlsStore?(this.BTL++,this.btlsStore=this.btlsStore-1,this):void 0:void 0}reduceByOne(t){}removeItem(t){}}var h=i(5416),p=i(6673),g=i(7570),m=i(1784),f=i(5959);class v{constructor(t,e,i,o){this.keySelector=t,this.elementSelector=e,this.durationSelector=i,this.subjectSelector=o}call(t,e){return e.subscribe(new b(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))}}class b extends p.L{constructor(t,e,i,o,s){super(t),this.keySelector=e,this.elementSelector=i,this.durationSelector=o,this.subjectSelector=s,this.groups=null,this.attemptedToUnsubscribe=!1,this.count=0}_next(t){let e;try{e=this.keySelector(t)}catch(i){return void this.error(i)}this._group(t,e)}_group(t,e){let i=this.groups;i||(i=this.groups=new Map);let o,s=i.get(e);if(this.elementSelector)try{o=this.elementSelector(t)}catch(r){this.error(r)}else o=t;if(!s){s=this.subjectSelector?this.subjectSelector():new f.xQ,i.set(e,s);const t=new y(e,s,this);if(this.destination.next(t),this.durationSelector){let t;try{t=this.durationSelector(new y(e,s))}catch(r){return void this.error(r)}this.add(t.subscribe(new S(e,s,this)))}}s.closed||s.next(o)}_error(t){const e=this.groups;e&&(e.forEach((e,i)=>{e.error(t)}),e.clear()),this.destination.error(t)}_complete(){const t=this.groups;t&&(t.forEach((t,e)=>{t.complete()}),t.clear()),this.destination.complete()}removeGroup(t){this.groups.delete(t)}unsubscribe(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&super.unsubscribe())}}class S extends p.L{constructor(t,e,i){super(e),this.key=t,this.group=e,this.parent=i}_next(t){this.complete()}_unsubscribe(){const{parent:t,key:e}=this;this.key=this.parent=null,t&&t.removeGroup(e)}}class y extends m.y{constructor(t,e,i){super(),this.key=t,this.groupSubject=e,this.refCountSubscription=i}_subscribe(t){const e=new g.w,{refCountSubscription:i,groupSubject:o}=this;return i&&!i.closed&&e.add(new T(i)),e.add(o.subscribe(t)),e}}class T extends g.w{constructor(t){super(),this.parent=t,t.count++}unsubscribe(){const t=this.parent;t.closed||this.closed||(super.unsubscribe(),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())}}var A=i(3982),Z=i(2023),x=i(4991),q=i(7768),I=i(6541);function C(t,e,i){return 0===i?[e]:(t.push(e),t)}var P=i(8512),L=i(9764),N=i(728),_=i(4446),k=i(4144),w=i(3437),G=i(5604),O=i(731),R=i(5541),J=i(5946),E=i(3515),U=i(2968),M=i(6529),$=i(5508),Q=i(7886),Y=i(2874),B=i(1611),z=i(1044),F=i(4418),H=i(3764),V=i(1094),j=i(4375),D=i(8732),W=i(8684),K=i(1714),X=i(1064),tt=i(2181),et=i(6351),it=i(6048);const ot=["mySlider"],st=["slideWithNav"],rt=["itemlist"],nt=["lastSlide"];function at(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",21),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).router.navigateByUrl("activitie")}),c._uU(1),c.ALo(2,"translate"),c.qZA()}2&t&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"MENU.activities"),""))}function ct(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",22),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).router.navigateByUrl("point-of-sale")}),c._uU(1),c.ALo(2,"translate"),c.qZA()}2&t&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"MENU.pos")," "))}function lt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",23),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).router.navigateByUrl("procurment-product-item")}),c._UZ(1,"ion-icon",24),c.TgZ(2,"ion-badge",16),c._uU(3),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(3),c.hij("",t.transaction.length," ")}}function ut(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-toolbar",5),c.TgZ(1,"ion-buttons",6),c._UZ(2,"ion-menu-button",7),c.YNc(3,at,3,3,"ion-button",8),c.YNc(4,ct,3,3,"ion-button",9),c.YNc(5,lt,4,1,"ion-button",10),c.qZA(),c.TgZ(6,"ion-row",11),c._UZ(7,"ion-col",12),c.TgZ(8,"ion-col",12),c.TgZ(9,"div",13),c.TgZ(10,"ion-button",14),c.NdJ("click",function(){return c.CHM(t),c.oxw().openCart()}),c._UZ(11,"ion-icon",15),c.TgZ(12,"ion-badge",16),c._uU(13),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(14,"ion-col",17),c.TgZ(15,"div",18),c.TgZ(16,"small",19),c._UZ(17,"ion-icon",20),c._uU(18),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(3),c.Q6J("ngIf",!t.pos),c.xp6(1),c.Q6J("ngIf",t.pos),c.xp6(1),c.Q6J("ngIf",t.transaction.length),c.xp6(5),c.Q6J("disabled",0===t.totalItems),c.xp6(3),c.hij(" ",t.totalItems," "),c.xp6(5),c.hij(" ",t.userName," ")}}function dt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",32),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).router.navigateByUrl("activitie")}),c.TgZ(1,"small",33),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()}2&t&&(c.xp6(2),c.Oqu(c.lcZ(3,1,"MENU.activities")))}function ht(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",32),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).router.navigateByUrl("point-of-sale")}),c.TgZ(1,"small",33),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()}2&t&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"MENU.pos"),""))}function pt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-toolbar",25),c.TgZ(1,"ion-buttons",6),c._UZ(2,"ion-menu-button",7),c.qZA(),c.TgZ(3,"ion-row",26),c.TgZ(4,"ion-col",27),c.YNc(5,dt,4,3,"div",28),c.YNc(6,ht,4,3,"div",28),c.qZA(),c.TgZ(7,"ion-col",27),c.TgZ(8,"div",29),c.TgZ(9,"ion-button",30),c.NdJ("click",function(){return c.CHM(t),c.oxw().openCart()}),c._uU(10),c._UZ(11,"ion-icon",15),c.qZA(),c.qZA(),c.qZA(),c.TgZ(12,"ion-col",27),c.TgZ(13,"ion-button"),c._uU(14),c.qZA(),c.qZA(),c.TgZ(15,"ion-col",27),c.TgZ(16,"ion-button",31),c.NdJ("click",function(){return c.CHM(t),c.oxw().cancelAdd()}),c._uU(17," annuler "),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(5),c.Q6J("ngIf",!t.pos),c.xp6(1),c.Q6J("ngIf",t.pos),c.xp6(3),c.Q6J("disabled",0===t.totalItems),c.xp6(1),c.hij(" ",t.totalItems," "),c.xp6(4),c.hij(" facture ",t.numFacture,"")}}function gt(t,e){if(1&t&&(c.TgZ(0,"ion-segment-button",36),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.s9C("value",t),c.xp6(1),c.hij(" ",t," ")}}function mt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-segment",34),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw().segmentChanged(e)})("ngModelChange",function(e){return c.CHM(t),c.oxw().pet=e}),c.YNc(1,gt,2,2,"ion-segment-button",35),c.qZA()}if(2&t){const t=c.oxw();c.s9C("value",t.pet),c.Q6J("ngModel",t.pet),c.xp6(1),c.Q6J("ngForOf",t.storeTypeTab)}}function ft(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",51),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).removeOne(e,"modeG")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.modeG?t.modeG:0)}}function vt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",52),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).removeOne(e,"modeNG")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.modeNG?t.modeNG:0)}}function bt(t,e){if(1&t&&(c.TgZ(0,"div",48),c.YNc(1,ft,2,1,"ion-badge",49),c.YNc(2,vt,2,1,"ion-badge",50),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",t.modeG||t.modeNG),c.xp6(1),c.Q6J("ngIf",t.modeG||t.modeNG)}}function St(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",51),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).removeOne(e,"BTL")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.BTL?t.BTL:0)}}function yt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",52),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).removeOne(e,"CA")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.CA?t.CA:0)}}function Tt(t,e){if(1&t&&(c.TgZ(0,"div",48),c.YNc(1,St,2,1,"ion-badge",49),c.YNc(2,yt,2,1,"ion-badge",50),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",t.BTL||t.CA),c.xp6(1),c.Q6J("ngIf",t.CA||t.BTL)}}function At(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",56),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).buyItem(e,e.glace,"G")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" G ",t.glace?t.glace:0," ")}}function Zt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",56),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).buyItem(e,e.glace,"G")}),c._uU(1," G "),c.qZA()}}function xt(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",54),c.YNc(2,At,2,1,"ion-button",55),c.YNc(3,Zt,2,0,"ion-button",55),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0),c.xp6(1),c.Q6J("ngIf",t.resourceList&&t.resourceList.length>0)}}function qt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).buyItem(e,e.quantityStore,"NG")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" N ",t.glace?t.quantityStore-t.glace:t.quantityStore," ")}}function It(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).buyItem(e,e.quantityStore,"NG")}),c._uU(1," N "),c.qZA()}}function Ct(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",57),c.YNc(2,qt,2,1,"ion-button",58),c.YNc(3,It,2,0,"ion-button",58),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0),c.xp6(1),c.Q6J("ngIf",t.resourceList&&t.resourceList.length>0)}}function Pt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",56),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).buyItem(e,e.btlsStore,"BTL")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" BTL ",t.btlsStore?t.btlsStore:0," ")}}function Lt(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",57),c.YNc(2,Pt,2,1,"ion-button",55),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0)}}function Nt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).buyItem(e,e.cassierStore,"CA")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" CA ",t.cassierStore?t.cassierStore:0," ")}}function _t(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",57),c.YNc(2,Nt,2,1,"ion-button",58),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0)}}function kt(t,e){if(1&t&&(c.TgZ(0,"ion-col",40),c.TgZ(1,"div",41),c.TgZ(2,"ion-card",42),c.YNc(3,bt,3,2,"div",43),c.YNc(4,Tt,3,2,"div",43),c.TgZ(5,"div",44),c._UZ(6,"app-cache-image",45),c.qZA(),c.TgZ(7,"ion-card-content"),c.TgZ(8,"div",46),c.TgZ(9,"small"),c._uU(10),c.qZA(),c._uU(11,"\xa0 "),c.TgZ(12,"small"),c._uU(13),c.qZA(),c.TgZ(14,"small"),c._uU(15),c.qZA(),c.qZA(),c.TgZ(16,"ion-row"),c.YNc(17,xt,4,2,"ion-col",47),c.YNc(18,Ct,4,2,"ion-col",47),c.YNc(19,Lt,3,1,"ion-col",47),c.YNc(20,_t,3,1,"ion-col",47),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t){const t=e.$implicit,i=c.oxw(4);c.xp6(3),c.Q6J("ngIf",!i.saleToPack),c.xp6(1),c.Q6J("ngIf",i.saleToPack),c.xp6(2),c.Q6J("src",t.url)("spinner",!1)("isLoad",i.isLoad),c.xp6(4),c.Oqu(t.name),c.xp6(3),c.Oqu(t.sizeUnitProduct),c.xp6(2),c.Oqu(t.unitNameProduct),c.xp6(2),c.Q6J("ngIf",!i.saleToPack),c.xp6(1),c.Q6J("ngIf",!i.saleToPack),c.xp6(1),c.Q6J("ngIf",i.saleToPack),c.xp6(1),c.Q6J("ngIf",i.saleToPack)}}function wt(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,kt,21,12,"ion-col",39),c.qZA()),2&t){const t=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",t.arrList2)}}function Gt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",51),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).removeOne(e,"modeG")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.modeG?t.modeG:0)}}function Ot(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",52),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).removeOne(e,"modeNG")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.modeNG?t.modeNG:0)}}function Rt(t,e){if(1&t&&(c.TgZ(0,"div",48),c.YNc(1,Gt,2,1,"ion-badge",49),c.YNc(2,Ot,2,1,"ion-badge",50),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",t.modeG||t.modeNG),c.xp6(1),c.Q6J("ngIf",t.modeG||t.modeNG)}}function Jt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",51),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).removeOne(e,"BTL")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.BTL?t.BTL:0)}}function Et(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",52),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).removeOne(e,"CA")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Oqu(t.CA?t.CA:0)}}function Ut(t,e){if(1&t&&(c.TgZ(0,"div",48),c.YNc(1,Jt,2,1,"ion-badge",49),c.YNc(2,Et,2,1,"ion-badge",50),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",t.BTL||t.CA),c.xp6(1),c.Q6J("ngIf",t.CA||t.BTL)}}function Mt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",56),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).buyItem(e,e.glace,"G")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" G ",t.glace?t.glace:0," ")}}function $t(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",56),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).buyItem(e,e.glace,"G")}),c._uU(1," G "),c.qZA()}}function Qt(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",54),c.YNc(2,Mt,2,1,"ion-button",55),c.YNc(3,$t,2,0,"ion-button",55),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0),c.xp6(1),c.Q6J("ngIf",t.resourceList&&t.resourceList.length>0)}}function Yt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).buyItem(e,e.quantityStore,"NG")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" N ",t.glace?t.quantityStore-t.glace:t.quantityStore," ")}}function Bt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).buyItem(e,e.quantityStore,"NG")}),c._uU(1," N "),c.qZA()}}function zt(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",57),c.YNc(2,Yt,2,1,"ion-button",58),c.YNc(3,Bt,2,0,"ion-button",58),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0),c.xp6(1),c.Q6J("ngIf",t.resourceList&&t.resourceList.length>0)}}function Ft(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",56),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).buyItem(e,e.btlsStore,"BTL")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" BTL ",t.btlsStore?t.btlsStore:0," ")}}function Ht(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",57),c.YNc(2,Ft,2,1,"ion-button",55),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0)}}function Vt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(3).buyItem(e,e.cassierStore,"CA")}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" CA ",t.cassierStore?t.cassierStore:0," ")}}function jt(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.TgZ(1,"div",57),c.YNc(2,Vt,2,1,"ion-button",58),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Q6J("ngIf",t.resourceList&&t.resourceList.length<=0)}}function Dt(t,e){if(1&t&&(c.TgZ(0,"ion-col",40),c.TgZ(1,"div",41),c.TgZ(2,"ion-card",42),c.YNc(3,Rt,3,2,"div",43),c.YNc(4,Ut,3,2,"div",43),c.TgZ(5,"div",44),c._UZ(6,"app-cache-image",45),c.qZA(),c.TgZ(7,"ion-card-content"),c.TgZ(8,"div",46),c.TgZ(9,"small"),c._uU(10),c.qZA(),c._uU(11,"\xa0 "),c.TgZ(12,"small"),c._uU(13),c.qZA(),c.TgZ(14,"small"),c._uU(15),c.qZA(),c.qZA(),c.TgZ(16,"ion-row"),c.YNc(17,Qt,4,2,"ion-col",47),c.YNc(18,zt,4,2,"ion-col",47),c.YNc(19,Ht,3,1,"ion-col",47),c.YNc(20,jt,3,1,"ion-col",47),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t){const t=e.$implicit,i=c.oxw(3);c.xp6(3),c.Q6J("ngIf",!i.saleToPack),c.xp6(1),c.Q6J("ngIf",i.saleToPack),c.xp6(2),c.Q6J("src",t.url)("spinner",!1)("isLoad",i.isLoad),c.xp6(4),c.Oqu(t.name),c.xp6(3),c.Oqu(t.sizeUnitProduct),c.xp6(2),c.Oqu(t.unitNameProduct),c.xp6(2),c.Q6J("ngIf",!i.saleToPack),c.xp6(1),c.Q6J("ngIf",!i.saleToPack),c.xp6(1),c.Q6J("ngIf",i.saleToPack),c.xp6(1),c.Q6J("ngIf",i.saleToPack)}}function Wt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-grid"),c.TgZ(1,"ion-row"),c.TgZ(2,"ion-searchbar",38),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).findProductItemList(e)}),c.qZA(),c.YNc(3,wt,2,1,"div",4),c.qZA(),c.TgZ(4,"ion-row"),c.YNc(5,Dt,21,12,"ion-col",39),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(3),c.Q6J("ngIf",t.isItemAvailable3),c.xp6(2),c.Q6J("ngForOf",t.allUserProducts)}}function Kt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"small",null,62),c.TgZ(2,"ion-button",63),c.NdJ("click",function(){c.CHM(t);const i=e.$implicit,o=e.index;return c.oxw(3).showPlat(i,o)}),c._uU(3),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(3),c.hij("plat ",t,"")}}function Xt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",74),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit,i=c.oxw().index;return c.oxw(3).removeInPlat(e,i)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.Oqu(t.nbr)}}function te(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-col",67),c.TgZ(1,"div",41),c.TgZ(2,"ion-card",42),c.TgZ(3,"div",68),c.YNc(4,Xt,2,1,"ion-badge",69),c.qZA(),c.TgZ(5,"div",70),c.NdJ("click",function(){c.CHM(t);const i=e.$implicit,o=c.oxw().index;return c.oxw(3).buyItemResto(i,o)}),c._UZ(6,"app-cache-image",71),c.qZA(),c.TgZ(7,"ion-card-content"),c.TgZ(8,"div",46),c.TgZ(9,"small"),c._uU(10),c.qZA(),c._uU(11,"\xa0 "),c.qZA(),c.TgZ(12,"ion-row"),c.TgZ(13,"ion-col",72),c._UZ(14,"div",73),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=c.oxw(4);c.xp6(4),c.Q6J("ngIf",t.nbr),c.xp6(2),c.Q6J("src",t.url)("spinner",!1)("isLoad",i.isLoad),c.xp6(4),c.Oqu(t.name)}}function ee(t,e){if(1&t&&(c.TgZ(0,"div"),c.TgZ(1,"ion-col",64),c.TgZ(2,"div",65),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"ion-row"),c.YNc(5,te,15,5,"ion-col",66),c.qZA(),c.qZA()),2&t){const t=e.$implicit;c.xp6(3),c.Oqu(t[0].categoryName),c.xp6(2),c.Q6J("ngForOf",t)}}function ie(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-item"),c.YNc(2,Kt,4,1,"small",60),c.TgZ(3,"ion-button",61),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).changeNumTable()}),c._uU(4,"nouveau plat"),c.qZA(),c.qZA(),c.YNc(5,ee,6,2,"div",60),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(2),c.Q6J("ngForOf",t.plalist),c.xp6(3),c.Q6J("ngForOf",t.productResto2)}}const oe=function(t){return[t,"FCFA","symbol","3.0-0","fr"]};function se(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",23),c.NdJ("click",function(){c.CHM(t);const i=e.$implicit;return c.oxw(4).buyItemProList(i)}),c.TgZ(1,"ion-label"),c.TgZ(2,"ion-text",5),c.TgZ(3,"h6"),c._uU(4),c.qZA(),c.qZA(),c.TgZ(5,"p"),c._uU(6),c.ALo(7,"currency"),c.qZA(),c.TgZ(8,"p"),c._uU(9),c.ALo(10,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(4),c.Oqu(t.name),c.xp6(2),c.Oqu(c.G7q(7,4,c.VKq(12,oe,t.sellingPrice))),c.xp6(3),c.AsE("",c.lcZ(10,10,"MENU.avaible"),": ",t.quantityStore,"")}}function re(t,e){if(1&t&&(c.TgZ(0,"ion-list"),c.YNc(1,se,11,14,"ion-item",81),c.qZA()),2&t){const t=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",t.arrList2)}}function ne(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",74),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).removeIn(e)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.Oqu(t.nbr)}}function ae(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",89),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).buyItemProList(e)}),c._UZ(1,"ion-icon",90),c.qZA()}}function ce(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-row",91),c.TgZ(1,"ion-button",92),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).buyEmptyBottle(e)}),c._uU(2,"v"),c.qZA(),c.TgZ(3,"ion-button",92),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).buyItemProList(e)}),c._uU(4,"P"),c.qZA(),c.TgZ(5,"ion-button",92),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).buyEmballagePro(e)}),c._uU(6,"E & p"),c.qZA(),c.qZA()}}const le=function(t){return{"background-color":t}};function ue(t,e){if(1&t&&(c.TgZ(0,"ion-row",85),c.TgZ(1,"ion-col",76),c.TgZ(2,"div",77),c._uU(3),c.TgZ(4,"div",68),c.YNc(5,ne,2,1,"ion-badge",69),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"ion-col",76),c.TgZ(7,"div",77),c._uU(8),c.ALo(9,"currency"),c.qZA(),c.qZA(),c.TgZ(10,"ion-col",78),c.TgZ(11,"div",77),c.TgZ(12,"ion-badge",86),c._uU(13),c.qZA(),c.qZA(),c.qZA(),c.TgZ(14,"ion-col",79),c.TgZ(15,"div",80),c.YNc(16,ae,2,0,"ion-button",87),c.qZA(),c.qZA(),c.YNc(17,ce,7,0,"ion-row",88),c.qZA()),2&t){const t=e.$implicit,i=e.index,o=c.oxw(5);c.Q6J("ngStyle",c.VKq(13,le,i%2==0?"#f1f1f1":"white")),c.xp6(3),c.hij(" ",t.name?t.name:"no Name"," "),c.xp6(2),c.Q6J("ngIf",t.nbr),c.xp6(3),c.hij(" ",c.G7q(9,7,c.VKq(15,oe,t.sellingPrice))," "),c.xp6(5),c.Oqu(t.quantityStore),c.xp6(3),c.Q6J("ngIf",!o.saveRandom.getSetting().sale_Gaz),c.xp6(1),c.Q6J("ngIf",o.saveRandom.getSetting().sale_Gaz)}}function de(t,e){if(1&t&&(c.TgZ(0,"div"),c.TgZ(1,"div",82),c.TgZ(2,"h3",83),c._uU(3),c.qZA(),c.qZA(),c.YNc(4,ue,18,17,"ion-row",84),c.qZA()),2&t){const t=e.$implicit;c.xp6(3),c.hij(" ",t[0].categoryName," "),c.xp6(1),c.Q6J("ngForOf",t)}}function he(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,de,5,2,"div",60),c.qZA()),2&t){const t=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",t.productList)}}function pe(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-searchbar",38),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).findProductList(e)}),c.qZA(),c.YNc(2,re,2,1,"ion-list",4),c.TgZ(3,"ion-row",75),c.TgZ(4,"ion-col",76),c.TgZ(5,"div",77),c._uU(6),c.ALo(7,"translate"),c.qZA(),c.qZA(),c.TgZ(8,"ion-col",76),c.TgZ(9,"div",77),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.qZA(),c.TgZ(12,"ion-col",78),c.TgZ(13,"div",77),c._uU(14),c.ALo(15,"translate"),c.qZA(),c.qZA(),c.TgZ(16,"ion-col",79),c._UZ(17,"div",80),c.qZA(),c.qZA(),c.YNc(18,he,2,1,"div",4),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(2),c.Q6J("ngIf",t.isItemAvailable3),c.xp6(4),c.hij(" ",c.lcZ(7,5,"MENU.name")," "),c.xp6(4),c.hij(" ",c.lcZ(11,7,"MENU.price")," "),c.xp6(4),c.hij(" ",c.lcZ(15,9,"MENU.avaible")," "),c.xp6(4),c.Q6J("ngIf",t.productList)}}function ge(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",74),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(4).removeIn(e)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.Oqu(t.nbr)}}const me=function(t){return{masque:t}};function fe(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-col",67),c.TgZ(1,"div",94),c.TgZ(2,"ion-card",42),c.TgZ(3,"div",68),c.YNc(4,ge,2,1,"ion-badge",69),c.qZA(),c.TgZ(5,"div",23),c.NdJ("click",function(){c.CHM(t);const i=e.$implicit;return c.oxw(4).buyItemGame(i)}),c.TgZ(6,"div",44),c._UZ(7,"app-cache-image",45),c.qZA(),c.TgZ(8,"ion-card-content"),c.TgZ(9,"div",46),c.TgZ(10,"small"),c._uU(11),c.qZA(),c._uU(12,"\xa0 "),c.qZA(),c.TgZ(13,"ion-row"),c.TgZ(14,"ion-col",72),c.TgZ(15,"div",95),c._uU(16),c.ALo(17,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=c.oxw(4);c.xp6(1),c.Q6J("ngClass",c.VKq(10,me,0==t.quantityStore)),c.xp6(3),c.Q6J("ngIf",t.nbr),c.xp6(3),c.Q6J("src",t.url)("spinner",!1)("isLoad",i.isLoad),c.xp6(4),c.Oqu(t.name),c.xp6(5),c.AsE(" ",c.lcZ(17,8,"MENU.avaible"),": ",t.quantityStore?t.quantityStore:0," ")}}function ve(t,e){if(1&t&&(c.TgZ(0,"ion-row"),c.TgZ(1,"div",93),c._uU(2),c.qZA(),c.YNc(3,fe,18,12,"ion-col",66),c.qZA()),2&t){const t=e.$implicit;c.xp6(2),c.hij(" ",t[0].categoryName," "),c.xp6(1),c.Q6J("ngForOf",t)}}function be(t,e){if(1&t&&(c.TgZ(0,"div"),c.TgZ(1,"ion-grid"),c.YNc(2,ve,4,2,"ion-row",60),c.qZA(),c.qZA()),2&t){const t=c.oxw(2);c.xp6(2),c.Q6J("ngForOf",t.productListTab)}}function Se(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-badge",74),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(3).removeIn(e)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.Oqu(t.nbr)}}function ye(t,e){if(1&t&&c._UZ(0,"app-cache-image",45),2&t){const t=c.oxw(4);c.Q6J("src",t.urlPackage)("spinner",!1)("isLoad",t.isLoad)}}function Te(t,e){if(1&t&&c._UZ(0,"app-cache-image",45),2&t){const t=c.oxw().$implicit,e=c.oxw(3);c.Q6J("src",t.url)("spinner",!1)("isLoad",e.isLoad)}}function Ae(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-col",67),c.TgZ(1,"div",41),c.TgZ(2,"ion-card",42),c.TgZ(3,"div",68),c.YNc(4,Se,2,1,"ion-badge",69),c.qZA(),c.TgZ(5,"div",70),c.NdJ("click",function(){c.CHM(t);const i=e.$implicit;return c.oxw(3).buyGamme(i)}),c.YNc(6,ye,1,3,"app-cache-image",96),c.YNc(7,Te,1,3,"app-cache-image",96),c.qZA(),c.TgZ(8,"ion-card-content"),c.TgZ(9,"div",46),c.TgZ(10,"small"),c._uU(11),c.qZA(),c._uU(12,"\xa0 "),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(4),c.Q6J("ngIf",t.nbr),c.xp6(2),c.Q6J("ngIf",!t.url),c.xp6(1),c.Q6J("ngIf",t.url),c.xp6(4),c.Oqu(t.name)}}function Ze(t,e){if(1&t&&(c.TgZ(0,"div"),c.TgZ(1,"ion-grid"),c.TgZ(2,"ion-row"),c.YNc(3,Ae,13,4,"ion-col",66),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw(2);c.xp6(3),c.Q6J("ngForOf",t.gammeListTab)}}function xe(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Wt,6,2,"ion-grid",4),c._UZ(2,"app-fakedata",37),c.YNc(3,ie,6,2,"div",4),c.YNc(4,pe,19,11,"div",4),c.YNc(5,be,3,1,"div",4),c.YNc(6,Ze,4,1,"div",4),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngIf","bar"===t.pet),c.xp6(1),c.Q6J("spinner",t.spinner),c.xp6(1),c.Q6J("ngIf","resto"===t.pet),c.xp6(1),c.Q6J("ngIf","shop"===t.pet),c.xp6(1),c.Q6J("ngIf","produits"===t.pet),c.xp6(1),c.Q6J("ngIf","Gammes"===t.pet)}}function qe(t,e){if(1&t&&(c.TgZ(0,"ion-footer"),c.TgZ(1,"ion-row"),c._UZ(2,"ion-col"),c.TgZ(3,"ion-col",97),c.TgZ(4,"div",98),c.TgZ(5,"small"),c._uU(6),c.qZA(),c._uU(7," items = "),c.TgZ(8,"small"),c._uU(9),c.ALo(10,"currency"),c.qZA(),c.qZA(),c.qZA(),c._UZ(11,"ion-col"),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(6),c.Oqu(t.totalItems),c.xp6(3),c.hij("",c.G7q(10,2,c.VKq(8,oe,t.totalPrice))," ")}}let Ie=(()=>{class t{constructor(t,e,i,o,s,r,n,a,c,l,u,d,h,p,g,m,v,b,S,y,T,A,Z,x,q,I,C,L,N,_,k,w,G,O){this.restApiService=t,this.manageCartService=e,this.countItemsService=i,this.navCtrl=o,this.modalController=s,this.alertController=r,this.router=n,this.loadingController=a,this.translateConfigService=c,this.events=l,this.networkService=u,this.toastController=d,this.adminService=h,this.imageLoader=p,this.urlService=g,this.screensizeService=m,this.popoverController=v,this.offlineManager=b,this.menu=S,this.httpN=y,this.notification=T,this.resourceService=A,this.rangeByStoreService=Z,this.manageSocket=x,this.groupByService=q,this.platform=I,this.cacheService=C,this.saveRandom=L,this.convert=N,this.retailerPrice=_,this.gammeService=k,this.translate=w,this.notifi=G,this.authService=O,this.products=[],this.productResto=[],this.randomP=[],this.randomShop=[],this.randomResto=[],this.randomList=[],this.packs=[],this.allProducts=[],this.totalItems=0,this.totalPrice=0,this.isItemAvailable=!1,this.isItemAvailable2=!1,this.isItemAvailable3=!1,this.btnProducts=!0,this.btnAllProducts=!1,this.btnResto=!1,this.btnPack=!1,this.isLoading=!1,this.tabRoles=[],this.jsonProducts=null,this.pos=!1,this.userProducts=[],this.userProducts2=[],this.allUserProducts=[],this.allUserProductsList=[],this.categories=[],this.productsCat=[],this.segment="boisson",this.tableCheckDisplay=[],this.productsGame=[],this.ortherProducts=[],this.objGen={},this.numPlat=1,this.numPlatRandom=0,this.plat=[],this.plalist=[1],this.flagAdd=!1,this.productStatus=new P.X(!1),this.displayList=!1,this.storeType=[],this.tabNotif=[],this.arr=[],this.arrList=[],this.arrList2=[],this.arrListRandom=[],this.storeTypeTab=[],this.productListTab=[],this.saleToPack=!1,this.checkPack=!1,this.saleToRetailer=!1,this.isRetailer=!1,this.tab=[],this.destroy$=new f.xQ,this.isLoad=!1,this.navSlide=!1,this.isDesktop=!1,this.showMe=!0,this.urlPackage="",this.transaction=[],this.setting=this.saveRandom.getSetting(),this.screenCheck(),this.menu.enable(!0,"first");let R=JSON.parse(localStorage.getItem("adminUser"));this.storeType=R.storeType,(R.displayType&&"card"==R.displayType||this.storeType.includes("bar")||this.storeType.includes("resto"))&&(this.displayList=!1),this.checkCart(),this.takeUrl(),JSON.parse(localStorage.getItem("user")).name&&(this.userName=JSON.parse(localStorage.getItem("user")).name),this.tabRoles=JSON.parse(localStorage.getItem("roles")),this.tabRoles.includes(1)||this.tabRoles.includes(5)||this.tabRoles.includes(4)||this.tabRoles.includes(2)||this.router.navigateByUrl("Login"),(this.tabRoles.includes(4)||this.tabRoles.includes(2))&&(this.pos=!0),this.languageChanged(),this.tabRoles.includes(5),this.takeCashOpen()}languageChanged(){let t=localStorage.getItem("language");t&&this.translateConfigService.setLanguage(t)}checkCart(){this.cartValue=this.restApiService.getCart2(),this.cartValue&&this.cartValue.cart&&(this.totalItems=this.cartValue.cart.totalQty,this.totalPrice=this.cartValue.cart.totalPrice)}takeUrl(){return(0,a.mG)(this,void 0,void 0,function*(){this.urlService.getUrlEvent().pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){this.urlEvent=t,this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId)}))})}ngOnInit(){let t=this.saveRandom.getVoucher();this.voucher=!!t}ngAfterViewInit(){this.spinner=!1,this.lastSlide.changes.pipe((0,h.R)(this.destroy$)).subscribe(t=>{t._changesDetected&&(setTimeout(()=>{this.notification.dismissLoading(),setTimeout(()=>{this.spinner=!0,this.navSlide=!0},3e3)},500),setTimeout(()=>{this.isLoad=!0},5e3))})}ionViewWillEnter(){this.tabRoles=JSON.parse(localStorage.getItem("roles")),this.saleToRetailer=this.saveRandom.checkIfIsRetailer(),localStorage.getItem("addFlag")&&(this.flagAdd=localStorage.getItem("addFlag")),this.events.addOneProduct().pipe((0,h.R)(this.destroy$)).subscribe(t=>{if(t.item)if(t.mode)this.buyItem(t.item,t.store,t.mode);else if(t.item.quantityStore<=0){if(this.saveRandom.getSetting().check_service_quantity){let t={};return this.translate.get("MENU.not_enough").subscribe(e=>{t.message=e}),void this.notification.presentError(t.message,"danger")}}else"billard"==t.item.productType?this.buyItemGame(t.item):"shoplist"==t.item.productType?this.buyItemProList(t.item):"manufacturedItems"==t.item.productType&&this.buyItemResto(t.item,t.item.index)},t=>{}),this.events.removeOneProduct().pipe((0,h.R)(this.destroy$)).subscribe(t=>{t.item&&(t.mode?this.removeOne(t.item,t.mode):(console.log("shop page ligne 361",t.item),this.removeOne(t.item)))}),this.tabRoles.includes(5)?this.getSettins():this.getCustomerItems(),this.getTransaction()}ionViewWillLeave(){localStorage.getItem("backTo")&&localStorage.removeItem("backTo"),this.saveRandom.isNotRetailer(),this.destroy$.next(),this.destroy$.complete(),this.cartValue=this.restApiService.getCart2(),this.cartValue&&this.cartValue.cart&&this.restApiService.saveCart({})}getCustomerItems(){if(JSON.parse(localStorage.getItem("setting"))){let t=JSON.parse(localStorage.getItem("setting"));Array.isArray(t),Array.isArray(t)?t[0].SaleInPack?(this.checkPack=!0,localStorage.setItem("saleAsPack","true")):this.checkPack=!1:t.SaleInPack?(this.checkPack=!0,localStorage.setItem("saleAsPack","true")):this.checkPack=!1}this.storeTypeTab=JSON.parse(localStorage.getItem("adminUser")).storeType,this.storeTypeTab.forEach((t,e)=>{"services"==t&&(this.storeTypeTab[e]="produits"),"Gammes"==t&&(this.storeTypeTab[e]="Gammes")}),this.pet=this.storeTypeTab[0],this.storeTypeTab.includes("bar")&&this.takeProduct(),(this.storeTypeTab.includes("services")||this.storeTypeTab.includes("produits"))&&(this.takeGame(),setTimeout(()=>{},1500)),this.storeTypeTab.includes("shop")&&(1==this.storeTypeTab.length?this.takeProductListShop(!0):setTimeout(()=>{this.takeProductListShop()},1500)),this.storeTypeTab.includes("resto")&&this.storeTypeTab.includes("bar")?setTimeout(()=>{this.takeProductResto()},3e3):this.takeProductResto();let t=JSON.parse(localStorage.getItem("setting"));Array.isArray(t)?t[0].use_gamme&&(this.storeTypeTab.push("Gammes"),this.getAllGamme()):t.use_gamme&&(this.storeTypeTab.push("Gammes"),this.getAllGamme()),localStorage.getItem("addFlag")&&(this.numFacture=JSON.parse(localStorage.getItem("order")).numFacture,this.flagAdd=localStorage.getItem("addFlag"))}cancelAdd(){localStorage.removeItem("order"),localStorage.removeItem("addFlag"),this.flagAdd=!1}getSettins(){this.adminService.getCompanySetting().pipe((0,h.R)(this.destroy$)).subscribe(t=>{this.tabRoles.includes(5)&&(t.company[0].use_gamme&&this.storeTypeTab.push("Gamme"),t.company[0].SaleInPack?(this.checkPack=!0,localStorage.setItem("saleAsPack","true")):this.checkPack=!1,this.storeTypeTab=JSON.parse(localStorage.getItem("adminUser")).storeType,this.pet=this.storeTypeTab[0],this.storeTypeTab.includes("bar")&&this.takeProduct(),t.company.use_gamme&&(this.storeTypeTab.push("Gammes"),this.getAllGamme()),this.storeTypeTab.includes("services")&&setTimeout(()=>{this.takeGame()},1500),this.storeTypeTab.includes("shop")&&setTimeout(()=>{this.takeProductListShop()},1500),this.storeTypeTab.includes("resto")&&this.storeTypeTab.includes("bar")?setTimeout(()=>{this.takeProductResto()},3e3):this.takeProductResto(),localStorage.getItem("addFlag")&&(this.numFacture=JSON.parse(localStorage.getItem("order")).numFacture,this.flagAdd=localStorage.getItem("addFlag")));let e=null,i=t.company[0];localStorage.setItem("setting",JSON.stringify(i)),i.macServer&&(e=i.macServer,localStorage.setItem("mac",e)),i.use_wifi?this.urlService.useWifiIp(i):i.use_desktop?this.urlService.useDesktop(i):i.macServer?this.urlService.useLocalServer(e):this.notification.presentError("please provide the configuration to use local server","warning"),this.autorisationNumber=0,this.cacheService.cacheRequest("MySettings",t)},t=>{this.cacheService.getCachedRequest("MySettings").then(t=>{t&&this.settingOfflineMode(t)})})}takeCashOpen(){let t=JSON.parse(localStorage.getItem("user")).storeId;this.adminService.getOpenCashFromPointOfSale(t).subscribe(t=>{t.docs.length?(this.getCategories(),this.openCashDate=t.docs[0].openDate,localStorage.setItem("openCashDate",this.openCashDate),localStorage.setItem("openCashDateObj",JSON.stringify(t.docs[0]))):this.cashDateAlert()})}getOrdersFromLocalServer(){setInterval(()=>{let t=JSON.parse(localStorage.getItem("user"))._id,e=JSON.stringify({sender:t}),i=this.url+`invoice/ready/to/take?localId=${t}`;this.httpN.setDataSerializer("utf8"),this.httpN.patch(i,e,{}).then(t=>{alert(JSON.parse(JSON.stringify(t)));let e=JSON.parse(t.data);e&&e.length&&this.events.storeOrders(e,"saveAll",[]).then(t=>{})}).catch(t=>{})},2e4)}webServerSocket(t){return(0,a.mG)(this,void 0,void 0,function*(){this.manageSocket.getSocket().subscribe(e=>{e.on(`${t}newProductList`,t=>{});let i=JSON.parse(localStorage.getItem("user")).storeId;e.on("connect",function(){}),e.on(`${this.adminId}productItem`,t=>{setTimeout(()=>(0,a.mG)(this,void 0,void 0,function*(){if(t&&t._id){this.checkPack&&(t=yield this.convert.convertSingleProduct(t));let e=yield this.allUserProducts.findIndex(e=>e._id===t._id);if(e>=0){let i=this.allUserProducts[e].url;this.allUserProducts.splice(e,1,t),this.allUserProducts[e].url=i}let i=yield this.cacheService.getCachedRequest("MyProductItems");if(i){let e=yield i.findIndex(e=>e._id===t._id);if(e>=0){let o=i[e].url;i.splice(e,1,t),i[e].url=o}yield this.cacheService.cacheRequest("MyProductItems",i)}}}),1e3)}),e.on(`${t}newBill`,t=>{this.takeProductResto();let e=JSON.parse(localStorage.getItem("user")).name,i=JSON.parse(localStorage.getItem("allBill"));if(JSON.parse(localStorage.getItem("openCashDateObj")),t.userName==e)if(i&&i.length)i.findIndex(e=>e.localId===t.localId)>=0||(i.push(t),localStorage.setItem("allBill",JSON.stringify(i)));else{let e=[];e.push(t),localStorage.setItem("allBill",JSON.stringify(e))}}),e.on(`${t}newSetting`,t=>{setTimeout(()=>{this.cacheService.getCachedRequest("MySettings").then(e=>{e&&(e.company[0]=t,this.cacheService.cacheRequest("MySettings",e))}),this.urlService.useWifiIp(t)},2e3)}),e.on(`${t}productItemGlace`,t=>(0,a.mG)(this,void 0,void 0,function*(){if(t&&t._id){let e=yield this.allUserProducts.findIndex(e=>e._id===t._id);if(e>=0){let i=this.allUserProducts[e].url;this.allUserProducts.splice(e,1,t),this.allUserProducts[e].url=i}let i=yield this.cacheService.getCachedRequest("MyProductItems");if(i){let e=yield i.findIndex(e=>e._id===t._id);if(e>=0){let o=i[e].url;i.splice(e,1,t),i[e].url=o}yield this.cacheService.cacheRequest("MyProductItems",i)}}})),e.on(`${t}productItemToShop`,t=>(0,a.mG)(this,void 0,void 0,function*(){if(t&&t._id){let e=yield this.allUserProducts.findIndex(e=>e._id===t._id);if(e>=0){let i=this.allUserProducts[e].url;this.allUserProducts.splice(e,1,t),this.allUserProducts[e].url=i}let i=yield this.cacheService.getCachedRequest("MyProductItems");if(i){let e=yield i.findIndex(e=>e._id===t._id);if(e>=0){let o=i[e].url;i.splice(e,1,t),i[e].url=o}yield this.cacheService.cacheRequest("MyProductItems",i)}}})),e.on(`${t}manufacturedItem`,t=>(0,a.mG)(this,void 0,void 0,function*(){if(t&&t._id){let e=yield this.productResto.findIndex(e=>e._id===t._id),i=this.productResto[e].url;this.productResto.splice(e,1,t),this.productResto[e].url=i,this.productResto2=yield this.groupByService.groupArticles(this.productResto)}})),e.on(`${this.adminId}productlist`,t=>{this.productList.forEach(e=>{if(e[0].categoryName==t.categoryName){let i=e.findIndex(e=>e._id===t._id);i>=0&&e.splice(i,1,t)}})}),e.on(`${this.adminId}billardItem`,t=>{this.randomList.length&&(this.productListTab=this.randomList),this.productListTab.forEach(e=>{if(e[0].categoryName==t.categoryName){let i=e.findIndex(e=>e._id===t._id);i>=0&&(t.url=e[i].url,e.splice(i,1,t))}})}),e.on(`${this.adminId}${i}billardItem`,t=>{this.randomList.length&&(this.productListTab=this.randomList),this.productListTab.forEach(e=>{if(e[0].categoryName==t.categoryName){let i=e.findIndex(e=>e._id===t._id);i>=0&&(t.url=e[i].url,e.splice(i,1,t))}})}),e.on(`${this.adminId}${i}cashOpen`,t=>{this.takeCashOpen()}),e.on(`${this.adminId}${i}cashClose`,t=>{this.tabRoles.includes(5)&&(this.cacheService.cacheRequest("invoicePaie",[]),this.router.navigateByUrl("Login"),this.notification.presentToast("CASH IS CLOSE!","warning"))}),e.on(`${t}transactionNewItem`,t=>{this.notifi.presentToast("you have new notification","danger"),this.transaction.unshift(t.data)}),e.on(`${t}employeAdd`,t=>{this.takeEmployees()})})})}takeEmployees(){this.authService.getEmployees().subscribe(t=>{let e=t.employes.sort((t,e)=>t.name>e.name?1:-1);this.saveRandom.setEmployeList(e)})}takeProduct(){return(0,a.mG)(this,void 0,void 0,function*(){this.notification.presentLoading();let t=null;try{t=yield this.cacheService.getCachedRequest("MyProductItems"),console.log("store",t)}catch(e){t=null}t&&(this.allUserProducts=t,this.allUserProductsList=t,this.notification.dismissLoading()),this.restApiService.getProductItemData().pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){this.spinner=!0,this.isLoad=!0,this.allUserProducts=t,this.notification.dismissLoading(),this.handleProductItem(t)}),t=>{})})}handleProductItem(t){return(0,a.mG)(this,void 0,void 0,function*(){let e=t;if(this.saveRandom.checkIfIsRetailer()){let t=this.saveRandom.getRetailer().productsToSale;e=yield this.retailerPrice.converToRetailerPrice(t,e)}this.checkPack&&(this.saleToPack=!0,e=yield this.convert.convertToPack(e)),this.allUserProducts=e,this.allUserProductsList=e,this.tab.push(e),this.userProducts=this.tab,this.products=[],this.choise="boisson",this.cacheService.cacheRequest("MyProductItems",this.allUserProducts)})}fireSlide(t){this.content.scrollToTop()}goToNextSlide(){this.slides.slideNext()}backToNextSlide(){this.slides.slidePrev()}takeProductResto(){return(0,a.mG)(this,void 0,void 0,function*(){console.log("url event for request",this.urlEvent);let t=yield this.cacheService.getCachedRequest("productsResto").catch(t=>{this.restApiService.getManufacturedProductItemResto3(this.urlEvent).pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){let e=[];return this.productResto=t,e=yield this.groupByService.groupArticles(t),this.productResto2=e,this.cacheService.cacheRequest("productsResto",this.productResto2)}),t=>{})});t&&t.length?(this.productResto=[],this.productResto2=t,this.productResto2.forEach(t=>{this.productResto=[...this.productResto,...t]}),this.restApiService.getManufacturedProductItemResto3(this.urlEvent).pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){let e=[];return this.productResto=t,e=yield this.groupByService.groupArticles(t),this.productResto2=e,this.cacheService.cacheRequest("productsResto",this.productResto2)}),t=>{})):this.restApiService.getManufacturedProductItemResto3(this.urlEvent).pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){let e=[];return this.productResto=t,e=yield this.groupByService.groupArticles(t),this.productResto2=e,this.cacheService.cacheRequest("productsResto",this.productResto2)}),t=>{})})}removeOne(t,e){return(0,a.mG)(this,void 0,void 0,function*(){if("modeG"===e){if(t.modeG<=0)return;t.modeG=t.modeG-1,t.glace++,t.quantityStore++,this.removeOneItem(t)}else if("modeNG"===e){if(t.modeNG<=0)return;t.modeNG=t.modeNG-1,t.quantityStore++,this.removeOneItem(t)}else if("CA"===e){if(t.CA<=0)return;t.CA=t.CA-1,t.cassierStore=t.cassierStore+1,this.removeOneCA(t)}else if("BTL"===e){if(t.BTL<=0)return;t.BTL=t.BTL-1,t.btlsStore=t.btlsStore+1,this.removeOneItem(t,t._id)}else console.log("aucun mode"),this.removeIn(t.item)})}buyOne(t,e){return(0,a.mG)(this,void 0,void 0,function*(){if("modeG"===e){if(t.modeG<=0)return;t.modeG=t.modeG+1,t.glace=t.glace-1,t.quantityStore=t.quantityStore-1}else if("modeNG"===e){if(t.modeNG<=0)return;t.modeNG=t.modeNG+1,t.quantityStore=t.quantityStore-1}else if("CA"===e){if(t.CA<=0)return;t.CA=t.CA+1,t.cassierStore=t.cassierStore-1,this.addOneCA(t)}else if("BTL"===e){if(t.BTL<=0)return;t.BTL=t.BTL+1,t.btlsStore=t.btlsStore-1,this.addOneSpecificItme(t,t._id+"BTL"+t._id)}else t.quantityStore--,t.nbr&&(t.nbr=t.nbr+1),t.qty&&(t.qty=t.qty+1),this.removeOneItem(t)})}buyItem(t,e,i){return(0,a.mG)(this,void 0,void 0,function*(){if(this.checkPack&&1==t.sellingPackPrice)return void this.notification.presentToast("please provide selling pack price for this product after you use it, contact your admin company","danger");if(e<=0&&t.resourceList.length<=0)return void this.showPresentAlert();if("BTL"==i?(t.orientationBTL="BTL",t.orientationCA=null):"CA"==i&&(t.orientationCA="CA",t.orientationBTL=null),t.glace&&e==t.glace&&"NG"===i&&t.resourceList.length<=0)return void this.showPresentAlert();if(t.resourceList.length&&(yield this.checkIfAvaible(t)).includes(!1))return void this.showPresentAlert(this.tabNotif);let o=new d(t).add(i);void 0!==o&&(t.modeNG=o.modeNG,t.modeG=o.modeG,t.nonglace=o.nonglace,t.glace=o.glace,t.quantityStore=o.quantityStore,t.CA=o.CA,t.BTL=o.BTL,t.cassierStore=o.cassierStore,t.btlsStore=o.btlsStore,this.incremente(t))})}removeOneItem(t,e){return(0,a.mG)(this,void 0,void 0,function*(){let i,o=this.restApiService.getCart2();console.log("shop page.ts 1137 ===>",t),i=e?this.manageCartService.removeOneToCart(t._id,o.cart,e):this.manageCartService.removeOneToCart(t._id,o.cart),console.log("shop page.ts 1146 ===>",i),this.totalItems=i.cart.totalQty,this.totalPrice=i.cart.totalPrice,this.restApiService.saveCart({cart:i.cart,products:i.cart.generateArray()})})}removeOneCA(t){return(0,a.mG)(this,void 0,void 0,function*(){let e,i=this.restApiService.getCart2();e=yield this.manageCartService.removeOneCaToCart(t._id,i.cart),this.totalItems=e.cart.totalQty,this.totalPrice=e.cart.totalPrice,this.restApiService.saveCart({cart:e.cart,products:e.cart.generateArray()})})}addOneCA(t){return(0,a.mG)(this,void 0,void 0,function*(){let e,i=this.restApiService.getCart2();e=yield this.manageCartService.addOneCaToCart(t._id,i.cart),this.totalItems=e.cart.totalQty,this.totalPrice=e.cart.totalPrice,this.restApiService.saveCart({cart:e.cart,products:e.cart.generateArray()})})}addOneSpecificItme(t,e){return(0,a.mG)(this,void 0,void 0,function*(){let i;this.restApiService.getCart2(),i=yield this.manageCartService.addOneSpecific(t,e),this.totalItems=i.cart.totalQty,this.totalPrice=i.cart.totalPrice,this.restApiService.saveCart({cart:i.cart,products:i.cart.generateArray()})})}changeNumTable(t){return(0,a.mG)(this,void 0,void 0,function*(){let t;for(this.productResto.forEach(t=>{t.nbr=0}),this.productResto2=yield this.groupByService.groupArticles(this.productResto),this.numPlat=this.plalist.length+1,this.numPlatRandom=this.numPlat,this.plalist.push(this.numPlat),t=0;t<this.items._results.length;t++)this.items._results[t].nativeElement.classList.remove("platActif");let e=this.items._results.length-1;setTimeout(()=>{this.items._results[e+1].nativeElement.classList.add("platActif")},300)})}showPlat(t,e){return(0,a.mG)(this,void 0,void 0,function*(){let i;for(i=0;i<this.items._results.length;i++)this.items._results[i].nativeElement.classList.remove("platActif");this.items._results[e].nativeElement.classList.add("platActif");let o=[];this.numPlatRandom=t,this.numPlat=t,this.plat.forEach(e=>{e.plat==t&&e.nbr>0&&o.push(e.produit)}),this.productResto.forEach(e=>{e.nbr=0,this.plat.forEach(i=>{i.plat==t&&i.nbr>0&&i.produit._id==e._id&&(e.nbr=i.nbr)})})})}removeIn(t){return(0,a.mG)(this,void 0,void 0,function*(){if(console.log(t),t.nbr>0&&(t.nbr=t.nbr-1),0==t.nbr&&(t.nbr=0),"Gamme"==t.productType){let e=[];this.productListTab.forEach(t=>{e=[...e,...t]}),t.productList&&t.productList.forEach(t=>{let i=e.findIndex(e=>e._id==t._id);i>=0&&(e[i].quantityStore=e[i].quantityStore+1)})}else setTimeout(()=>{this.removeOneItem(t),t.quantityStore=t.quantityStore+1},500)})}removeInPlat(t,e){return(0,a.mG)(this,void 0,void 0,function*(){t.nbr>0&&(t.nbr=t.nbr-1),0==t.nbr&&(t.nbr=0),setTimeout(()=>{this.removeOneItem(t)},500),this.plat.forEach(e=>{e.plat==this.numPlatRandom&&e.produit._id==t._id&&(e.nbr=e.nbr-1)})})}buyItemResto(t,e){return(0,a.mG)(this,void 0,void 0,function*(){if(t.index=e,t.resourceList&&t.resourceList.length&&(yield this.checkIfAvaible(t)).includes(!1))return void this.showPresentAlert(this.tabNotif);let i=this.plat.findIndex(e=>e.plat==this.numPlat&&e.produit._id==t._id);if(i>=0?(t.nbr=t.nbr?t.nbr+1:1,this.plat.splice(i,1,{plat:this.numPlat,produit:t,nbr:t.nbr})):(t.nbr=1,this.plat.push({plat:this.numPlat,produit:t,nbr:1})),this.cartValue=this.restApiService.getCart2(),this.Itemprice-this.Reduction<=100)this.presentAlert();else if(this.Itemprice>0&&this.Itemprice-this.Reduction>100);else if(this.cartValue&&this.cartValue.cart){let i={};i.product=t,i.cart=this.cartValue.cart;let o=this.manageCartService.addToCart(i);this.totalItems=o.totalQty,this.totalPrice=o.totalPrice,this.restApiService.saveCart({cart:o,products:o.generateArray()}),this.countItemsService.getQtyItems(this.productResto,o.generateArray(),t);let s=this.productResto2[e].findIndex(e=>e._id==t._id);s>=0&&this.productResto2[e].splice(s,1,t)}else{let i=this.manageCartService.addToCart(t);this.totalItems=i.totalQty,this.totalPrice=i.totalPrice,this.restApiService.saveCart({cart:i,products:i.generateArray()});let o=this.countItemsService.getQtyItems(this.productResto,i.generateArray(),t);this.productResto=o;let s=this.productResto2[e].findIndex(e=>e._id==t._id);s>=0&&this.productResto2[e].splice(s,1,t)}})}buyItemGame(t,e,i){return(0,a.mG)(this,void 0,void 0,function*(){if(!this.saveRandom.getVoucher()||this.checkVoucher(t)){if(t.resourceList&&t.resourceList.length&&(yield this.checkIfAvaible(t)).includes(!1))return void this.showPresentAlert(this.tabNotif);if(t.quantityStore<=0&&!t._id.endsWith("vide")&&this.saveRandom.getSetting().check_service_quantity){let t={};return this.translate.get("MENU.not_enough").subscribe(e=>{t.message=e}),void this.notification.presentError(t.message,"danger")}if(t._id.endsWith("vide")&&t.bottle_empty<=0&&this.saveRandom.getSetting().check_service_quantity){let t={};return this.translate.get("MENU.not_enough").subscribe(e=>{t.message=e}),void this.notification.presentError(t.message,"danger")}if(this.cartValue=this.restApiService.getCart2(),t._id.endsWith("vide"))if(t.status="vide",this.cartValue&&this.cartValue.cart){let e={};e.product=t,e.cart=this.cartValue.cart;let i=this.manageCartService.addToCart(e);this.totalItems=i.totalQty,this.totalPrice=i.totalPrice,this.restApiService.saveCart({cart:i,products:i.generateArray()});let o=this.countItemsService.getQtyItems(this.productsGame,i.generateArray(),t);t.nbr=t.nbr?t.nbr+1:1,this.productsGame=o,t.bottle_empty=t.bottle_empty-1}else{let e=this.manageCartService.addToCart(t);this.totalItems=e.totalQty,this.totalPrice=e.totalPrice,this.restApiService.saveCart({cart:e,products:e.generateArray()});let i=this.countItemsService.getQtyItems(this.productsGame,e.generateArray(),t);this.productsGame=i,t.nbr=t.nbr?t.nbr+1:1,t.bottle_empty=t.bottle_empty-1}else if(t.quantityStore>0||"billard"==t.productType)if(this.cartValue&&this.cartValue.cart){let e={};e.product=t,e.cart=this.cartValue.cart;let i=this.manageCartService.addToCart(e);this.totalItems=i.totalQty,this.totalPrice=i.totalPrice,this.restApiService.saveCart({cart:i,products:i.generateArray()});let o=this.countItemsService.getQtyItems(this.productsGame,i.generateArray(),t);t.nbr=t.nbr?t.nbr+1:1,this.productsGame=o,parseInt(t.quantityStore)&&(t.quantityStore=parseInt(t.quantityStore)),t.quantityStore>0&&(t.quantityStore=t.quantityStore-1)}else{let e=this.manageCartService.addToCart(t);this.totalItems=e.totalQty,this.totalPrice=e.totalPrice,this.restApiService.saveCart({cart:e,products:e.generateArray()});let i=this.countItemsService.getQtyItems(this.productsGame,e.generateArray(),t);this.productsGame=i,t.nbr=t.nbr?t.nbr+1:1,t.quantityStore>0&&(t.quantityStore=t.quantityStore-1)}else console.log("====",t),this.showPresentAlert()}else this.notification.presentAlert(`Le montant des achats ne doit pas depasser ${this.saveRandom.getVoucher().price}`)})}segmentChanged(t){return(0,a.mG)(this,void 0,void 0,function*(){this.showMe=!1,this.notification.presentLoading(),this.pet=t.target.value,this.isLoad=!0,setTimeout(()=>{this.showMe=!0,this.notification.dismissLoading()},200)})}logScrollStart(){}logScrollEnd(){}logScrolling(t){return(0,a.mG)(this,void 0,void 0,function*(){})}buyPack(t){if(this.cartValue=this.restApiService.getCart2(),this.cartValue){let e={};e.product=t,e.cart=this.cartValue.cart;let i=this.manageCartService.addToCart(e);this.totalItems=i.totalQty,this.restApiService.saveCart({cart:i,products:i.generateArray()})}else{let e=this.manageCartService.addToCart(t);this.totalItems=e.totalQty,this.restApiService.saveCart({cart:e,products:e.generateArray()})}}getCart(){this.cartValue=this.restApiService.getCart()}displayCart(){this.navCtrl.navigateForward("cart")}openCart(){return(0,a.mG)(this,void 0,void 0,function*(){this.notification.presentLoading(),this.plat.length?localStorage.setItem("plat",JSON.stringify(this.plat)):localStorage.setItem("plat",JSON.stringify([]));const t=yield this.modalController.create({component:l.V,backdropDismiss:!1});return t.onDidDismiss().then(t=>(0,a.mG)(this,void 0,void 0,function*(){return t.data&&t.data.order?(this.confirmAndPrint(t.data.order),this.restApiService.getCart(),this.restApiService.cleanCart(),localStorage.removeItem("order"),localStorage.removeItem("addFlag"),this.flagAdd=!1,this.totalItems=0,this.totalPrice=0,this.restApiService.saveCart({}),this.plalist=[],this.plalist=[1],this.numPlat=1,this.plat=[],this.numPlatRandom=0,JSON.parse(localStorage.getItem("setting")).use_gamme&&this.gammeListTab.forEach(t=>{t.nbr=0,t.quantityToSale=0}),this.userProducts2&&this.userProducts.length>0&&this.userProducts.forEach(t=>{t.modeG&&(t.modeG=0),t.modeNG&&(t.modeNG=0),t.qty&&(t.qty=0),t.cassierStore=parseInt(t.CA)?t.cassierStore+t.CA:t.cassierStore,t.btlsStore=parseInt(t.BTL)?t.btlsStore+t.BTL:t.btlsStore,t.CA&&(t.CA=0),t.BTL&&(t.BTL=0)}),this.allUserProductsList.forEach(t=>{t.modeG&&(t.modeG=0),t.modeNG&&(t.modeNG=0),t.qty&&(t.qty=0),parseInt(t.CA)||(t.cassierStore=t.cassierStore),parseInt(t.BTL)||(t.btlsStore=t.btlsStore),t.CA&&(t.CA=0),t.BTL&&(t.BTL=0)}),localStorage.getItem("backTo")&&setTimeout(()=>{let t=JSON.parse(localStorage.getItem("backTo"));this.router.navigateByUrl(t.url),localStorage.removeItem("backTo")},2e3),this.packs&&this.packs.length>0&&this.packs.forEach(t=>{t.qty=0}),this.productsGame&&this.productsGame.length>0&&this.productsGame.forEach(t=>{t.qty=0}),this.productResto&&this.productResto.length>0&&(this.productResto.forEach(t=>{t.nbr=0}),this.productResto2=yield this.groupByService.groupArticles(this.productResto)),this.productList&&this.productList.length>0&&this.productList.forEach(t=>{t.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0)})}),void(this.productListTab&&this.productListTab.length>0&&this.productListTab.forEach(t=>{t.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0,t.quantityStore=parseInt(t.quantityStore))})}))):void 0===t.data?(JSON.parse(localStorage.getItem("setting")).use_gamme&&this.gammeListTab.forEach(t=>{t.nbr=0,t.quantityToSale=0}),localStorage.getItem("backTo")&&localStorage.removeItem("backTo"),this.randomP&&this.randomP.length&&(this.userProducts2=this.randomP),this.randomList&&this.randomList.length&&(this.productListTab=this.randomList),this.randomResto&&this.randomResto.length&&(this.productResto2=this.randomResto),this.randomShop&&this.randomShop.length&&(this.arrList=this.randomShop),this.events.refresh(),this.restApiService.cleanCart(),this.totalItems=0,this.totalPrice=0,this.restApiService.saveCart({}),this.plalist=[],this.plalist=[1],this.numPlat=1,this.plat=[],this.numPlatRandom=0,this.userProducts2&&this.userProducts2.length&&this.userProducts2.forEach(t=>{t.forEach(t=>{t.forEach(t=>{t.quantityStore=parseInt(t.modeNG)?t.modeNG+t.quantityStore:t.quantityStore,t.glace=parseInt(t.modeG)?t.modeG+t.glace:t.glace,t.cassierStore=parseInt(t.CA)?t.CA+t.cassierStore:t.cassierStore,t.btlsStore=parseInt(t.BTL)?t.BTL+t.btlsStore:t.btlsStore,t.qty=0,t.modeG=0,t.modeNG=0,t.BTL=0,t.CA=0})})}),this.productsGame.forEach(t=>{t.qty&&(t.qty=0)}),this.productResto.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0)}),this.productResto2=yield this.groupByService.groupArticles(this.productResto),this.productList.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0)}),void this.productListTab.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0)})):("true"===localStorage.getItem("manageStockWithService")&&JSON.parse(localStorage.getItem("d")),"update"===t.data?(this.restApiService.getCart(),this.restApiService.cleanCart(),localStorage.removeItem("order"),localStorage.removeItem("addFlag"),this.flagAdd=!1,this.totalItems=0,this.totalPrice=0,this.restApiService.saveCart({}),this.plalist=[],this.plalist=[1],this.numPlat=1,this.plat=[],this.numPlatRandom=0,JSON.parse(localStorage.getItem("setting")).use_gamme&&this.gammeListTab.forEach(t=>{t.nbr=0,t.quantityToSale=0}),this.userProducts2&&this.userProducts.length>0&&this.userProducts.forEach(t=>{t.modeG&&(t.modeG=0),t.modeNG&&(t.modeNG=0),t.qty&&(t.qty=0),t.cassierStore=parseInt(t.CA)?t.cassierStore+t.CA:t.cassierStore,t.btlsStore=parseInt(t.BTL)?t.btlsStore+t.BTL:t.btlsStore,t.CA&&(t.CA=0),t.BTL&&(t.BTL=0)}),this.allUserProductsList.forEach(t=>{t.modeG&&(t.modeG=0),t.modeNG&&(t.modeNG=0),t.qty&&(t.qty=0),parseInt(t.CA)||(t.cassierStore=t.cassierStore),parseInt(t.BTL)||(t.btlsStore=t.btlsStore),t.CA&&(t.CA=0),t.BTL&&(t.BTL=0)}),localStorage.getItem("backTo")&&setTimeout(()=>{let t=JSON.parse(localStorage.getItem("backTo"));this.router.navigateByUrl(t.url),localStorage.removeItem("backTo")},2e3),this.packs&&this.packs.length>0&&this.packs.forEach(t=>{t.qty=0}),this.productsGame&&this.productsGame.length>0&&this.productsGame.forEach(t=>{t.qty=0}),this.productResto&&this.productResto.length>0&&(this.productResto.forEach(t=>{t.nbr=0}),this.productResto2=yield this.groupByService.groupArticles(this.productResto)),this.productList&&this.productList.length>0&&this.productList.forEach(t=>{t.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0)})}),void(this.productListTab&&this.productListTab.length>0&&this.productListTab.forEach(t=>{t.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.nbr=0)})}))):t.data.products&&t.data.products.length?(this.packs.forEach(e=>{let i=e._id;t.data.products.forEach(t=>{t.item._id==i&&(e.qty=t.qty,this.updateTabPacks(e,i))})}),this.products.forEach(e=>{let i=e._id;t.data.products.forEach(t=>{t.item._id==i&&(e.qty=t.qty,this.updateTabProducts(e,i))})}),void this.productResto.forEach(e=>{let i=e._id;t.data.products.forEach(t=>{t.item._id==i&&(e.qty=t.qty,this.updateTabProResto(e,i))})})):void("update-cancel"===t.data?(this.restApiService.getCart(),this.restApiService.cleanCart(),localStorage.removeItem("order"),localStorage.removeItem("addFlag"),this.flagAdd=!1,this.totalItems=0,this.totalPrice=0,this.restApiService.saveCart({}),this.productsGame&&this.productsGame.length>0&&this.productsGame.forEach(t=>{t.qty=0}),this.productResto&&this.productResto.length>0&&(this.productResto.forEach(t=>{t.quantityStore=t.nbr+t.quantityStore,t.nbr=0}),this.productResto2=yield this.groupByService.groupArticles(this.productResto)),this.productList&&this.productList.length>0&&this.productList.forEach(t=>{t.forEach(t=>{t.qty&&(t.qty=0),t.nbr&&(t.quantityStore=t.nbr+t.quantityStore,t.nbr=0)})}),this.productListTab&&this.productListTab.length>0&&this.productListTab.forEach(t=>{t.forEach(t=>{console.log(t),t.qty&&(t.quantityStore=t.qty+t.quantityStore,t.qty=0),t.nbr&&(t.quantityStore=t.nbr+t.quantityStore,t.nbr=0)})})):(this.totalItems=t.data.cart.totalQty,this.totalPrice=t.data.cart.totalPrice,this.restApiService.saveCart(t.data))))})),yield t.present().then(t=>{this.notification.dismissLoading()})})}presentAlert(){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"Alert",subHeader:"Subtitle",message:"le prix entr\xe9 n.est pas bon.",buttons:["OK"]});yield t.present()})}initializeItems(){this.products2=this.products}handleInputItems(t){this.notification.presentLoading();const e=t.target.value;e&&""!=e.trim()?(this.isItemAvailable=!0,this.restApiService.getProductByName(e).subscribe(t=>{this.notification.dismissLoading(),this.products2=t.product})):(this.isItemAvailable=!1,this.products2=[])}handleInputPack(t){this.notification.presentLoading();const e=t.target.value;e&&""!=e.trim()?(this.isItemAvailable2=!0,this.restApiService.getPackitemByName(e).subscribe(t=>{this.notification.dismissLoading(),this.pack2=t.pack})):(this.isItemAvailable2=!1,this.pack2=[])}search(t){this.isItemAvailable=!1,this.isItemAvailable2=!1}showPresentAlert(t){return(0,a.mG)(this,void 0,void 0,function*(){if(t){let e="";t.forEach(t=>{e+=` - ${t.name}\n          \n          , \n        `});const i=yield this.alertController.create({header:"NOT ENOUGTH:",message:e.toUpperCase(),buttons:["OK"]});yield i.present()}else{const t=yield this.alertController.create({header:"ALERT",message:"NOT ENOUGTH IN STOCK!\n        please contact wharehouse",cssClass:"AlertStock",buttons:["OK"]});yield t.present()}})}cashDateAlert(){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"ALERT",message:"PLEASE OPEN CASH DATE!",cssClass:"AlertStock",buttons:["OK"]});yield t.present()})}updateTabPacks(t,e){let i=t,o=this.packs.findIndex(t=>t._id===e);this.packs.splice(o,1,i)}updateTabProducts(t,e){let i=t,o=this.products.findIndex(t=>t._id===e);this.products.splice(o,1,i)}updateTabProResto(t,e){return(0,a.mG)(this,void 0,void 0,function*(){let i=t,o=this.productResto.findIndex(t=>t._id===e);this.productResto.splice(o,1,i),this.productResto2=yield this.groupByService.groupArticles(this.productResto)})}clearCache(t){this.imageLoader.clearCache()}onImageLoad(t){}presentLoading2(){return(0,a.mG)(this,void 0,void 0,function*(){return this.isLoading=!0,yield this.loadingController.create({duration:6e3}).then(t=>{t.present().then(()=>{this.isLoading||t.dismiss().then()})})})}incremente(t){if(this.platform.is("android")&&this.networkService.getCurrentNetworkStatus()==u.Q.Offline&&this.tabRoles.includes(5))this.toastController.create({message:"please check with point of sale.",duration:5e3,position:"bottom"}).then(t=>t.present());else if(this.cartValue=this.restApiService.getCart2(),this.Itemprice-this.Reduction<=100)this.presentAlert();else if(this.Itemprice>0&&this.Itemprice-this.Reduction>100);else if(this.autorisationNumber&&t.store<=this.autorisationNumber)t.quantityStore&&this.warnin(t);else if(this.cartValue&&this.cartValue.cart){this.cartValue.products.filter(e=>e.item._id===t._id);let e={};e.product=t,e.cart=this.cartValue.cart;let i=this.manageCartService.addToCart(e);this.totalItems=i.totalQty,this.totalPrice=i.totalPrice,this.restApiService.saveCart({cart:i,products:i.generateArray()});let o=this.countItemsService.getQtyItems(this.products,i.generateArray(),t);this.products=o}else{let e=this.manageCartService.addToCart(t);this.totalItems=e.totalQty,this.totalPrice=e.totalPrice,this.restApiService.saveCart({cart:e,products:e.generateArray()});let i=this.countItemsService.getQtyItems(this.products,e.generateArray(),t);this.products=i}}gestionNonGlace(t,e){t.modeNG?(t.modeNG=t.modeNG+1,t.quantityStore=t.quantityStore-1,t.nonglace=t.glace?t.quantityStore-t.glace:t.quantityStore):(t.modeNG=1,t.quantityStore=t.quantityStore-1,t.nonglace=t.glace?t.quantityStore-t.glace:t.quantityStore),e&&this.incremente(t)}warnin(t){if(this.cartValue&&this.cartValue.cart){let e=this.cartValue.products.filter(e=>e.item._id===t._id)[0];if(e&&e.qty===t.quantityStore)return;{let e={};e.product=t,e.cart=this.cartValue.cart;let i=this.manageCartService.addToCart(e);this.totalItems=i.totalQty,this.totalPrice=i.totalPrice,this.restApiService.saveCart({cart:i,products:i.generateArray()});let o=this.countItemsService.getQtyItems(this.products,i.generateArray(),t);this.products=o}}}screenCheck(){this.screensizeService.isDesktopView().pipe((0,h.R)(this.destroy$)).subscribe(t=>{this.isDesktop=t})}compare(t,e){return t.categoryName<e.categoryName?-1:t.categoryName>e.categoryName?1:0}getCategories(){let t=JSON.parse(localStorage.getItem("adminUser"));this.categories=t.storeType}sendToServer(t){let e=[];var i;(0,L.D)(t).pipe((i=t=>t.produceBy,t=>t.lift(new v(i,void 0,void 0,void 0))),(0,A.zg)(t=>t.pipe(function(t,e){return arguments.length>=2?function(i){return(0,I.z)((0,Z.R)(t,e),(0,x.h)(1),(0,q.d)(e))(i)}:function(e){return(0,I.z)((0,Z.R)((e,i,o)=>t(e,i,o+1)),(0,x.h)(1))(e)}}(C,[])))).subscribe(t=>{e.push(t)}),this.userProducts=e,this.choise=this.userProducts[0][0].packSize?"all":"mychoise"}sendData(){let t=JSON.parse(localStorage.getItem("storedreq"));if(t&&t.length){let e=t[0];this.offlineManager.sendLocalDataToserver(e).subscribe(i=>{t=t.filter(t=>t!==e),e.data._id=e.id,setTimeout(()=>{},1e3),localStorage.setItem("storedreq",JSON.stringify(t))})}}notifier(t){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:t,duration:5e3,animated:!0,position:"top"})).present()})}checkIfAvaible(t){return(0,a.mG)(this,void 0,void 0,function*(){return new Promise((e,i)=>(0,a.mG)(this,void 0,void 0,function*(){let i=[];if(this.tabNotif=[],this.saveRandom.getSetting().check_resource){if(t.resourceList.length){let o=t.resourceList,s=yield this.resourceService.checkAvaibleResources(t.resourceList),r=0;o.forEach(e=>(0,a.mG)(this,void 0,void 0,function*(){t.qtyRandom=t.qty?t.qty+1:1;let o=yield this.verifyAsync(t,r,e,s,i,e.quantity*t.qtyRandom);i=[...i,...o]})),e(i)}}else e([!0])}))})}verifyAsync(t,e,i,o,s,r){return new Promise((t,e)=>{o.forEach(t=>{"productItems"==t.thetype&&(t.resourceId=t.productId,t.sizeUnit=1,t.unitName=t.unitNameProduct,t.random=t.quantityStore*t.sizeUnitProduct),t.resourceId==i.resourceId&&(t.unitName==i.unitName&&(t.random&&t.random>=0&&t.random*t.sizeUnit-r>=0&&r>0?s.push(!0):t.random&&t.random>=0&&t.random*t.sizeUnit-r<0&&r>0?(s.push(!1),this.tabNotif.push(t)):t.quantityStore*t.sizeUnit-r>=0&&r>0?s.push(!0):(s.push(!1),this.tabNotif.push(t))),"kg"==t.unitName&&"g"==i.unitName&&(t.quantityStore*t.sizeUnit*1e3-r>=0&&r>0?s.push(!0):(s.push(!1),this.tabNotif.push(t))),"l"==t.unitName&&"cl"==i.unitName&&(t.random&&t.random>=0&&t.random*t.sizeUnit-r>=0&&r>0?s.push(!0):t.random&&t.random>=0&&t.random*t.sizeUnit-r<0&&r>0?(s.push(!1),this.tabNotif.push(t)):t.quantityStore*t.sizeUnit*100-r>=0&&r>0?s.push(!0):(s.push(!1),this.tabNotif.push(t))))}),t(s)})}takeGame(){return(0,a.mG)(this,void 0,void 0,function*(){this.notification.presentLoading(),this.cacheService.getCachedRequest("serviceProductList").then(t=>{this.productListTab=t,this.notification.dismissLoading(),this.restApiService.getBillardList().pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){console.log("billard list here",t);let e=[];if(t){let i=JSON.parse(localStorage.getItem("setting"));if(this.saveRandom.checkIfIsRetailer()){let i=this.saveRandom.getRetailer().productsToSale;e=yield this.retailerPrice.converToRetailerPrice(i,t),e=yield this.groupByService.groupArticles(e),this.productListTab=[],this.productListTab=e,this.notification.dismissLoading()}else i.use_gamme&&(this.urlPackage=t[0].url,this.gammeService.setProducts(t)),e=yield this.groupByService.groupArticles(t),this.productListTab=e,this.notification.dismissLoading(),this.cacheService.cacheRequest("serviceProductList",this.productListTab)}}))}).catch(t=>{this.restApiService.getBillardList().pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){let e=[];t&&(JSON.parse(localStorage.getItem("setting")).use_gamme&&this.gammeService.setProducts(t),e=yield this.groupByService.groupArticles(t),this.productListTab=e,this.notification.dismissLoading(),this.cacheService.cacheRequest("serviceProductList",this.productListTab))}),t=>{this.notification.dismissLoading()})})})}getAllGamme(){return(0,a.mG)(this,void 0,void 0,function*(){this.cacheService.getCachedRequest("gammeList").then(t=>{this.gammeListTab=t,this.gammeService.getGammeList().pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){t&&(this.gammeListTab=t,this.cacheService.cacheRequest("gammeList",this.gammeListTab))}))}).catch(t=>{this.gammeService.getGammeList().pipe((0,h.R)(this.destroy$)).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){console.log(t),t&&(this.gammeListTab=t,this.cacheService.cacheRequest("gammeList",this.gammeListTab))}))})})}segmentListChanged(t){this.arr.forEach(e=>{e[0].superCategory==t.target.value&&(this.productList=e)})}findProductList(t){const e=t.target.value;e&&""!==e.trim()?(this.isItemAvailable3=!0,this.arrList2=this.arrListRandom.filter(t=>t.name.toLowerCase().indexOf(e.toLowerCase())>-1)):this.isItemAvailable3=!1}findProductItemList(t){const e=t.target.value;e&&""!==e.trim()?(this.isItemAvailable3=!0,this.arrList2=this.allUserProductsList.filter(t=>t.name.toLowerCase().indexOf(e.toLowerCase())>-1)):this.isItemAvailable3=!1}buyEmptyBottle(t){let e=this.restApiService.getCart2();console.log(e);let i=0,o={};for(const s in t)o[s]=t[s];if(o._id=o._id+"vide",o.sellingPrice=o.bottle_empty_Price,o.name=t.name+" vide",o.originId=t._id,o.sale_type="emballage",e&&e.products){let t=o._id,s=e.products.find(e=>e.item._id==t);s&&(i=s.qty+1,console.log(i))}else i=1;i&&i>t.bottle_empty?this.notification.presentError(`le nombre de bouteille vide ${t.name} en stock est insuffisant`,"danger"):this.buyItemGame(o)}buyEmballagePro(t){let e=this.restApiService.getCart2(),i=0,o={};for(const s in t)o[s]=t[s];if(o._id=o._id+"emballage&contenu",o.originId=t._id,o.sale_type="emballage&contenu",o.sellingPrice=o.bottle_empty_Price+t.sellingPrice,o.name=t.name+" EC",e&&e.products){let t=o._id,s=e.products.find(e=>e.item._id==t);s&&(i=s.qty+1,console.log(i))}else i=1;i&&i>t.quantityStore?this.notification.presentError(`le nombre de bouteille ${t.name} en stock est insuffisant`,"danger"):this.buyItemGame(o)}buyItemProList(t,e){this.buyItemGame(t,null,e),this.isItemAvailable3=!1}takeProductListShop(t){return(0,a.mG)(this,void 0,void 0,function*(){this.cacheService.getCachedRequest("productsListShop").then(e=>{this.arrListRandom=[],this.productList=e,e.forEach(t=>{this.arrListRandom=[...this.arrListRandom,...t]}),this.restApiService.getShopList2().pipe((0,h.R)(this.destroy$)).subscribe(e=>(0,a.mG)(this,void 0,void 0,function*(){let i=[];e&&(i=yield this.groupByService.groupArticles(e.product,t),this.productList=i,this.arrListRandom=e.product,this.cacheService.cacheRequest("productsListShop",this.productList))}),t=>console.log(t))}).catch(e=>{this.restApiService.getShopList2().pipe((0,h.R)(this.destroy$)).subscribe(e=>(0,a.mG)(this,void 0,void 0,function*(){let i=[];e&&(i=yield this.groupByService.groupArticles(e.product,t),this.productList=i,this.arrListRandom=e.product,this.cacheService.cacheRequest("productsListShop",this.productList))}),t=>console.log(t))})})}settingOfflineMode(t){this.tabRoles.includes(5)&&(t.company[0].SaleInPack?(this.checkPack=!0,localStorage.setItem("saleAsPack","true")):this.checkPack=!1,this.storeTypeTab=JSON.parse(localStorage.getItem("adminUser")).storeType,this.pet=this.storeTypeTab[0],this.storeTypeTab.includes("bar")&&this.takeProduct(),t.company.use_gamme&&(this.storeTypeTab.push("Gamme"),this.getAllGamme()),this.storeTypeTab.includes("services")&&setTimeout(()=>{this.takeGame()},1500),this.storeTypeTab.includes("shop")&&setTimeout(()=>{this.takeProductListShop()},1500),this.storeTypeTab.includes("resto")&&this.storeTypeTab.includes("bar")?setTimeout(()=>{this.takeProductResto()},3e3):this.takeProductResto(),localStorage.getItem("addFlag")&&(this.numFacture=JSON.parse(localStorage.getItem("order")).numFacture,this.flagAdd=localStorage.getItem("addFlag")));let e=null,i=t.company[0];localStorage.setItem("setting",JSON.stringify(i)),i.macServer&&(e=i.macServer,localStorage.setItem("mac",e)),i.use_wifi?this.urlService.useWifiIp(i):i.use_desktop?this.urlService.useDesktop(i):i.macServer?this.urlService.useLocalServer(e):this.notification.presentError("please provide the configuration to use local server","warning"),this.autorisationNumber=0}buyGamme(t){return(0,a.mG)(this,void 0,void 0,function*(){this.gammeService.setGamme(t);const e=yield this.modalController.create({component:N.W,componentProps:{}});return e.onDidDismiss().then(e=>(0,a.mG)(this,void 0,void 0,function*(){if(e.data&&1==e.data.add){let i=e.data.quantity;for(const c of e.data.gamme.productList)t.productList.find(t=>t._id==c._id)||(console.log("je pousse un nouveau"),t.productList.push(c));let o=e.data.reste,s=!0,r=[],n=[],a=[];if(this.productListTab.forEach(t=>{a=[...a,...t]}),o.length?o.forEach(t=>{let e=a.findIndex(e=>e._id==t._id);e>=0&&(a[e].quantityStore<t.toRemove*i?(s=!1,r.push(a[e])):a[e].quantityStore=a[e].quantityStore-t.toRemove*i)}):t.productList.forEach(t=>{let e=a.findIndex(e=>e._id==t._id);e>=0?a[e].quantityStore<t.toRemove*i?(s=!1,r.push(a[e])):a[e].quantityStore=a[e].quantityStore-t.toRemove*i:(console.log("not found"),n.push(t))}),t.sellingPrice=e.data.prix,n.length)this.notification.cancelSale(n);else{if(!s)return void this.notification.cancelSale(r);for(let o=0;o<i;o++)t.productList=e.data.gamme.productList,yield this.addGammeToCart(t);console.log("=====end here===")}}})),yield e.present()})}addGammeToCart(t){return new Promise((e,i)=>{if(this.checkVoucher(t),this.cartValue=this.restApiService.getCart2(),this.cartValue&&this.cartValue.cart){let i={};i.product=t,i.cart=this.cartValue.cart;let o=this.manageCartService.addToCart(i);this.totalItems=o.totalQty,this.totalPrice=o.totalPrice,this.restApiService.saveCart({cart:o,products:o.generateArray()}),t.nbr=t.nbr?t.nbr+1:1,e(t)}else{let i=this.manageCartService.addToCart(t);this.totalItems=i.totalQty,this.totalPrice=i.totalPrice,this.restApiService.saveCart({cart:i,products:i.generateArray()}),t.nbr=t.nbr?t.nbr+1:1,e(t)}})}checkVoucher(t){let e=this.saveRandom.getVoucher();if(e){let i=e.price-(this.totalPrice+t.sellingPrice);return console.log(i),i>=0}}confirmAndPrint(t){return(0,a.mG)(this,void 0,void 0,function*(){console.log("hello data",t),this.saveRandom.setData(t);const e=yield this.modalController.create({component:_.e,backdropDismiss:!0});return e.onDidDismiss().then(t=>(0,a.mG)(this,void 0,void 0,function*(){console.log(t)})),yield e.present().then(t=>{})})}getTransaction(){let t=2;t=this.tabRoles.includes(2)?2:0,this.adminService.getStoreMballusTransaction(this.saveRandom.getStoreId(),t).pipe((0,h.R)(this.destroy$)).subscribe(t=>{console.log("trasaction",t.docs),this.transaction=t.docs,this.transaction.length&&this.notifi.presentToast("you have new notification","danger")})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(k.e),c.Y36(w.B),c.Y36(G.w),c.Y36(n.SH),c.Y36(n.IN),c.Y36(n.Br),c.Y36(r.F0),c.Y36(n.HT),c.Y36(O.w),c.Y36(R.t),c.Y36(u.S),c.Y36(n.yF),c.Y36(J.l),c.Y36(E.e2),c.Y36(U.i),c.Y36(M.j),c.Y36(n.Dh),c.Y36($.J),c.Y36(n._q),c.Y36(Q.t),c.Y36(Y.g),c.Y36(B.z),c.Y36(z.n),c.Y36(F.W),c.Y36(H.n),c.Y36(n.t4),c.Y36(V.$),c.Y36(j.i),c.Y36(D.k),c.Y36(W.f),c.Y36(K.K),c.Y36(X.sK),c.Y36(Y.g),c.Y36(tt.u))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-shop"]],viewQuery:function(t,e){if(1&t&&(c.Gf(ot,1),c.Gf(st,1),c.Gf(n.W2,3),c.Gf(rt,1,c.SBq),c.Gf(nt,1)),2&t){let t;c.iGM(t=c.CRH())&&(e.slides=t.first),c.iGM(t=c.CRH())&&(e.slideWithNav=t.first),c.iGM(t=c.CRH())&&(e.content=t.first),c.iGM(t=c.CRH())&&(e.items=t),c.iGM(t=c.CRH())&&(e.lastSlide=t)}},decls:7,vars:6,consts:[["color","primary",4,"ngIf"],["color","danger",4,"ngIf"],[3,"scrollEvents","ionScrollStart","ionScroll","ionScrollEnd"],["scrollable","",3,"value","ngModel","ionChange","ngModelChange",4,"ngIf"],[4,"ngIf"],["color","primary"],["slot","start"],["autoHide","false"],["fill","outline","class","link",3,"click",4,"ngIf"],["fill","outline",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],[1,"ion-justify-content-start","ion-align-items-center"],["size","4"],[1,"ion-text-center","ion-text-uppercase"],["id","notification-button","fill","clear",3,"disabled","click"],["color","dark","slot","end","name","cart"],["id","notifications-badge","color","danger"],["offset","1","size","3"],[1,"ion-text-end","ion-text-uppercase","ion-text-nowrap"],[1,"namesuser"],["color","dark","slot","end","name","contact",1,"logouser"],["fill","outline",1,"link",3,"click"],["fill","outline",3,"click"],[3,"click"],["name","notifications-outline"],["color","danger"],[1,""],["size","3"],["class","ion-text-start ion-text-uppercase ion-text-nowrap main",3,"click",4,"ngIf"],[1,"ion-text-start","ion-text-uppercase","ion-text-nowrap"],["fill","outline","size","small","color","light",1,"btncart",3,"disabled","click"],["color","dark",3,"click"],[1,"ion-text-start","ion-text-uppercase","ion-text-nowrap","main",3,"click"],[1,"btnshop"],["scrollable","",3,"value","ngModel","ionChange","ngModelChange"],["class","btnseg","style","text-align: center",3,"value",4,"ngFor","ngForOf"],[1,"btnseg",2,"text-align","center",3,"value"],[2,"display","none",3,"spinner"],["showCancelButton","focus","type","text","debounce","500",3,"ionChange"],["size","4","class","ion-no-padding","sizeLg","3","sizeMd","4","sizeSm","6","sizeXs","6",4,"ngFor","ngForOf"],["size","4","sizeLg","3","sizeMd","4","sizeSm","6","sizeXs","6",1,"ion-no-padding"],[1,"cardimage"],[1,"colstyle"],["class","badge",4,"ngIf"],[1,"img-container"],[3,"src","spinner","isLoad"],[1,"divname",2,"text-align","center"],["size","5","class","ion-no-padding",4,"ngIf"],[1,"badge"],["slot","end","class","bG",3,"click",4,"ngIf"],["slot","end","class","bNG",3,"click",4,"ngIf"],["slot","end",1,"bG",3,"click"],["slot","end",1,"bNG",3,"click"],["size","5",1,"ion-no-padding"],[1,"ion-text-start"],["color","primary","size","small","fill","clear",3,"click",4,"ngIf"],["color","primary","size","small","fill","clear",3,"click"],[1,"ion-text-end"],["color","danger","size","small","fill","clear",3,"click",4,"ngIf"],["color","danger","size","small","fill","clear",3,"click"],[4,"ngFor","ngForOf"],["slot","end","fill","outline","size","small",3,"click"],["itemlist",""],["fill","outline","size","small",3,"click"],["size","12",1,"ion-text-start","ion-text-uppercase"],[1,"groupname"],["size","4","sizeLg","3","sizeMd","4","sizeSm","6","sizeXs","6",4,"ngFor","ngForOf"],["size","4","sizeLg","3","sizeMd","4","sizeSm","6","sizeXs","6"],[1,"badge2"],["slot","end","color","warning",3,"click",4,"ngIf"],[1,"img-container",3,"click"],[2,"width","100%",3,"src","spinner","isLoad"],["size","12",1,"colp"],[1,"ion-text-nowrap"],["slot","end","color","warning",3,"click"],[1,"row-header"],["size-sm","3","size-md","3","size-xm","3","size-lg","3",1,"ion-align-self-center"],[1,"ion-text-center","ion-text-uppercase","taille"],["size-sm","1","size-md","1","size-xm","1","size-lg","1",1,"ion-align-self-center"],["size-sm","5","size-md","5","size-xm","5","size-lg","5",1,"ion-align-self-center"],[1,"ion-text-right","ion-text-uppercase","taille"],[3,"click",4,"ngFor","ngForOf"],[2,"text-transform","uppercase","width","100%","font-weight","bold","text-align","center","padding","5px"],[2,"background-color","var(--ion-color-dark)","display","inline-block","width","50%","padding","5px","color","var(--ion-color-light)","font-size","10px","font-weight","bold"],["color","primary",3,"ngStyle",4,"ngFor","ngForOf"],["color","primary",3,"ngStyle"],["color","secondary",2,"font-size","9px"],["size","small","fill","clear",3,"click",4,"ngIf"],["style","display: flex; justify-content: space-between",4,"ngIf"],["size","small","fill","clear",3,"click"],["color","dark","slot","end","name","add-circle-outline"],[2,"display","flex","justify-content","space-between"],["size","small","fill","outline",3,"click"],[2,"text-transform","uppercase","width","100%","font-weight","bold"],[1,"cardimage",3,"ngClass"],[1,"ion-text-nowrap",2,"font-weight","bold","font-size","12px"],[3,"src","spinner","isLoad",4,"ngIf"],["size","6"],[1,"container","footer2"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.YNc(1,ut,19,6,"ion-toolbar",0),c.YNc(2,pt,18,5,"ion-toolbar",1),c.qZA(),c.TgZ(3,"ion-content",2),c.NdJ("ionScrollStart",function(){return e.logScrollStart()})("ionScroll",function(t){return e.logScrolling(t)})("ionScrollEnd",function(){return e.logScrollEnd()}),c.YNc(4,mt,2,3,"ion-segment",3),c.YNc(5,xe,7,6,"div",4),c.qZA(),c.YNc(6,qe,12,10,"ion-footer",4)),2&t&&(c.xp6(1),c.Q6J("ngIf",!e.flagAdd),c.xp6(1),c.Q6J("ngIf",e.flagAdd),c.xp6(1),c.Q6J("scrollEvents",!0),c.xp6(1),c.Q6J("ngIf",e.storeTypeTab&&e.storeTypeTab.length>1),c.xp6(1),c.Q6J("ngIf",e.showMe),c.xp6(1),c.Q6J("ngIf",e.totalItems))},directives:[n.Gu,o.O5,n.W2,n.sr,n.Sm,n.fG,n.Nd,n.wI,n.YG,n.gu,n.yp,n.cJ,n.QI,s.JJ,s.On,o.sg,n.GO,et.Q,n.jY,n.VI,n.j9,n.PM,it.a,n.FN,n.Ie,n.q_,n.Q$,n.yW,o.PC,o.mk,n.fr],pipes:[X.X$,o.H9],styles:[".lesbtn2[_ngcontent-%COMP%]{font-size:50%;text-transform:uppercase}.shopbtn[_ngcontent-%COMP%]{position:relative;left:8px}.col[_ngcontent-%COMP%]{align-items:center;background-color:aqua}.Btnitempack[_ngcontent-%COMP%], .col[_ngcontent-%COMP%]{text-align:center}ion-list[_ngcontent-%COMP%] > .productname[_ngcontent-%COMP%]{text-transform:uppercase;font-weight:700}.title[_ngcontent-%COMP%]{font-size:7px}.spane[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{font-weight:700}.spane[_ngcontent-%COMP%]{font-size:8px;position:absolute;bottom:70%;background-color:#151615;color:#fff}ion-card[_ngcontent-%COMP%]{box-shadow:none!important}ion-segment[_ngcontent-%COMP%]{padding:0;margin:0}ion-segment-button[_ngcontent-%COMP%]{padding:0;margin:0;font-size:10px}.footer[_ngcontent-%COMP%]{background-color:#fff;padding:8%;position:relative}.footer2[_ngcontent-%COMP%]{background-color:#08d46e;padding:3%;text-align:center}ion-card-content[_ngcontent-%COMP%]{background-color:#f1f1f1;color:#000;padding:1%;text-align:center}.colp[_ngcontent-%COMP%]{font-size:8px;text-transform:uppercase;padding:0}.colp[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-bottom:0px;--padding-end:2px;--padding-start:2px;--padding-top:0px;font-size:10px}.badge[_ngcontent-%COMP%]{width:100%;font-size:12px}.badge[_ngcontent-%COMP%], .badge2[_ngcontent-%COMP%]{position:absolute;top:7%;display:flex;justify-content:space-between}.badge2[_ngcontent-%COMP%]{width:25%;font-size:13px}.badgeResto[_ngcontent-%COMP%]{width:25%;position:absolute;top:7%;display:flex;padding:5%}.small[_ngcontent-%COMP%]{position:absolute;top:40%;width:100%;text-align:center;text-transform:uppercase;z-index:2}.alert-product[_ngcontent-%COMP%]{background-color:red;opacity:.5}.bNG[_ngcontent-%COMP%]{color:#fc4563}.bG[_ngcontent-%COMP%], .bNG[_ngcontent-%COMP%]{background-color:#f1f1f1}.bG[_ngcontent-%COMP%]{color:#3d3df8}.cardimage[_ngcontent-%COMP%]{text-align:center}.img-container[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;width:100%;height:100%}.divname[_ngcontent-%COMP%]{background-color:#3a3a3a;color:#fff;text-transform:uppercase;font-size:12px;font-weight:700}.colstyle[_ngcontent-%COMP%]{border-radius:5%;border:1px solid #f1f1f1}.namesuser[_ngcontent-%COMP%]{font-size:14px}.logouser[_ngcontent-%COMP%]{font-size:15px}.footer2[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-weight:700;font-size:20px;padding:5px}.icone[_ngcontent-%COMP%]{font-size:20px}.totalItems[_ngcontent-%COMP%]{font-size:15px}@media (max-width:480px){.btncart[_ngcontent-%COMP%], .btnshop[_ngcontent-%COMP%]{font-size:10px}}.biereBackground[_ngcontent-%COMP%], .jusBackground[_ngcontent-%COMP%]{border:1px solid #000;margin-bottom:50px}.platActif[_ngcontent-%COMP%]{color:#fff}.platActif[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{background-color:#f7f74c}.eauBackground[_ngcontent-%COMP%], .vinBackground[_ngcontent-%COMP%]{border:1px solid #000;margin-bottom:50px}.blockProd[_ngcontent-%COMP%]{margin-bottom:20px;margin-right:10px;margin-left:5px;box-shadow:5px 10px 8px #888;border-radius:15px}.groupname[_ngcontent-%COMP%]{font-weight:700;color:#000;border-bottom:1px solid #000}.row-header[_ngcontent-%COMP%]{background-color:var(--dark);color:#fff}#notification-button[_ngcontent-%COMP%]{position:relative;top:1px;right:1px;overflow:visible!important}#notifications-badge[_ngcontent-%COMP%]{background-color:red;position:absolute;top:-5px;right:-3px;border-radius:100%}.divslide[_ngcontent-%COMP%]{display:flex;justify-content:space-between}ion-segment[_ngcontent-%COMP%]{position:sticky;top:0;padding-top:5px;padding-bottom:5px;background:#f1f1f1;z-index:2}.masque[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;opacity:.5}"]}),t})();var Ce=i(9547);const Pe=[{path:"",component:Ie}];let Le=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.ez,s.u5,n.Pc,r.Bz.forChild(Pe),X.aw.forChild(),Ce.G]]}),t})()}}]);