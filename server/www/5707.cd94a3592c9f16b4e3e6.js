(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[5707],{5707:(t,e,s)=>{"use strict";s.r(e),s.d(e,{AdminDisplayCollectionsPageModule:()=>f});var i=s(1511),o=s(6073),n=s(8158),c=s(8777),r=s(4762),l=s(1572),a=s(5946),u=s(2874),d=s(4375);function h(t,e){if(1&t&&(l.TgZ(0,"option",13),l._uU(1),l.qZA()),2&t){const t=e.$implicit;l.s9C("value",t._id),l.xp6(1),l.hij(" ",t.company," ")}}function m(t,e){if(1&t&&(l.TgZ(0,"option",13),l._uU(1),l.qZA()),2&t){const t=e.$implicit;l.s9C("value",t.id),l.xp6(1),l.hij(" ",t.name," ")}}function g(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"ion-row"),l.TgZ(1,"ion-col",4),l.TgZ(2,"div",5),l.TgZ(3,"h4",7),l._uU(4),l.qZA(),l.qZA(),l.qZA(),l.TgZ(5,"ion-col",4),l.TgZ(6,"div",5),l.TgZ(7,"select",8),l.NdJ("change",function(e){return l.CHM(t),l.oxw().setSelected(e.target)}),l.TgZ(8,"option",9),l._uU(9,"--Please choose an option--"),l.qZA(),l.YNc(10,h,2,2,"option",10),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"ion-col",4),l.TgZ(12,"div",5),l.TgZ(13,"select",8),l.NdJ("change",function(e){return l.CHM(t),l.oxw().selectStore(e.target)}),l.TgZ(14,"option",9),l._uU(15,"--Please choose store--"),l.qZA(),l.YNc(16,m,2,2,"option",10),l.qZA(),l.qZA(),l.qZA(),l.TgZ(17,"ion-col",4),l.TgZ(18,"div",5),l.TgZ(19,"ion-button",11),l.NdJ("click",function(){l.CHM(t);const s=e.$implicit;return l.oxw().getCollectionDocuments(s)}),l._uU(20,"DROP "),l._UZ(21,"ion-icon",12),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&t){const t=e.$implicit,s=l.oxw();l.xp6(4),l.Oqu(t.name),l.xp6(6),l.Q6J("ngForOf",s.custumers),l.xp6(6),l.Q6J("ngForOf",s.storeList)}}const p=[{path:"",component:(()=>{class t{constructor(t,e,s,i,o){this.adminService=t,this.notificationService=e,this.alertController=s,this.saveRandom=i,this.notifi=o,this.custumers=[],this.custumersConnect=[],this.storeList=[],this.storeId=""}ngOnInit(){this.dbName=this.saveRandom.getDbName(),this.collections=this.saveRandom.getCollectionList(),this.getCustomers()}dropCollection(t){return(0,r.mG)(this,void 0,void 0,function*(){console.log(t);const e=yield this.alertController.create({cssClass:"closeCash",message:`Drop collection ${t.name} ?`,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:()=>{this.notificationService.presentLoading(),this.adminService.customersDropDbCollection(this.dbName,t.name).subscribe(e=>{this.collections=this.collections.filter(e=>e.name!==t.name),this.notificationService.dismissLoading(),this.notificationService.presentToast(`${t.name} drop succesfull!`,"success")},t=>{this.notificationService.dismissLoading(),this.notificationService.presentToast(`${t}`,"tertiary")})}}]});yield e.present()})}getCollectionDocuments(t){console.log(t),this.company||this.storeId?this.notifi.presentAlertConfirm("reset data ?","Yes","No").then(e=>{this.notifi.presentLoading(),this.company.storeId=this.storeId,this.company.adminId=this.company._id,this.adminService.deleteDocsDbCollection(this.dbName,t.name,this.company).subscribe(t=>{console.log(t),this.custumers=JSON.parse(localStorage.getItem("customers")),this.storeId=null,this.storeList=[],setTimeout(()=>{},2e3),this.notifi.dismissLoading(),this.notifi.presentToast("succesfully!","success")},t=>{this.company=null,this.storeId=null,this.notificationService.dismissLoading(),this.notificationService.presentToast(`${t}`,"tertiary")})}):this.notifi.presentAlert("please select customer and store")}getCustomers(){this.adminService.getUser().subscribe(t=>{console.log(t),this.custumers=[],this.custumers=t.users,this.custumersConnect=t.users,localStorage.setItem("customers",JSON.stringify(this.custumers))})}selectCustomer(t){console.log(t);let e=t.detail.value;this.storeList=[],console.log(this.custumers),console.log(this.storeList);let s=this.custumers.findIndex(t=>t._id==e);s>=0&&(this.index=s,console.log(s),this.company=this.custumers[s],this.storeList=this.company.storeId,console.log(this.custumers[s]))}selectStore(t){let e=Array.apply(null,t.options).filter(t=>t.selected).map(t=>t.value);this.storeId=e[0]}setSelected(t){let e=Array.apply(null,t.options).filter(t=>t.selected).map(t=>t.value);console.log(e);let s=e[0],i=this.custumers.findIndex(t=>t._id==s);if(i>=0){this.index=i,this.company=this.custumers[i],this.storeList=this.company.storeId;let t=this.custumers.findIndex(t=>t._id==s);i>=0&&(this.index=t,this.company=this.custumers[t],this.storeList=this.company.storeId)}}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(a.l),l.Y36(u.g),l.Y36(n.Br),l.Y36(d.i),l.Y36(u.g))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-admin-display-collections"]],decls:22,vars:2,consts:[["color","primary"],["slot","start"],["defaultHref","/database"],[1,"header-main"],["size","3"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],[2,"font-size","14px"],["name","pets","id","pet-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["slot","end","fill","clear",3,"click"],["slot","end","name","trash"],[3,"value"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-buttons",1),l._UZ(3,"ion-back-button",2),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"ion-content"),l.TgZ(7,"ion-grid"),l.TgZ(8,"ion-row",3),l.TgZ(9,"ion-col",4),l.TgZ(10,"div",5),l._uU(11,"Name"),l.qZA(),l.qZA(),l.TgZ(12,"ion-col",4),l.TgZ(13,"div",5),l._uU(14,"Company Name"),l.qZA(),l.qZA(),l.TgZ(15,"ion-col",4),l.TgZ(16,"div",5),l._uU(17,"Store Name"),l.qZA(),l.qZA(),l.TgZ(18,"ion-col",4),l.TgZ(19,"div",5),l._uU(20,"Action"),l.qZA(),l.qZA(),l.qZA(),l.YNc(21,g,22,3,"ion-row",6),l.qZA(),l.qZA()),2&t&&(l.xp6(5),l.hij("",e.dbName," collections list"),l.xp6(16),l.Q6J("ngForOf",e.collections))},directives:[n.Gu,n.sr,n.Sm,n.oU,n.cs,n.wd,n.W2,n.jY,n.Nd,n.wI,i.sg,o.YN,o.$B,n.YG,n.gu],styles:[""]}),t})()}];let Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[c.Bz.forChild(p)],c.Bz]}),t})(),f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.ez,o.u5,n.Pc,Z]]}),t})()}}]);