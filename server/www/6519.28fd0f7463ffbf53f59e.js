(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[6519],{6519:(t,e,o)=>{"use strict";o.r(e),o.d(e,{ProductManufacturedPageModule:()=>x});var i=o(1511),n=o(6073),s=o(8777),r=o(8158),c=o(4762),d=o(4831),l=o(691),a=o(373),u=o(9082),p=o(1344),h=o.n(p),g=o(1572),m=o(4144),f=o(1044),v=o(2968),Z=o(1064);function b(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",2),g.NdJ("click",function(){return g.CHM(t),g.oxw().selectSource()}),g._UZ(1,"ion-icon",8),g.qZA()}}function A(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",15),g.NdJ("click",function(){g.CHM(t);const e=g.oxw().$implicit,o=g.oxw(2).index;return g.oxw().productRestoUpdate(e,o)}),g._uU(1),g.ALo(2,"translate"),g.qZA()}2&t&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"MENU.update")))}function k(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",16),g.NdJ("click",function(){g.CHM(t);const e=g.oxw().$implicit;return g.oxw(3).deleteProduct(e)}),g._UZ(1,"ion-icon",17),g.qZA()}}function y(t,e){if(1&t&&(g.TgZ(0,"ion-item"),g.TgZ(1,"ion-avatar",4),g._UZ(2,"ion-img",12),g.qZA(),g.TgZ(3,"ion-label"),g.TgZ(4,"p"),g._uU(5),g.qZA(),g.TgZ(6,"p"),g._uU(7),g.qZA(),g.TgZ(8,"p"),g._uU(9),g.qZA(),g.qZA(),g.YNc(10,A,3,3,"ion-button",13),g.YNc(11,k,2,0,"ion-button",14),g.qZA()),2&t){const t=e.$implicit,o=g.oxw(3);g.xp6(2),g.Q6J("src",t.url),g.xp6(3),g.Oqu(t.name),g.xp6(2),g.Oqu(t.sellingPrice),g.xp6(2),g.Oqu(t.quantity),g.xp6(1),g.Q6J("ngIf",o.admin),g.xp6(1),g.Q6J("ngIf",o.admin)}}function P(t,e){if(1&t&&(g.TgZ(0,"ion-list"),g.YNc(1,y,12,6,"ion-item",7),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Q6J("ngForOf",t)}}function S(t,e){if(1&t&&(g.TgZ(0,"ion-slide"),g.TgZ(1,"ion-grid"),g.TgZ(2,"ion-row"),g.TgZ(3,"ion-col"),g.TgZ(4,"div",9),g.TgZ(5,"h4"),g._uU(6),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(7,"div",10),g.YNc(8,P,2,1,"ion-list",11),g.qZA(),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(6),g.Oqu(t.storeName?t.storeName:"no name"),g.xp6(2),g.Q6J("ngIf",t)}}const q=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,s,r,c,d){this.restApiService=t,this.modalController=e,this.toastController=o,this.loadingController=i,this.actionSheetController=n,this.alertController=s,this.rangeByStoreService=r,this.urlService=c,this.router=d,this.products=[],this.productsPick=[],this.tabRoles=[],this.admin=!1,this.takeUrl(),this.tabRoles=JSON.parse(localStorage.getItem("roles")),(this.tabRoles.includes(1)||this.tabRoles.includes(2))&&this.takeProduct(),this.tabRoles.includes(1)&&(this.admin=!0)}ngOnInit(){}takeUrl(){console.log("uri add waiting..."),this.urlService.getUrl().subscribe(t=>{this.url=t,console.log("uri add",t),this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId)})}webServerSocket(t){this.sockets=h()(this.url),this.sockets.on(`${t}manufactured`,t=>(0,c.mG)(this,void 0,void 0,function*(){console.log(t),this.takeProductAfter()}))}takeProduct(){let t=[];this.presentLoading(),this.restApiService.getProductListResto().subscribe(e=>(0,c.mG)(this,void 0,void 0,function*(){console.log(e),this.dismissLoading().then(t=>{}).catch(t=>{}),e&&(this.products=[],t=e,this.productsPick=e,t.length&&(t.forEach(t=>{t.desabled?console.log("non"):this.products.push(t)}),this.multiStoreProduct=yield this.rangeByStoreService.rangeProductByStore(this.products),console.log(this.multiStoreProduct)))}))}takeProductAfter(){let t=[];this.restApiService.getProductListResto().subscribe(e=>(0,c.mG)(this,void 0,void 0,function*(){e&&(this.products=[],t=e,this.productsPick=e,t.length&&(t.forEach(t=>{t.desabled?console.log("non"):this.products.push(t)}),this.multiStoreProduct=yield this.rangeByStoreService.rangeProductByStore(this.products)))}))}productRestoAddFromMaeri(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:d.t,componentProps:{tabproducts:{products:this.productsPick,flag:"product_add_resto"}}});return t.onDidDismiss().then(t=>{this.takeProductAfter()}),yield t.present()})}productRestoAddFromUser(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:u.g,backdropDismiss:!1,componentProps:{tabproducts:{products:this.productsPick,page:"product-manufactured"}}});return t.onDidDismiss().then(t=>{}),yield t.present()})}productRestoUpdate(t,e){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:a.v,backdropDismiss:!1,componentProps:{product:t,page:"product-manufactured"}});return e.onDidDismiss().then(t=>{console.log(t),"update"===t.data&&(this.presentToast("product update"),this.takeProduct())}),yield e.present()})}deleteProduct(t){console.log(t),this.presentLoading(),this.restApiService.deleteProductResto(t._id).subscribe(t=>{this.dismissLoading(),this.presentToast("product delete"),console.log(t),this.takeProduct()})}displayDetails(t){return(0,c.mG)(this,void 0,void 0,function*(){this.presentLoading(),this.restApiService.getOneManufacturedProductItemResto(t._id).subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){this.dismissLoading();const e=yield this.modalController.create({component:l.v,componentProps:{product:t.docs[0]}});return e.onDidDismiss().then(t=>{console.log(t),console.log(t.data),"erico"===t.data?console.log("hello"):this.presentAlert(t)}),yield e.present()}))})}presentLoading(){return(0,c.mG)(this,void 0,void 0,function*(){return this.isLoading=!0,yield this.loadingController.create({duration:6e3}).then(t=>{t.present().then(()=>{this.isLoading||t.dismiss().then(()=>console.log("abort presenting"))})})})}dismissLoading(){return(0,c.mG)(this,void 0,void 0,function*(){return this.isLoading=!1,yield this.loadingController.dismiss().then(()=>console.log("dismissed"))})}presentToast(t){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:t,duration:2e3,position:"top",animated:!0,color:"success"})).present()})}presentError(t){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:t,duration:5e3,position:"top",animated:!0,cssClass:"my-custom-class2"})).present()})}presentActionSheet(t){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.actionSheetController.create({header:"Albums",buttons:[{text:"Update",icon:"add",handler:()=>{}},{text:"View Details",icon:"heart",handler:()=>{console.log("Favorite clicked"),this.displayDetails(t)}},{text:"Delete",role:"destructive",icon:"trash",handler:()=>{this.deleteProduct(t)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield e.present()})}presentAlert(t){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"ELPIS",subHeader:"sauvegarde ok",buttons:["OK"]});yield t.present()})}selectSource(){return(0,c.mG)(this,void 0,void 0,function*(){this.productRestoAddFromUser()})}addCategorie(){this.router.navigateByUrl("/category?page=product-manufactured")}addResource(){this.router.navigateByUrl("/resource?page=product-manufactured")}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(m.e),g.Y36(r.IN),g.Y36(r.yF),g.Y36(r.HT),g.Y36(r.BX),g.Y36(r.Br),g.Y36(f.n),g.Y36(v.i),g.Y36(s.F0))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-product-manufactured"]],decls:15,vars:8,consts:[["color","primary"],["slot","end"],[3,"click"],[3,"click",4,"ngIf"],["slot","start"],["autoHide","false"],["pager","true"],[4,"ngFor","ngForOf"],["slot","icon-only","name","add"],[1,"ion-text-center","ion-text-uppercase"],[1,"nodejs"],[4,"ngIf"],[3,"src"],["class","divBtnUpdate",3,"click",4,"ngIf"],["class","divBtnDelete","color","danger",3,"click",4,"ngIf"],[1,"divBtnUpdate",3,"click"],["color","danger",1,"divBtnDelete",3,"click"],["slot","icon-only","name","trash"]],template:function(t,e){1&t&&(g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar",0),g.TgZ(2,"ion-buttons",1),g.TgZ(3,"ion-button",2),g.NdJ("click",function(){return e.addCategorie()}),g._uU(4),g.ALo(5,"translate"),g.qZA(),g.TgZ(6,"ion-button",2),g.NdJ("click",function(){return e.addResource()}),g._uU(7),g.ALo(8,"translate"),g.qZA(),g.YNc(9,b,2,0,"ion-button",3),g.qZA(),g.TgZ(10,"ion-buttons",4),g._UZ(11,"ion-menu-button",5),g.qZA(),g.qZA(),g.qZA(),g.TgZ(12,"ion-content"),g.TgZ(13,"ion-slides",6),g.YNc(14,S,9,2,"ion-slide",7),g.qZA(),g.qZA()),2&t&&(g.xp6(4),g.Oqu(g.lcZ(5,4,"MENU.addcategorie")),g.xp6(3),g.hij(" ",g.lcZ(8,6,"MENU.addresources"),""),g.xp6(2),g.Q6J("ngIf",e.admin),g.xp6(5),g.Q6J("ngForOf",e.multiStoreProduct))},directives:[r.Gu,r.sr,r.Sm,r.YG,i.O5,r.fG,r.W2,r.Hr,i.sg,r.gu,r.A$,r.jY,r.Nd,r.wI,r.q_,r.Ie,r.BJ,r.Xz,r.Q$],pipes:[Z.X$],styles:[".round[_ngcontent-%COMP%]{--width:5px;--height:5px;--vertical-align:middle;margin:2px;font-size:10px}"]}),t})()}];let x=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[i.ez,n.u5,r.Pc,s.Bz.forChild(q),Z.aw.forChild()]]}),t})()},1044:(t,e,o)=>{"use strict";o.d(e,{n:()=>r});var i=o(4762),n=o(1572),s=o(9719);let r=(()=>{class t{constructor(t){this.getStoreName=t}rangeProductByStore(t){return new Promise((e,o)=>{let n=t.reduce((t,e)=>(t[e.storeId]=[...t[e.storeId]||[],e],t),{}),s=[];for(const t in n)s.push(n[t]);s.forEach(t=>(0,i.mG)(this,void 0,void 0,function*(){let e=yield this.getStoreName.takeName(t);t.storeName=e})),e(s)})}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(s.$))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);