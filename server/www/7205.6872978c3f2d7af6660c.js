(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[7205],{1044:(t,e,n)=>{"use strict";n.d(e,{n:()=>r});var i=n(4762),o=n(1572),s=n(9719);let r=(()=>{class t{constructor(t){this.getStoreName=t}rangeProductByStore(t){return new Promise((e,n)=>{let o=t.reduce((t,e)=>(t[e.storeId]=[...t[e.storeId]||[],e],t),{}),s=[];for(const t in o)s.push(o[t]);s.forEach(t=>(0,i.mG)(this,void 0,void 0,function*(){let e=yield this.getStoreName.takeName(t);t.storeName=e})),e(s)})}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(s.$))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},7205:(t,e,n)=>{"use strict";n.r(e),n.d(e,{SuperManagerPageModule:()=>L});var i=n(1511),o=n(6073),s=n(8158),r=n(8777),a=n(4762),c=n(5959),d=n(5416),g=n(1572),l=n(2874),u=n(4375),h=n(9719),p=n(5946),m=n(529),y=n(9063),f=n(2968);let Z=(()=>{class t{constructor(t,e,n){this.http=t,this.urlService=e,this.admin=n,this.userName="unknown",this.url="http://192.168.100.10:3000/",this.takeUrl()}takeUrl(){m.N.production?this.urlService.getUrl().subscribe(t=>{this.url=t}):this.url=m.V}getOpenCash(t){let e=localStorage.getItem("adminId");return this.http.get(this.url+`cashOpen/${e}?db=${e}&storeId=${t}`)}}return t.\u0275fac=function(e){return new(e||t)(g.LFG(y.eN),g.LFG(f.i),g.LFG(p.l))},t.\u0275prov=g.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=n(4144),q=n(1044),v=n(5541),T=n(731),O=n(6365),S=n(2181),A=n(1064);function w(t,e){1&t&&(g.TgZ(0,"div",13),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&t&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"MENU.isopen")," "))}function I(t,e){1&t&&(g.TgZ(0,"div",14),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&t&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"MENU.isclose")," "))}const x=function(t){return{"background-color":t}};function C(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-row",8),g.TgZ(1,"ion-col",4),g.TgZ(2,"div",9),g.TgZ(3,"button",10),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).goToWarehouse()}),g._uU(4),g.qZA(),g.qZA(),g.qZA(),g.TgZ(5,"ion-col",4),g.YNc(6,w,3,3,"div",11),g.YNc(7,I,3,3,"div",12),g.qZA(),g.TgZ(8,"ion-col",4),g.TgZ(9,"div",5),g.TgZ(10,"button",10),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).goToRefueling()}),g._uU(11),g.qZA(),g.qZA(),g.qZA(),g.TgZ(12,"ion-col",4),g.TgZ(13,"div",5),g._uU(14),g.qZA(),g.qZA(),g.TgZ(15,"ion-col",4),g.TgZ(16,"div",5),g._uU(17),g.qZA(),g.qZA(),g.TgZ(18,"ion-col",4),g.TgZ(19,"div",5),g._uU(20),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.Q6J("ngStyle",g.VKq(8,x,"white")),g.xp6(4),g.hij(" ",t.store.name," "),g.xp6(2),g.Q6J("ngIf",t.openCash.open),g.xp6(1),g.Q6J("ngIf",!t.openCash.open),g.xp6(4),g.hij(" ",t.newquantity?t.newquantity:"0"," "),g.xp6(3),g.hij(" ",t.quantityItems?t.quantityItems:"0"," "),g.xp6(3),g.hij(" ",t.quantityStore?t.quantityStore:"0"," "),g.xp6(3),g.hij(" ",t.quantityStore+t.quantityItems?t.quantityStore+t.quantityItems:"0"," ")}}function _(t,e){if(1&t&&(g.TgZ(0,"ion-grid"),g.TgZ(1,"ion-row",3),g.TgZ(2,"ion-col",4),g.TgZ(3,"div",5),g._uU(4),g.ALo(5,"translate"),g.qZA(),g.qZA(),g.TgZ(6,"ion-col",4),g.TgZ(7,"div",5),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.qZA(),g.TgZ(10,"ion-col",4),g.TgZ(11,"div",5),g._uU(12),g.ALo(13,"translate"),g.qZA(),g.qZA(),g.TgZ(14,"ion-col",4),g.TgZ(15,"div",5),g._uU(16),g.ALo(17,"translate"),g.qZA(),g.qZA(),g.TgZ(18,"ion-col",4),g.TgZ(19,"div",5),g._uU(20),g.ALo(21,"translate"),g.qZA(),g.qZA(),g.TgZ(22,"ion-col",4),g.TgZ(23,"div",5),g._uU(24,"TOTAL"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(25,"ion-row"),g._UZ(26,"ion-col",6),g.qZA(),g.YNc(27,C,21,10,"ion-row",7),g.qZA()),2&t){const t=g.oxw();g.xp6(4),g.Oqu(g.lcZ(5,6,"MENU.store")),g.xp6(4),g.Oqu(g.lcZ(9,8,"MENU.status")),g.xp6(4),g.Oqu(g.lcZ(13,10,"MENU.waiting")),g.xp6(4),g.Oqu(g.lcZ(17,12,"MENU.wharehouse")),g.xp6(4),g.Oqu(g.lcZ(21,14,"MENU.onsale")),g.xp6(7),g.Q6J("ngForOf",t.arr)}}const M=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,s,r,a,d,g,l,u,h){this.router=t,this.notifi=e,this.saveRandom=n,this.getStoreName=i,this.adminService=o,this.superManagerService=s,this.restApiService=r,this.rangeByStoreService=a,this.menu=d,this.events=g,this.translateConfigService=l,this.refueling=u,this.authService=h,this.storeList=[],this.destroy$=new c.xQ,this.storeTypeTab=[],this.totalProd=0,this.randomObj={},this.arr=[],this.totalRefueling=0,this.EmployesList=[]}ngOnInit(){this.takeEmployees()}ionViewWillLeave(){this.destroy$.next(),this.destroy$.complete()}init(){this.storeList.forEach(t=>{this.randomObj[t.id]={store:t}})}languageChanged(){let t=localStorage.getItem("language");t&&this.translateConfigService.setLanguage(t)}ionViewDidEnter(){this.randomObj={},this.arr=[],this.getSetting(),this.menu.enable(!0,"first"),this.storeList=this.saveRandom.getStoreList(),this.storeList.forEach(t=>{this.randomObj[t.id]={store:t}}),this.admin=this.saveRandom.getAdminAccount(),this.setting=this.saveRandom.getSetting(),this.storeTypeTab=this.admin.storeType,this.init(),this.getOpenCash(),this.saveRandom.setSuperManager()}getOpenCash(){this.storeList.forEach(t=>{this.superManagerService.getOpenCash(t.id).pipe((0,d.R)(this.destroy$)).subscribe(e=>{console.log("cash open",e),this.randomObj[t.id].openCash=e.docs.length?e.docs[0]:{open:!1},this.randomObj[t.id].storeId=t.id})}),this.getRefueling()}getAllProducts(){this.storeTypeTab.includes("bar"),(this.storeTypeTab.includes("services")||this.storeTypeTab.includes("produits"))&&setTimeout(()=>{this.takeProductServiceList()},1e3),this.storeTypeTab.includes("shop")&&setTimeout(()=>{},1500),this.storeTypeTab.includes("resto")&&this.storeTypeTab.includes("bar")&&setTimeout(()=>{},3e3)}takeProductServiceList(){this.notifi.presentLoading(),this.restApiService.getBillardList().subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){console.log("les produits",t.product),t.product.forEach(t=>{this.totalProd=this.totalProd+t.quantityStore+t.quantityItems,this.randomObj[t.storeId].quantity=this.randomObj[t.storeId]&&this.randomObj[t.storeId].quantity>0?this.randomObj[t.storeId].quantity+t.quantityStore+t.quantityItems:t.quantityStore+t.quantityItems,this.randomObj[t.storeId].quantityStore=this.randomObj[t.storeId]&&this.randomObj[t.storeId].quantityStore>0?this.randomObj[t.storeId].quantityStore+t.quantityStore:t.quantityStore,this.randomObj[t.storeId].quantityItems=this.randomObj[t.storeId]&&this.randomObj[t.storeId].quantityItems>0?this.randomObj[t.storeId].quantityItems+t.quantityItems:t.quantityItems});for(const t in this.randomObj)this.arr.push(this.randomObj[t]);this.notifi.dismissLoading(),console.log("service",this.arr)}))}getSetting(){setTimeout(()=>{this.adminService.getCompanySetting().pipe((0,d.R)(this.destroy$)).subscribe(t=>{let e=t.company[0];t.company.length&&(e.name||localStorage.setItem("company","Maeri"),this.events.publishDisplayType(this.storeTypeTab),this.events.publishSetting(e),this.saveRandom.setSetting(e),localStorage.setItem("setting",JSON.stringify(e)))})},2e3)}getRefueling(){this.refueling.superManagerRefueling().subscribe(t=>{this.getAllProducts(),t.forEach(t=>{this.totalRefueling=t.newquantity,this.randomObj[t.storeId].newquantity=this.randomObj[t.storeId]&&this.randomObj[t.storeId].newquantity?this.randomObj[t.storeId].newquantity+t.newquantity:t.newquantity})})}goToWarehouse(){this.router.navigateByUrl("warehouse")}goToRefueling(){this.router.navigateByUrl("manager-refueling")}takeEmployees(){this.authService.getEmployees().subscribe(t=>{this.EmployesList=t.employes,this.EmployesList=this.EmployesList.sort((t,e)=>t.name>e.name?1:-1),this.saveRandom.setEmployeList(this.EmployesList)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(r.F0),g.Y36(l.g),g.Y36(u.i),g.Y36(h.$),g.Y36(p.l),g.Y36(Z),g.Y36(b.e),g.Y36(q.n),g.Y36(s._q),g.Y36(v.t),g.Y36(T.w),g.Y36(O.F),g.Y36(S.u))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-super-manager"]],decls:7,vars:1,consts:[["slot","start",1,"btnmenu"],["autoHide","false"],[4,"ngIf"],[1,"header-main"],["size","2"],[1,"ion-text-center"],["size","3"],["class","data-row data-update table-row",3,"ngStyle",4,"ngFor","ngForOf"],[1,"data-row","data-update","table-row",3,"ngStyle"],[1,"ion-text-center",2,"color","var(--ion-color-primary)","font-weight","bold"],[1,"link",3,"click"],["class","ion-text-center","style","color: var(--ion-color-success)",4,"ngIf"],["class","ion-text-center","style","color: var(--ion-color-danger)",4,"ngIf"],[1,"ion-text-center",2,"color","var(--ion-color-success)"],[1,"ion-text-center",2,"color","var(--ion-color-danger)"]],template:function(t,e){1&t&&(g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar"),g._UZ(2,"ion-title"),g.TgZ(3,"ion-buttons",0),g._UZ(4,"ion-menu-button",1),g.qZA(),g.qZA(),g.qZA(),g.TgZ(5,"ion-content"),g.YNc(6,_,28,16,"ion-grid",2),g.qZA()),2&t&&(g.xp6(6),g.Q6J("ngIf",e.storeList.length>1))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.fG,s.W2,i.O5,s.jY,s.Nd,s.wI,i.sg,i.PC],pipes:[A.X$],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#f1f1f1}.header-main[_ngcontent-%COMP%]{font-weight:500;padding-top:5px;padding-bottom:5px}.header-main[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-transform:uppercase;font-size:13px;color:#000}ion-grid[_ngcontent-%COMP%]{--ion-grid-padding:10px;--ion-grid-column-padding:5px;margin-left:25px;margin-right:25px}.table-row[_ngcontent-%COMP%]{margin-top:3px;margin-bottom:3px}.link[_ngcontent-%COMP%]{background-color:#fff;color:var(--ion-color-primary);border:none}.link[_ngcontent-%COMP%]:hover{background-color:var(--ion-color-warning);color:var(--ion-color-dark)}@media screen and (max-width:600px){ion-grid[_ngcontent-%COMP%]{--ion-grid-padding:5px;--ion-grid-column-padding:2px;margin-left:0;margin-right:0}.table-row[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}.header-main[_ngcontent-%COMP%]{font-weight:500;padding-top:1px;padding-bottom:1px}.header-main[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#000}.header-main[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-transform:uppercase;font-size:12px}.btnmenu[_ngcontent-%COMP%]{display:block}}@media screen and (min-width:700px){.btnmenu[_ngcontent-%COMP%]{display:none}}"]}),t})()}];let j=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[r.Bz.forChild(M)],r.Bz]}),t})();var P=n(9547);let L=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[i.ez,o.u5,s.Pc,j,A.aw.forChild(),P.G]]}),t})()}}]);