(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[347],{347:(e,i,t)=>{"use strict";t.d(i,{I:()=>T});var o=t(4762),n=t(529),s=t(7207),r=t(6073),a=t(1572),l=t(3575),c=t(4144),u=t(8158),g=t(5897),p=t(1611),d=t(2968),h=t(2426),m=t(2874),Z=t(1511),v=t(1064);const f=["form"];function q(e,i){if(1&e&&(a.TgZ(0,"ion-card"),a._UZ(1,"img",27),a.qZA()),2&e){const e=a.oxw();a.xp6(1),a.Q6J("src",e.url,a.LSH)}}function b(e,i){if(1&e&&(a.TgZ(0,"ion-select-option",28),a._uU(1),a.qZA()),2&e){const e=i.$implicit;a.s9C("value",e._id),a.xp6(1),a.Oqu(e.name)}}function A(e,i){if(1&e&&(a.TgZ(0,"ion-select-option",28),a._uU(1),a.qZA()),2&e){const e=i.$implicit;a.s9C("value",e.id),a.xp6(1),a.Oqu(e.name)}}function y(e,i){if(1&e){const e=a.EpF();a.TgZ(0,"ion-item"),a.TgZ(1,"ion-label"),a._uU(2),a.ALo(3,"translate"),a.qZA(),a.TgZ(4,"ion-select",29),a.NdJ("ionChange",function(i){return a.CHM(e),a.oxw().assignStore(i)}),a.YNc(5,A,2,2,"ion-select-option",23),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(2),a.Oqu(a.lcZ(3,2,"MENU.store ")),a.xp6(3),a.Q6J("ngForOf",e.userStore)}}let T=(()=>{class e{constructor(e,i,t,o,n,s,r,a,l,c){if(this.madebyService=e,this.restApi=i,this.modalController=t,this.toastController=o,this.loadingController=n,this.catService=s,this.resourceService=r,this.urlService=a,this.createPack=l,this.notifi=c,this.tabRoles=[],this.admin=!1,this.userStore=[],this.superCategorie="",this.categorie="",this.tabRoles=JSON.parse(localStorage.getItem("roles")),this.tabRoles.includes(1)){this.getCategories(),this.getMade(),this.admin=!0;let e=JSON.parse(localStorage.getItem("user"));this.userStore=e[0].storeId,this.storeID=this.userStore[0].id,console.log(this.storeID)}}ngOnInit(){}takeUrl(){n.N.production?this.urlService.getUrl().subscribe(e=>{this.url=e}):this.url=n.V}getCategories(){this.catService.getCategories().subscribe(e=>{console.log(e),this.categorys=e.category.filter(e=>{if(e.page)return e.page==this.page}),this.getSupCategories()})}getSupCategories(){let e=JSON.parse(localStorage.getItem("user"));this.supcategories=e[0].storeType}getMade(){this.madebyService.getMarieMadeby().subscribe(e=>{console.log(e),this.mades=e.madeby})}test(e){console.log(e),console.log(e.target.value),this.productId=e.target.value,this.categorystab=this.categorys.filter(e=>e._id===this.productId)[0],console.log(this.categorystab)}test2(e){console.log(e),console.log(e.target.value),this.superCategorie=e.target.value,console.log(this.categorystabSup)}made(e){this.madeselect=this.mades.filter(i=>i._id===e.target.value)[0].name}readUrl(e){if(this.file=e.target.files[0],e.target.files&&e.target.files[0]){var i=new FileReader;i.onload=e=>{this.url=e.target.result},i.readAsDataURL(e.target.files[0])}}register(e){return(0,o.mG)(this,void 0,void 0,function*(){if(console.log(e.value),this.formulaire.invalid)return void this.notifi.presentFormError("formulaire invalide.!","danger");this.presentLoading();var i=new FormData;i.append("categoryId",this.categorystab._id),i.append("categoryName",this.categorystab.name),i.append("name",e.value.name),i.append("capacity",this.unitName),i.append("sellingPrice",e.value.sellingPrice),i.append("description",e.value.description),i.append("ristourne",e.value.ristourne),i.append("superCategory","bar"),i.append("packPrice",e.value.packPrice?e.value.packPrice:"0"),i.append("sellingPackPrice",e.value.sellingPackPrice?e.value.sellingPackPrice:"0"),i.append("packSize",e.value.packSize?e.value.packSize:"1"),i.append("storeId",this.storeID),this.resourceList&&i.append("resourceList",JSON.stringify(this.resourceList)),e.value.sizeUnit&&i.append("sizeUnit",e.value.sizeUnit),this.unitName&&i.append("unitName",this.unitName),e.value.purchasingPrice?yield i.append("purchasingPrice",e.value.purchasingPrice):yield i.append("purchasingPrice","0"),i.append("image",this.file);let t=localStorage.getItem("company");yield i.append("produceBy",t),this.restApi.addProduct(i,this.storeID).subscribe(e=>{console.log(e),this.dismissLoading(),this.presentToast(),this.modalController.dismiss()})})}takeMaeriProducts(){this.restApi.getMaeriProduct().subscribe(e=>{console.log(e)})}presentLoading(){return(0,o.mG)(this,void 0,void 0,function*(){return this.isLoading=!0,yield this.loadingController.create({duration:6e3}).then(e=>{e.present().then(()=>{this.isLoading||e.dismiss().then(()=>console.log("abort presenting"))})})})}dismissLoading(){return(0,o.mG)(this,void 0,void 0,function*(){return this.isLoading=!1,yield this.loadingController.dismiss().then(()=>console.log("dismissed"))})}presentToast(){return(0,o.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:"product have been save.",duration:2e3,position:"top",animated:!0,cssClass:"my-custom-class"})).present()})}unitMeasure(e){this.unitName=e.target.value}closeModal(){this.modalController.dismiss()}getResources(){this.resourceService.getResources().subscribe(e=>{console.log(e),this.resources=e.resources})}pickResource(){return(0,o.mG)(this,void 0,void 0,function*(){console.log("ok");const e=yield this.modalController.create({component:s.j,componentProps:{tabs:this.resourceList}});return e.onDidDismiss().then(e=>{console.log(e),e.data&&(this.resourceList=[...e.data],console.log(this.resourceList))}),yield e.present()})}assignStore(e){return(0,o.mG)(this,void 0,void 0,function*(){let i=e.target.value;console.log(i),this.storeID=i})}}return e.\u0275fac=function(i){return new(i||e)(a.Y36(l.J),a.Y36(c.e),a.Y36(u.IN),a.Y36(u.yF),a.Y36(u.HT),a.Y36(g.q),a.Y36(p.z),a.Y36(d.i),a.Y36(h.I),a.Y36(m.g))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-user-add-own-product"]],viewQuery:function(e,i){if(1&e&&a.Gf(f,1,r.F),2&e){let e;a.iGM(e=a.CRH())&&(i.formulaire=e.first)}},inputs:{page:"page"},decls:60,vars:16,consts:[["color","success"],["slot","end"],[3,"click"],["slot","icon-only","name","close"],[4,"ngIf"],[3,"ngSubmit"],["form","ngForm"],["color","primary"],["padding",""],["name","name","type","text","placeholder","Name","ngModel","","required",""],["position","floating"],["name","sizeUnit","type","number","placeholder","size","ngModel","","required",""],["interface","popover",3,"ionChange"],["value","g"],["value","kg"],["value","cl"],["value","l"],["name","purchasingPrice","type","number","placeholder","prix d'achat","ngModel","","required",""],["name","sellingPrice","type","number","placeholder","prix de vente","ngModel","","required",""],["name","packSize","type","number","placeholder","pack size","ngModel","","required",""],["name","packPrice","type","number","placeholder","pack price","ngModel","","required",""],["name","sellingPackPrice","type","number","placeholder","selling pack price","ngModel","","required",""],["color","warning","interface","popover",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["name","ristourne","type","number","placeholder","pack ristourne","ngModel",""],["name","image","type","file","ngModel","","required","",3,"change"],["color","danger","size","large","type","submit","expand","block",3,"disabled"],[3,"src"],[3,"value"],["cancelText","cancel","okText","Okay","interface","popover","color","warning",3,"ionChange"]],template:function(e,i){if(1&e){const e=a.EpF();a.TgZ(0,"ion-header"),a.TgZ(1,"ion-toolbar",0),a.TgZ(2,"ion-buttons",1),a.TgZ(3,"ion-button",2),a.NdJ("click",function(){return i.closeModal()}),a._UZ(4,"ion-icon",3),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(5,"ion-content"),a.YNc(6,q,2,1,"ion-card",4),a.TgZ(7,"form",5,6),a.NdJ("ngSubmit",function(){a.CHM(e);const t=a.MAs(8);return i.register(t)}),a.TgZ(9,"ion-grid"),a.TgZ(10,"ion-row",7),a.TgZ(11,"ion-col"),a.TgZ(12,"div",8),a.TgZ(13,"ion-item"),a._UZ(14,"ion-input",9),a.qZA(),a.TgZ(15,"ion-item"),a.TgZ(16,"ion-label",10),a._uU(17),a.ALo(18,"translate"),a.qZA(),a._UZ(19,"ion-input",11),a.qZA(),a.TgZ(20,"ion-item"),a.TgZ(21,"ion-label"),a._uU(22),a.ALo(23,"translate"),a.qZA(),a.TgZ(24,"ion-select",12),a.NdJ("ionChange",function(e){return i.unitMeasure(e)}),a.TgZ(25,"ion-select-option",13),a._uU(26,"g"),a.qZA(),a.TgZ(27,"ion-select-option",14),a._uU(28,"kg"),a.qZA(),a.TgZ(29,"ion-select-option",15),a._uU(30,"cl"),a.qZA(),a.TgZ(31,"ion-select-option",16),a._uU(32,"l"),a.qZA(),a.TgZ(33,"ion-select-option",16),a._uU(34,"piece"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(35,"ion-item"),a._UZ(36,"ion-input",17),a.qZA(),a.TgZ(37,"ion-item"),a._UZ(38,"ion-input",18),a.qZA(),a.TgZ(39,"ion-item"),a._UZ(40,"ion-input",19),a.qZA(),a.TgZ(41,"ion-item"),a._UZ(42,"ion-input",20),a.qZA(),a.TgZ(43,"ion-item"),a._UZ(44,"ion-input",21),a.qZA(),a.TgZ(45,"ion-item"),a.TgZ(46,"ion-label"),a._uU(47),a.ALo(48,"translate"),a.qZA(),a.TgZ(49,"ion-select",22),a.NdJ("ionChange",function(e){return i.test(e)}),a.YNc(50,b,2,2,"ion-select-option",23),a.qZA(),a.qZA(),a.TgZ(51,"ion-item"),a._UZ(52,"ion-input",24),a.qZA(),a.YNc(53,y,6,4,"ion-item",4),a.TgZ(54,"ion-item"),a.TgZ(55,"ion-input",25),a.NdJ("change",function(e){return i.readUrl(e)}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(56,"div",8),a.TgZ(57,"ion-button",26),a._uU(58),a.ALo(59,"translate"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()}2&e&&(a.xp6(6),a.Q6J("ngIf",i.url),a.xp6(11),a.Oqu(a.lcZ(18,8,"MENU.size")),a.xp6(5),a.Oqu(a.lcZ(23,10,"MENU.unit")),a.xp6(25),a.Oqu(a.lcZ(48,12,"MENU.category")),a.xp6(3),a.Q6J("ngForOf",i.categorys),a.xp6(3),a.Q6J("ngIf",i.userStore.length>1),a.xp6(4),a.Q6J("disabled",!i.unitName),a.xp6(1),a.Oqu(a.lcZ(59,14,"MENU.save")))},directives:[u.Gu,u.sr,u.Sm,u.YG,u.gu,u.W2,Z.O5,r.Y7,r.JL,r.F,u.jY,u.Nd,u.wI,u.Ie,u.pK,u.j9,r.JJ,r.On,r.Q7,u.Q$,u.as,u.t9,u.QI,u.n0,Z.sg,u.PM],pipes:[v.X$],styles:[""]}),e})()}}]);