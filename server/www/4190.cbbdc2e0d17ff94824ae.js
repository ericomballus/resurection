(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[4190],{4190:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ProductPackPageModule:()=>P});var n=i(1511),o=i(6073),c=i(8777),s=i(8158),a=i(4762),r=i(5137),d=i(1572),u=i(4144),l=i(4892);function p(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-button",7),d.NdJ("click",function(){return d.CHM(t),d.oxw().createPack()}),d.qZA()}}function h(t,e){if(1&t&&(d.TgZ(0,"p",15),d._uU(1),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(1),d.AsE(" ",t.sizePack," ",t.unitNamePack," ")}}function g(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-button",16),d.NdJ("click",function(){d.CHM(t);const e=d.oxw().$implicit;return d.oxw().createPackitems(e)}),d._UZ(1,"ion-icon",17),d.qZA()}}function m(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-button",18),d.NdJ("click",function(){d.CHM(t);const e=d.oxw().$implicit;return d.oxw().deletePack(e)}),d._UZ(1,"ion-icon",19),d.qZA()}}function k(t,e){if(1&t&&(d.TgZ(0,"ion-item"),d.TgZ(1,"ion-avatar",3),d._UZ(2,"img",8),d.qZA(),d.TgZ(3,"ion-label"),d.TgZ(4,"p",9),d._uU(5),d.qZA(),d.TgZ(6,"p",10),d._uU(7),d.qZA(),d.YNc(8,h,2,2,"p",11),d.qZA(),d.TgZ(9,"div",12),d.YNc(10,g,2,0,"ion-button",13),d.YNc(11,m,2,0,"ion-button",14),d.qZA(),d.qZA()),2&t){const t=e.$implicit,i=d.oxw();d.xp6(2),d.s9C("src",t.url,d.LSH),d.xp6(3),d.hij(" ",t.name," "),d.xp6(2),d.AsE(" ",t.purchasingPrice," -- ",t.sellingPrice," "),d.xp6(1),d.Q6J("ngIf",t.sizePack),d.xp6(2),d.Q6J("ngIf",i.admin),d.xp6(1),d.Q6J("ngIf",i.admin)}}const f=[{path:"",component:(()=>{class t{constructor(t,e,i,n){this.restApiService=t,this.modalController=e,this.alertController=i,this.socket=n,this.flag_pack_add=!1,this.admin=!1,this.tabRoles=[],this.tabRoles=JSON.parse(localStorage.getItem("roles")),(this.tabRoles.includes(1)||this.tabRoles.includes(2))&&(setTimeout(()=>{this.takeProductItems()},2e3),this.takePack()),this.tabRoles.includes(1)&&(this.admin=!0)}ngOnInit(){this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId)}webServerSocket(t){this.socket.connect(),this.socket.emit("set-name",name),this.socket.fromEvent(`${t}newProduct`).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){this.products.unshift(t)})),this.socket.fromEvent(`${t}newPack`).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){this.packs.unshift(t)})),this.socket.fromEvent(`${t}packItem`).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){this.takePack()}))}takeProductItems(){this.restApiService.getProductItem().subscribe(t=>{this.products=t})}takePack(){this.restApiService.getPack().subscribe(t=>{console.log(t),this.packs=t})}register(t){this.unitName&&(t.value.unitNamePack=this.unitName),console.log("here",this.product),t.value.productItemId=this.product._id,t.value.productId=this.product.productId,t.value.url=this.product.url,t.value.sizeUnitProduct=this.product.sizeUnitProduct,t.value.unitNameProduct=this.product.unitNameProduct;let e=this.product.unitNameProduct,i=this.product.sizeUnitProduct;console.log(t.value),this.restApiService.postPack(t.value).subscribe(n=>{console.log(n.data);let o=n.data;this.flag_pack_add=!1,o.productPackId=o._id,o.itemsInPack=t.value.sizePack,o.sizeUnitProduct=i,o.unitNameProduct=e,this.restApiService.postPackItem(o).subscribe(t=>{})})}test(t){this.productId=t.target.value,this.product=this.products.filter(t=>t._id===this.productId)[0],this.productName=this.product.name}unitMeasure(t){this.unitName=t.target.value}createPack(){this.flag_pack_add=!this.flag_pack_add}deletePack(t){let e=t._id;this.restApiService.deletePack(e).subscribe(t=>{this.packs=this.packs.filter(t=>t._id!==e)})}createPackitems(t){return(0,a.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:r.q,componentProps:{product:t}});return e.onDidDismiss().then(t=>{console.log(t)}),yield e.present()})}presentAlert(t){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"ELPIS",subHeader:"sauvegarde ok",buttons:["OK"]});yield t.present()})}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(u.e),d.Y36(s.IN),d.Y36(s.Br),d.Y36(l.sk))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-item"]],decls:12,vars:3,consts:[["color","primary"],["slot","end"],[3,"click",4,"ngIf"],["slot","start"],["autoHide","false"],[3,"hidden"],[4,"ngFor","ngForOf"],[3,"click"],[3,"src"],[1,"packName"],[1,"packPrice"],["class","packUnit",4,"ngIf"],[1,"divBtn"],["class","divBtnUpdate","color","warning",3,"click",4,"ngIf"],["class","divBtnDelete","color","danger",3,"click",4,"ngIf"],[1,"packUnit"],["color","warning",1,"divBtnUpdate",3,"click"],["name","add","slot","icon-only"],["color","danger",1,"divBtnDelete",3,"click"],["name","trash","slot","icon-only"]],template:function(t,e){1&t&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar",0),d.TgZ(2,"ion-title"),d._uU(3,"ADD PACK"),d.qZA(),d.TgZ(4,"ion-buttons",1),d.YNc(5,p,1,0,"ion-button",2),d.qZA(),d.TgZ(6,"ion-buttons",3),d._UZ(7,"ion-menu-button",4),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"ion-content"),d.TgZ(9,"div",5),d.TgZ(10,"ion-list"),d.YNc(11,k,12,7,"ion-item",6),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(5),d.Q6J("ngIf",e.admin),d.xp6(4),d.Q6J("hidden",e.flag_pack_add),d.xp6(2),d.Q6J("ngForOf",e.packs))},directives:[s.Gu,s.sr,s.wd,s.Sm,n.O5,s.fG,s.W2,s.q_,n.sg,s.YG,s.Ie,s.BJ,s.Q$,s.gu],styles:["ion-label[_ngcontent-%COMP%]{font-size:5px}.packName[_ngcontent-%COMP%], .packPrice[_ngcontent-%COMP%], .packUnit[_ngcontent-%COMP%]{font-size:12px;margin:0;padding:0}.divBtn[_ngcontent-%COMP%]{height:10px;width:15}.divBtn[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-size:55%}.divBtnUpdate[_ngcontent-%COMP%]{position:relative;right:30%}"]}),t})()}];let P=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[n.ez,o.u5,s.Pc,c.Bz.forChild(f)]]}),t})()}}]);