(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[3728],{3728:(e,t,s)=>{"use strict";s.r(t),s.d(t,{StoreCustomerPageModule:()=>L});var o=s(1511),i=s(6073),n=s(8158),r=s(8777),c=s(4762),l=s(1311),a=s(1344),u=s.n(a),d=s(4270),h=s(5523),m=s(1572),g=s(5946),p=s(2968),v=s(4375),f=s(2874),Z=s(4418),C=s(731),y=s(1064);function b(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"ion-button",11),m.NdJ("click",function(){return m.CHM(e),m.oxw().displayLeaderClients()}),m._uU(1),m.ALo(2,"translate"),m.qZA()}2&e&&(m.xp6(1),m.hij(" ",m.lcZ(2,1,"MENU.leader")," "))}function k(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"ion-button",11),m.NdJ("click",function(){return m.CHM(e),m.oxw().displayBonus()}),m._uU(1),m.ALo(2,"translate"),m.qZA()}2&e&&(m.xp6(1),m.hij(" ",m.lcZ(2,1,"MENU.displaysv")," "))}const A=function(e){return{"background-color":e}},q=function(e){return[e,"FCFA","symbol","3.0-0","fr"]};function S(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"ion-row",13),m.NdJ("click",function(){m.CHM(e);const s=t.$implicit;return m.oxw(2).manageCustumer(s)}),m.TgZ(1,"ion-col",7),m.TgZ(2,"div",8),m._uU(3),m.qZA(),m.qZA(),m.TgZ(4,"ion-col",7),m.TgZ(5,"div",8),m._uU(6),m.qZA(),m.qZA(),m.TgZ(7,"ion-col",9),m.TgZ(8,"div",8),m._uU(9),m.qZA(),m.qZA(),m.TgZ(10,"ion-col",9),m.TgZ(11,"div",8),m._uU(12),m.qZA(),m.qZA(),m.TgZ(13,"ion-col",9),m.TgZ(14,"div",8),m._uU(15),m.ALo(16,"currency"),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit;m.Q6J("ngStyle",m.VKq(12,A,t.index%2==0?"#f1f1f1":"white")),m.xp6(3),m.hij(" ",e.name?e.name:"no Name"," "),m.xp6(3),m.hij(" ",e.phone?e.phone:"no phone"," "),m.xp6(3),m.hij(" ",e.ville?e.ville:"no ville"," "),m.xp6(3),m.hij(" ",e.quartier?e.quartier:"no quartier"," "),m.xp6(3),m.hij(" ",m.G7q(16,6,m.VKq(14,q,e.solde?e.solde:0))," ")}}function U(e,t){if(1&e&&(m.TgZ(0,"div"),m.YNc(1,S,17,16,"ion-row",12),m.qZA()),2&e){const e=m.oxw();m.xp6(1),m.Q6J("ngForOf",e.customerList)}}const x=[{path:"",component:(()=>{class e{constructor(e,t,s,o,i,n,r,c,l,a,u){this.modalController=e,this.adminService=t,this.urlService=s,this.actionSheetController=o,this.alertController=i,this.saveRandom=n,this.router=r,this.notifi=c,this.manageSocket=l,this.translateConfigService=a,this.translate=u,this.customerList=[],this.useBonus=!1,this.tabRole=[]}ngOnInit(){let e=JSON.parse(localStorage.getItem("setting"));console.log(e),this.languageChanged(),e[0].use_bonus&&(this.useBonus=!0),console.log(e),this.takeUrl(),this.webServerSocket(localStorage.getItem("adminId")),this.tabRole=this.saveRandom.getTabRole(),this.tabRole.includes(9)}languageChanged(){let e=localStorage.getItem("language");e&&this.translateConfigService.setLanguage(e)}ionViewWillEnter(){this.getMyCustomer()}takeUrl(){this.urlService.getUrl().subscribe(e=>{this.url=e})}getMyCustomer(){this.notifi.presentLoading(),this.adminService.getUserCustumer().subscribe(e=>{console.log(e),this.customerList=e.custumers,this.saveRandom.setCustomerList(this.customerList),this.notifi.dismissLoading()})}presentModal(){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:l.W,cssClass:"mymodal-class"});return e.onDidDismiss().then(e=>{console.log(e)}),yield e.present()})}webServerSocket(e){this.sockets=u()(this.url),this.sockets.on("connect",function(){}),this.sockets.on(`${e}customerAdd`,e=>(0,c.mG)(this,void 0,void 0,function*(){this.customerList.unshift(e)})),this.sockets.on(`${e}customerUpdate`,e=>(0,c.mG)(this,void 0,void 0,function*(){let t=this.customerList.findIndex(t=>t._id==e._id);t>=0&&this.customerList.splice(t,1,e)})),this.sockets.on(`${e}customerDelete`,e=>(0,c.mG)(this,void 0,void 0,function*(){this.customerList=this.customerList.filter(t=>t._id!=e._id)}))}manageCustumer(e){return(0,c.mG)(this,void 0,void 0,function*(){if(console.log(e),this.tabRole.includes(9))this.saveRandom.setData(e),this.router.navigateByUrl("store-customer-balance");else{let t=[{text:"Display customer",icon:"share",handler:()=>{this.displayCustomer(e)}},{text:"Customer Invoice",icon:"person",handler:()=>{this.displayInvoicesCustomer(e)}},{text:"Customer Balance",icon:"person",handler:()=>{this.saveRandom.setData(e),this.router.navigateByUrl("store-customer-balance")}},{text:"Delete Customers",role:"destructive",icon:"trash",handler:()=>{console.log(e),this.confirmDelete(e)}},{text:"Update",icon:"share",handler:()=>{this.updateCustomer(e)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}];this.useBonus&&t.push({text:"Display Point",icon:"close",handler:()=>{console.log("Cancel clicked")}});const s=yield this.actionSheetController.create({header:`customer : ${e.name}`,cssClass:"my-actionSheet-class",buttons:t});yield s.present();const{role:o}=yield s.onDidDismiss();console.log("onDidDismiss resolved with role",o)}})}updateCustomer(e){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:d.m,cssClass:"mymodal-class",componentProps:{customer:e}});return t.onDidDismiss().then(e=>{console.log(e)}),yield t.present()})}displayCustomer(e){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:h.M,cssClass:"mymodal-class",componentProps:{customer:e}});return t.onDidDismiss().then(e=>{console.log(e)}),yield t.present()})}confirmDelete(e){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({cssClass:"my-custom-alertClass",header:"Confirm!",message:`Delete ${e.name} ?`,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirm Cancel: blah")}},{text:"YES",cssClass:"danger",handler:()=>{this.adminService.deleteUserCustumer(e._id).subscribe(e=>{})}}]});yield t.present()})}displayInvoicesCustomer(e){this.notifi.presentLoading(),this.adminService.getInvoiceCustomer(e._id).subscribe(e=>{this.notifi.dismissLoading(),e.docs.length?(this.saveRandom.setCustomerInvoices(e.docs),this.router.navigateByUrl("store-customer-invoice")):this.notifi.presentError("not invoices found","primary").then(()=>{})},e=>{this.notifi.dismissLoading(),this.notifi.presentError("unable to join server please check your internet connection","danger").then(()=>{})})}displayBonus(){this.router.navigateByUrl("display-bonus-customer")}displayLeaderClients(){console.log(this.customerList);let e=this.customerList.filter(e=>1==e.Role);console.log(e),e&&(this.saveRandom.setCustomerList(this.customerList),this.saveRandom.setData(e),this.router.navigateByUrl("leader-list"))}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(n.IN),m.Y36(g.l),m.Y36(p.i),m.Y36(n.BX),m.Y36(n.Br),m.Y36(v.i),m.Y36(r.F0),m.Y36(f.g),m.Y36(Z.W),m.Y36(C.w),m.Y36(y.sK))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-store-customer"]],decls:29,vars:6,consts:[["slot","start"],["defaultHref","/start"],["slot","end"],["color","primary",3,"click",4,"ngIf"],["color","success",3,"click"],["slot","end","name","add-outline"],[1,"row-header"],["size-sm","3","size-md","3","size-xm","3","size-lg","3",1,"ion-align-self-center"],[1,"ion-text-center","ion-text-uppercase","taille"],["size-sm","2","size-md","2","size-xm","2","size-lg","2",1,"ion-align-self-center"],[4,"ngIf"],["color","primary",3,"click"],["color","primary",3,"ngStyle","click",4,"ngFor","ngForOf"],["color","primary",3,"ngStyle","click"]],template:function(e,t){1&e&&(m.TgZ(0,"ion-header"),m.TgZ(1,"ion-toolbar"),m.TgZ(2,"ion-buttons",0),m._UZ(3,"ion-back-button",1),m.qZA(),m.TgZ(4,"ion-buttons",2),m.YNc(5,b,3,3,"ion-button",3),m.YNc(6,k,3,3,"ion-button",3),m.TgZ(7,"ion-button",4),m.NdJ("click",function(){return t.presentModal()}),m._uU(8),m.ALo(9,"translate"),m._UZ(10,"ion-icon",5),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(11,"ion-content"),m.TgZ(12,"ion-row",6),m.TgZ(13,"ion-col",7),m.TgZ(14,"div",8),m._uU(15,"Nom"),m.qZA(),m.qZA(),m.TgZ(16,"ion-col",7),m.TgZ(17,"div",8),m._uU(18,"phone"),m.qZA(),m.qZA(),m.TgZ(19,"ion-col",9),m.TgZ(20,"div",8),m._uU(21,"ville"),m.qZA(),m.qZA(),m.TgZ(22,"ion-col",9),m.TgZ(23,"div",8),m._uU(24,"quartier"),m.qZA(),m.qZA(),m.TgZ(25,"ion-col",9),m.TgZ(26,"div",8),m._uU(27,"Solde"),m.qZA(),m.qZA(),m.qZA(),m.YNc(28,U,2,1,"div",10),m.qZA()),2&e&&(m.xp6(5),m.Q6J("ngIf",!t.tabRole.includes(9)),m.xp6(1),m.Q6J("ngIf",!t.tabRole.includes(9)),m.xp6(2),m.hij(" ",m.lcZ(9,4,"MENU.customers")," "),m.xp6(20),m.Q6J("ngIf",t.customerList))},directives:[n.Gu,n.sr,n.Sm,n.oU,n.cs,o.O5,n.YG,n.gu,n.W2,n.Nd,n.wI,o.sg,o.PC],pipes:[y.X$,o.H9],styles:[".row-header[_ngcontent-%COMP%]{background-color:var(--primary)}.my-custom-alertClass[_ngcontent-%COMP%]   .alert-wrapper[_ngcontent-%COMP%]{background:#f55151}.danger[_ngcontent-%COMP%]{color:var(--danger)}"]}),e})()}];let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[r.Bz.forChild(x)],r.Bz]}),e})(),L=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[o.ez,i.u5,n.Pc,T,y.aw.forChild()]]}),e})()},4418:(e,t,s)=>{"use strict";s.d(t,{W:()=>l});var o=s(1344),i=s.n(o),n=s(8512),r=s(1572),c=s(2968);let l=(()=>{class e{constructor(e){this.urlService=e,this.mysocket=new n.X(null),this.sock=!1,this.takeUrl()}takeUrl(){console.log("je demmare ici url"),this.urlService.getUrl().subscribe(e=>{this.url=e,this.adminId=localStorage.getItem("adminId"),this.sockets=i()(this.url),this.mysocket.next(this.sockets)})}getSocket(){return this.mysocket}disconnectSocket(){this.sockets.disconnect()}getMySocket(){return this.sockets}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(c.i))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);