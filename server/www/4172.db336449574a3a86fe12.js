(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[4172],{1044:(t,i,e)=>{"use strict";e.d(i,{n:()=>r});var o=e(4762),n=e(1572),s=e(9719);let r=(()=>{class t{constructor(t){this.getStoreName=t}rangeProductByStore(t){return new Promise((i,e)=>{let n=t.reduce((t,i)=>(t[i.storeId]=[...t[i.storeId]||[],i],t),{}),s=[];for(const t in n)s.push(n[t]);s.forEach(t=>(0,o.mG)(this,void 0,void 0,function*(){let i=yield this.getStoreName.takeName(t);t.storeName=i})),i(s)})}}return t.\u0275fac=function(i){return new(i||t)(n.LFG(s.$))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4172:(t,i,e)=>{"use strict";e.r(i),e.d(i,{SwHomePageModule:()=>Y});var o=e(1511),n=e(6073),s=e(8158),r=e(8777),c=e(4762),a=e(1344),l=e.n(a),d=e(994),u=e(5416),g=e(5959),m=e(9611),p=e(1572),h=e(9719),Z=e(1044),f=e(4069),v=e(4375),T=e(2874),b=e(4144),q=e(2968),A=e(5541),S=e(2185),w=e(5946),x=e(6351);function y(t,i){1&t&&(p.TgZ(0,"div",10),p._UZ(1,"app-fakedata"),p.qZA())}const C=function(t){return{"background-color":t}};function _(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"ion-row",17),p.TgZ(1,"ion-col",15),p.TgZ(2,"div",18),p._uU(3),p.qZA(),p.qZA(),p.TgZ(4,"ion-col",15),p.TgZ(5,"div",19),p._uU(6),p.qZA(),p.qZA(),p.TgZ(7,"ion-col",15),p.TgZ(8,"div",19),p._uU(9),p.qZA(),p.qZA(),p.TgZ(10,"ion-col",15),p.TgZ(11,"div",19),p.TgZ(12,"ion-input",20),p.NdJ("ionChange",function(e){p.CHM(t);const o=i.index;return p.oxw(2).addValue(e,o)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit,e=i.index;p.Q6J("ngStyle",p.VKq(4,C,t.quantityItems<=t.quantityToAlert?"var(--ion-color-danger)":e%2==0?"#f1f1f1":"white")),p.xp6(3),p.hij(" ",t.name," "),p.xp6(3),p.hij(" ",t.quantityItems," "),p.xp6(3),p.hij(" ",t.quantityStore," ")}}function k(t,i){if(1&t&&(p.TgZ(0,"ion-grid"),p.TgZ(1,"ion-row",11),p.TgZ(2,"ion-col",12),p.TgZ(3,"div",13),p.TgZ(4,"p"),p._uU(5,"Ravitaillement"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(6,"ion-row",14),p.TgZ(7,"ion-col",15),p.TgZ(8,"div",10),p._uU(9,"name"),p.qZA(),p.qZA(),p.TgZ(10,"ion-col",15),p.TgZ(11,"div",10),p._uU(12,"En stock"),p.qZA(),p.qZA(),p.TgZ(13,"ion-col",15),p.TgZ(14,"div",10),p._uU(15,"En vente"),p.qZA(),p.qZA(),p.TgZ(16,"ion-col",15),p.TgZ(17,"div",10),p._uU(18,"Ravitailler"),p.qZA(),p.qZA(),p.qZA(),p.YNc(19,_,13,6,"ion-row",16),p.qZA()),2&t){const t=p.oxw();p.xp6(19),p.Q6J("ngForOf",t.productServiceTab)}}function I(t,i){1&t&&(p.TgZ(0,"div",10),p._UZ(1,"app-fakedata"),p.qZA())}const N=function(t){return[t,"FCFA","symbol","3.0-0","fr"]};function U(t,i){if(1&t){const t=p.EpF();p.TgZ(0,"ion-row",17),p.TgZ(1,"ion-col",22),p.NdJ("click",function(){p.CHM(t);const e=i.$implicit,o=i.index;return p.oxw(2).displayBill(e,o)}),p.TgZ(2,"div",19),p._uU(3),p.ALo(4,"date"),p.qZA(),p.qZA(),p.TgZ(5,"ion-col",22),p.NdJ("click",function(){p.CHM(t);const e=i.$implicit,o=i.index;return p.oxw(2).displayBill(e,o)}),p.TgZ(6,"div",19),p._uU(7),p.qZA(),p.qZA(),p.TgZ(8,"ion-col",22),p.NdJ("click",function(){p.CHM(t);const e=i.$implicit,o=i.index;return p.oxw(2).displayBill(e,o)}),p.TgZ(9,"div",19),p._uU(10),p.qZA(),p.qZA(),p.TgZ(11,"ion-col",23),p.NdJ("click",function(){p.CHM(t);const e=i.$implicit,o=i.index;return p.oxw(2).displayBill(e,o)}),p.TgZ(12,"div",19),p._uU(13),p.ALo(14,"currency"),p.qZA(),p.qZA(),p.TgZ(15,"ion-col",15),p.TgZ(16,"div",19),p.TgZ(17,"ion-button",24),p.NdJ("click",function(){p.CHM(t);const e=i.$implicit,o=i.index;return p.oxw(2).valider(e,o)}),p._uU(18,"valider"),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=i.$implicit;p.Q6J("ngStyle",p.VKq(14,C,i.index%2==0?"#f1f1f1":"white")),p.xp6(3),p.hij(" ",p.xi3(4,5,t.created,"short")," "),p.xp6(4),p.hij(" ",t.customer?t.customer.name:"No Name"," "),p.xp6(3),p.hij(" ",t.userName?t.userName:"No Name"," "),p.xp6(3),p.hij(" ",p.G7q(14,8,p.VKq(16,N,t.montantReduction?t.montantReduction:t.commande.cartdetails.totalPrice))," ")}}function z(t,i){if(1&t&&(p.TgZ(0,"ion-grid"),p.TgZ(1,"ion-row",11),p.TgZ(2,"ion-col",12),p.TgZ(3,"div",13),p.TgZ(4,"p"),p._uU(5,"commandes clients"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(6,"ion-row",14),p.TgZ(7,"ion-col",21),p.TgZ(8,"div",10),p._uU(9,"Date"),p.qZA(),p.qZA(),p.TgZ(10,"ion-col",21),p.TgZ(11,"div",10),p._uU(12,"Client"),p.qZA(),p.qZA(),p.TgZ(13,"ion-col",21),p.TgZ(14,"div",10),p._uU(15,"Emp"),p.qZA(),p.qZA(),p.TgZ(16,"ion-col",15),p.TgZ(17,"div",10),p._uU(18,"Montant"),p.qZA(),p.qZA(),p.TgZ(19,"ion-col",15),p.TgZ(20,"div",10),p._uU(21,"status"),p.qZA(),p.qZA(),p.qZA(),p.YNc(22,U,19,18,"ion-row",16),p.qZA()),2&t){const t=p.oxw();p.xp6(22),p.Q6J("ngForOf",t.billTab)}}const P=[{path:"",component:(()=>{class t{constructor(t,i,e,o,n,s,r,c,a,l,d,u,m){this.getStoreName=t,this.rangeByStoreService=i,this.servicelistService=e,this.saveRandom=o,this.notifi=n,this.restApiService=s,this.urlService=r,this.menu=c,this.events=a,this.swService=l,this.router=d,this.adminService=u,this.modalController=m,this.productServiceTab=[],this.transaction=[],this.billTab=[],this.customerList=[],this.destroy$=new g.xQ}ngOnInit(){this.getSetting()}ionViewDidEnter(){this.menu.enable(!0,"first"),this.takeUrl(),this.takeProductServiceList(),this.getPurchase(),this.getCustomerBill()}takeUrl(){this.urlService.getUrl().subscribe(t=>{console.log("url ici===",t),this.url=t,this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId,t)})}takeProductServiceList(){JSON.parse(localStorage.getItem("user")),this.restApiService.getBillardList().subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){let i=t.product.sort((t,i)=>t.name.toLocaleLowerCase()>i.name.toLocaleLowerCase()?1:t.name.toLocaleLowerCase()<i.name.toLocaleLowerCase()?-1:0);i=t.product,console.log("=====>",i),this.productServiceTab=i.filter(t=>0==t.desabled)}))}webServerSocket(t,i){this.sockets=l()(i);let e=this.saveRandom.getStoreId();this.sockets.on("connect",function(){console.log("je suis connect\xe9 socket",i)}),this.sockets.on(`${this.adminId}warehouseChange`,t=>{this.transaction.push(t),this.notifi.presentToast("you have new notification","danger")}),this.sockets.on(`${t}${e}buyOrder`,t=>{if(console.log("new here ===>",t),t.customerId&&!t.swConfirm){let i=this.customerList.find(i=>i._id==t.customerId);i&&(t.customer=i),this.billTab.unshift(t)}else t.swConfirm||this.billTab.unshift(t)}),this.sockets.on(`${t}${e}invoiceCancel`,t=>{this.billTab=this.billTab.filter(i=>i._id!==t._id)}),this.sockets.on(`${t}${e}billardItem`,t=>{console.log(t);let i=this.productServiceTab.findIndex(i=>i._id==t._id);i>=0&&this.productServiceTab.splice(i,1,t)})}goTo(){this.transaction=[],this.router.navigateByUrl("sw-commandes")}getPurchase(){JSON.parse(localStorage.getItem("roles")),this.adminService.getPurchase().subscribe(t=>{this.transaction=t.docs.filter(t=>"scConfirm"in t&&1==t.scConfirm&&"swConfirm"in t&&0==t.swConfirm)})}addValue(t,i){let e=parseInt(t.target.value),o=this.productServiceTab[i];e&&e>0&&this.notifi.presentAlertConfirm(`add ${t.detail.value} to ${o.name} ?`,"oui","non").then(()=>{this.notifi.presentLoading(),this.productServiceTab[i].quantityItems=this.productServiceTab[i].quantityItems+parseInt(t.detail.value);let n={id:o._id,newquantity:e};n.adminId=o.adminId,this.swService.updateBillardGame(n).subscribe(t=>{console.log(t),this.productServiceTab.splice(i,1,t.resultat),this.notifi.dismissLoading()},t=>{console.log(t)})}).catch(()=>{})}getCustomerBill(){this.adminService.getInvoiceNotPaieAdmin2(1).pipe((0,u.R)(this.destroy$)).subscribe(t=>(0,c.mG)(this,void 0,void 0,function*(){console.log("voici les invoices===>",t),this.getMyCustomer(),this.billTab=t.filter(t=>0==t.swConfirm)}),t=>{})}displayBill(t,i){return(0,c.mG)(this,void 0,void 0,function*(){const i=yield this.modalController.create({component:d.k,componentProps:{order:t,order2:t,Bill:!0},cssClass:"custom-modal"});return i.onDidDismiss().then(t=>{}),yield i.present()})}valider(t,i){console.log("bill here",t),this.notifi.presentAlertConfirm("Vous confirmez la livraison ?","OUI","NON").then(()=>{this.notifi.presentLoading(),t.swConfirm=!0,this.adminService.swUpdateBill(t).subscribe(t=>{this.billTab.splice(i,1),this.notifi.dismissLoading()})}).catch(t=>{})}getMyCustomer(){this.adminService.getUserCustumer().subscribe(t=>{this.customerList=t.custumers,this.billTab.forEach(t=>{let i=this.customerList.find(i=>i._id==t.customerId);i&&(t.customer=i)})})}updateProduct(t,i){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:m.f,componentProps:{product:t,page:"billard"}});return e.onDidDismiss().then(t=>{console.log(t),"no_update"===t.data?console.log(t.data):t.data.product&&this.productServiceTab.splice(i,1,t.data.product)}),yield e.present()})}getSetting(){this.adminService.getCompanySetting().pipe((0,u.R)(this.destroy$)).subscribe(t=>{if(t.company.length){let i=t.company[0];this.saveRandom.setSetting(i),localStorage.setItem("setting",JSON.stringify(t.company)),localStorage.setItem("useResource",JSON.stringify(i.use_resource)),localStorage.setItem("manageStockWithService",JSON.stringify(i.manageStockWithService)),localStorage.setItem("poslive",JSON.stringify(i.use_pos_live))}},t=>{console.log(t)})}}return t.\u0275fac=function(i){return new(i||t)(p.Y36(h.$),p.Y36(Z.n),p.Y36(f.y),p.Y36(v.i),p.Y36(T.g),p.Y36(b.e),p.Y36(q.i),p.Y36(s._q),p.Y36(A.t),p.Y36(S.f),p.Y36(r.F0),p.Y36(w.l),p.Y36(s.IN))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-sw-home"]],decls:17,vars:5,consts:[["slot","start",1,"btnmenu"],["autoHide","false"],["slot","start"],[3,"click"],["name","notifications-outline"],["id","notifications-badge","color","danger"],[2,"display","flex","justify-content","space-between"],[2,"flex-grow","1","padding-right","10px","padding-left","10px","border-right","2px solid black"],["class","ion-text-center",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center"],[2,"font-size","14px","font-weight","bold"],["size","12"],[1,"ion-text-center","ion-text-uppercase"],[1,"header-component"],["size-sm","3","size-md","3","size-lg","3"],["class","data-row data-update","style","font-size: 11px",3,"ngStyle",4,"ngFor","ngForOf"],[1,"data-row","data-update",2,"font-size","11px",3,"ngStyle"],[1,"ion-text-start","ion-text-uppercase","smallSize"],[1,"ion-text-center","ion-text-uppercase","smallSize"],["slot","end","placeholder","quantit\xe9","type","number","debounce","500",3,"ionChange"],["size-sm","2","size-md","2","size-lg","2"],["size-sm","2","size-md","2","size-lg","2",3,"click"],["size-sm","3","size-md","3","size-lg","3",3,"click"],["size","small",2,"font-size","10px",3,"click"]],template:function(t,i){1&t&&(p.TgZ(0,"ion-header"),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-buttons",0),p._UZ(3,"ion-menu-button",1),p.qZA(),p.TgZ(4,"ion-buttons",2),p.TgZ(5,"ion-button",3),p.NdJ("click",function(){return i.goTo()}),p._UZ(6,"ion-icon",4),p.TgZ(7,"ion-badge",5),p._uU(8),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(9,"ion-content"),p.TgZ(10,"div",6),p.TgZ(11,"div",7),p.YNc(12,y,2,0,"div",8),p.YNc(13,k,20,1,"ion-grid",9),p.qZA(),p.TgZ(14,"div",7),p.YNc(15,I,2,0,"div",8),p.YNc(16,z,23,1,"ion-grid",9),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(8),p.hij("",i.transaction.length," "),p.xp6(4),p.Q6J("ngIf",0==i.productServiceTab.length),p.xp6(1),p.Q6J("ngIf",i.productServiceTab.length),p.xp6(2),p.Q6J("ngIf",0==i.billTab.length),p.xp6(1),p.Q6J("ngIf",i.billTab.length))},directives:[s.Gu,s.sr,s.Sm,s.fG,s.YG,s.gu,s.yp,s.W2,o.O5,x.Q,s.jY,s.Nd,s.wI,o.sg,o.PC,s.pK,s.as],pipes:[o.uU,o.H9],styles:["#notification-button[_ngcontent-%COMP%]{position:relative;top:1px;right:1px;overflow:visible!important}#notifications-badge[_ngcontent-%COMP%]{background-color:red;position:absolute;top:-5px;right:-3px;border-radius:100%}.stock-alert[_ngcontent-%COMP%]{--ion-background-color:#f14b4b;--color:#fff;opacity:.8}.stock-alert[_ngcontent-%COMP%]   .instock[_ngcontent-%COMP%], .stock-alert[_ngcontent-%COMP%]   .instore[_ngcontent-%COMP%]{color:#fff}.stock-alert[_ngcontent-%COMP%]   .btnWarehouse[_ngcontent-%COMP%]{--border-color:#000;--color:#000}"]}),t})()}];let J=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[r.Bz.forChild(P)],r.Bz]}),t})();var O=e(1064),L=e(9547);let Y=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[o.ez,n.u5,s.Pc,J,O.aw.forChild(),L.G]]}),t})()}}]);