(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[2188],{2188:(t,e,o)=>{"use strict";o.r(e),o.d(e,{PurchasePageModule:()=>U});var i=o(1511),n=o(6073),c=o(8777),r=o(8158),s=o(4762),l=o(1572),a=o(5946),u=o(2874),d=o(4375),g=o(3629),p=o(1064);function h(t,e){1&t&&l._UZ(0,"ion-back-button",7)}function Z(t,e){1&t&&l._UZ(0,"ion-back-button",8)}function f(t,e){if(1&t&&(l.TgZ(0,"div",15),l._uU(1),l.ALo(2,"currency"),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.gM2(2,1,t.packPrice,"CFA","symbol","3.0-0")," ")}}function m(t,e){if(1&t&&(l.TgZ(0,"div",15),l._uU(1),l.ALo(2,"currency"),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.gM2(2,1,t.item.purchasingPrice,"CFA","symbol","3.0-0")," ")}}function A(t,e){if(1&t&&(l.TgZ(0,"ion-col",21),l.TgZ(1,"div",11),l._uU(2),l.qZA(),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(2),l.Oqu(t.qty)}}function q(t,e){if(1&t&&(l.TgZ(0,"ion-col",21),l.TgZ(1,"div",11),l._uU(2),l.qZA(),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(2),l.AsE(" ",t.qty," + ",t.item.nbrBtl,"btls ")}}function v(t,e){if(1&t&&(l.TgZ(0,"div",15),l._uU(1),l.ALo(2,"currency"),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.gM2(2,1,t.qty*t.packPrice+(t.item.nbrBtl?t.item.nbrBtl*t.item.purchasingPrice:0),"CFA","symbol","3.0-0")," ")}}function x(t,e){if(1&t&&(l.TgZ(0,"div",15),l._uU(1),l.ALo(2,"currency"),l.qZA()),2&t){const t=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.gM2(2,1,t.qty*t.item.purchasingPrice,"CFA","symbol","3.0-0")," ")}}function P(t,e){if(1&t&&(l.TgZ(0,"ion-row",24),l.TgZ(1,"ion-col",21),l.TgZ(2,"div",15),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",21),l.YNc(5,f,3,6,"div",25),l.YNc(6,m,3,6,"div",25),l.qZA(),l.YNc(7,A,3,1,"ion-col",26),l.YNc(8,q,3,2,"ion-col",26),l.TgZ(9,"ion-col",21),l.YNc(10,v,3,6,"div",25),l.YNc(11,x,3,6,"div",25),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(3),l.Oqu(t.item.name),l.xp6(2),l.Q6J("ngIf",t.packPrice>1),l.xp6(1),l.Q6J("ngIf",0==t.packPrice),l.xp6(1),l.Q6J("ngIf",!t.item.nbrBtl),l.xp6(1),l.Q6J("ngIf",t.item.nbrBtl),l.xp6(2),l.Q6J("ngIf","productItems"===t.item.thetype||"pack"===t.item.thetype),l.xp6(1),l.Q6J("ngIf","productItems"!==t.item.thetype&&"pack"!==t.item.thetype)}}function T(t,e){if(1&t&&(l.TgZ(0,"ion-col",19),l.TgZ(1,"ion-row",20),l.TgZ(2,"ion-col",21),l.TgZ(3,"div",15),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.qZA(),l.TgZ(6,"ion-col",21),l.TgZ(7,"div",15),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",21),l.TgZ(11,"div",15),l._uU(12),l.ALo(13,"translate"),l.qZA(),l.qZA(),l.TgZ(14,"ion-col",21),l.TgZ(15,"div",15),l._uU(16),l.ALo(17,"translate"),l.qZA(),l.qZA(),l.qZA(),l.YNc(18,P,12,7,"ion-row",22),l._UZ(19,"ion-row",23),l.qZA()),2&t){const t=l.oxw(3);l.xp6(4),l.Oqu(l.lcZ(5,5,"MENU.name")),l.xp6(4),l.hij(" ",l.lcZ(9,7,"MENU.price")," "),l.xp6(4),l.hij(" ",l.lcZ(13,9,"MENU.quantity")," "),l.xp6(4),l.hij(" T.",l.lcZ(17,11,"MENU.price")," "),l.xp6(2),l.Q6J("ngForOf",t.articles)}}const b=function(t){return{"background-color":t}};function y(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"ion-row",13),l.NdJ("click",function(){l.CHM(t);const o=e.$implicit,i=e.index;return l.oxw(2).presentActionSheet(o,i)}),l.TgZ(1,"ion-col",14),l.TgZ(2,"div",15),l._uU(3),l.ALo(4,"date"),l.qZA(),l.qZA(),l.TgZ(5,"ion-col",14),l.TgZ(6,"div",15),l._uU(7),l.qZA(),l.qZA(),l.TgZ(8,"ion-col",14),l.TgZ(9,"div",15),l._uU(10),l.qZA(),l.qZA(),l.TgZ(11,"ion-col",14),l.TgZ(12,"div",15),l._uU(13),l.ALo(14,"currency"),l.qZA(),l.qZA(),l.TgZ(15,"ion-col",14),l._UZ(16,"div",15),l.qZA(),l.TgZ(17,"ion-col",14),l.TgZ(18,"div",15),l.TgZ(19,"ion-button",16),l._UZ(20,"ion-icon",17),l.qZA(),l.qZA(),l.qZA(),l.YNc(21,T,20,13,"ion-col",18),l.qZA()}if(2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(13,b,e.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.Oqu(l.lcZ(4,6,t.purchaseDate)),l.xp6(4),l.Oqu(t.hours),l.xp6(3),l.Oqu(t.quantity),l.xp6(3),l.hij(" ",l.gM2(14,8,t.totalPrice,"CFA","symbol","3.0-0")," "),l.xp6(8),l.Q6J("ngIf",t.open)}}function _(t,e){if(1&t&&(l.TgZ(0,"div"),l.TgZ(1,"ion-row",9),l.TgZ(2,"ion-col",10),l.TgZ(3,"div",11),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.qZA(),l.TgZ(6,"ion-col",10),l.TgZ(7,"div",11),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.qZA(),l.TgZ(10,"ion-col",10),l.TgZ(11,"div",11),l._uU(12),l.ALo(13,"translate"),l.qZA(),l.qZA(),l.TgZ(14,"ion-col",10),l.TgZ(15,"div",11),l._uU(16),l.ALo(17,"translate"),l.qZA(),l.qZA(),l.TgZ(18,"ion-col",10),l._UZ(19,"div",11),l.qZA(),l.TgZ(20,"ion-col",10),l.TgZ(21,"div",11),l._uU(22,"action"),l.qZA(),l.qZA(),l.qZA(),l.YNc(23,y,22,15,"ion-row",12),l.qZA()),2&t){const t=l.oxw();l.xp6(4),l.Oqu(l.lcZ(5,5,"MENU.day")),l.xp6(4),l.Oqu(l.lcZ(9,7,"MENU.hour")),l.xp6(4),l.Oqu(l.lcZ(13,9,"MENU.quantity")),l.xp6(4),l.Oqu(l.lcZ(17,11,"MENU.price")),l.xp6(7),l.Q6J("ngForOf",t.allPurchase)}}const w=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,c,r,s){this.adminService=t,this.popover=e,this.router=o,this.actionSheet=i,this.alertController=n,this.notifi=c,this.random=r,this.scService=s,this.articles=[],this.totalPurchase=0,this.quantity=0,this.venders=[],this.vendorRole=!1,JSON.parse(localStorage.getItem("user"))[0]&&JSON.parse(localStorage.getItem("user"))[0].venderRole&&(this.vendorRole=JSON.parse(localStorage.getItem("user"))[0].venderRole)}ngOnInit(){}ionViewWillEnter(){let t=this.random.getStoreId(),e=JSON.parse(localStorage.getItem("roles"));this.getVendor(),this.adminService.getPurchase().subscribe(o=>{this.allPurchase=e.includes(2)?o.docs.filter(e=>e.storeId==t):o.docs,console.log(this.allPurchase)})}openPurchase(t,e){console.log(e),console.log(t),this.allPurchase[e].open?(this.allPurchase[e].open=!1,this.articles=[]):(this.allPurchase[e].open=!0,this.allPurchase[e].articles.forEach(t=>{console.log(t),this.totalPurchase=t.totalPrice,this.quantity=t.totalQty?t.totalQty:t.quantity,t.products?(t.products.forEach(t=>{console.log(t),t.packPrice=t.item.packPrice>1&&t.item.qty!==t.item.packPrice?parseInt(t.item.packPrice):t.item.purchasingPrice}),this.articles=[...this.articles,...t.products]):(t.packPrice=t.item.packPrice?parseInt(t.item.packPrice):0,this.articles.push(t))}),console.log(this.articles))}CreatePopover(){this.router.navigateByUrl("product-buy")}getVendor(){this.adminService.getVendors().subscribe(t=>{this.venders=t})}removePurchase(t,e){this.notifi.presentLoading(),this.adminService.deletePurchase(t).subscribe(e=>{this.notifi.dismissLoading(),this.allPurchase=this.allPurchase.filter(e=>e._id!==t._id)})}dsiplayPurchase(t,e){console.log(t),this.random.setData(t),this.router.navigateByUrl("purchase-confirm")}presentAlertConfirm(t,e){return(0,s.mG)(this,void 0,void 0,function*(){const o=yield this.alertController.create({cssClass:"my-custom-class",header:"Confirm!",message:"Voulez vous supprimer ?",buttons:[{text:"NON",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"OUI",handler:()=>{this.removePurchase(t,e)}}]});yield o.present()})}presentActionSheet(t,e){return(0,s.mG)(this,void 0,void 0,function*(){const o=yield this.actionSheet.create({header:"Albums",buttons:[{text:"List",icon:"share",handler:()=>{this.openPurchase(t,e)}},{text:"Bordereau livraison",role:"destructive",icon:"share",handler:()=>{this.dsiplayPurchase(t,e)}},{text:"Supprimer",role:"destructive",icon:"trash",handler:()=>{this.presentAlertConfirm(t,e)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield o.present();const{role:i,data:n}=yield o.onDidDismiss();console.log("onDidDismiss resolved with role and data",i,n)})}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(a.l),l.Y36(r.Dh),l.Y36(c.F0),l.Y36(r.BX),l.Y36(r.Br),l.Y36(u.g),l.Y36(d.i),l.Y36(g.A))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-purchase"]],decls:10,vars:3,consts:[["slot","start"],["defaultHref","/start",4,"ngIf"],["defaultHref","/vendor-start",4,"ngIf"],["slot","end"],["fill","outline","color","medium",3,"click"],["slot","icon-only","name","add-circle-outline"],[4,"ngIf"],["defaultHref","/start"],["defaultHref","/vendor-start"],[1,"header-row"],["size","2"],[1,"ion-text-center"],["class","data-row data-update",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"data-row","data-update",3,"ngStyle","click"],["size","2",1,"ion-align-self-center"],[1,"ion-text-center","inte"],["fill","clear","size","small","color","primary"],["color","dark","name","eye"],["size","12",4,"ngIf"],["size","12"],[1,"second-lastrow"],["size","3"],["class","data-row data-update",4,"ngFor","ngForOf"],[1,"last-row"],[1,"data-row","data-update"],["class","ion-text-center inte",4,"ngIf"],["size","3",4,"ngIf"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l.YNc(3,h,1,0,"ion-back-button",1),l.YNc(4,Z,1,0,"ion-back-button",2),l.qZA(),l.TgZ(5,"ion-buttons",3),l.TgZ(6,"ion-button",4),l.NdJ("click",function(){return e.router.navigateByUrl("product-buy")}),l._UZ(7,"ion-icon",5),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"ion-content"),l.YNc(9,_,24,13,"div",6),l.qZA()),2&t&&(l.xp6(3),l.Q6J("ngIf",!e.vendorRole),l.xp6(1),l.Q6J("ngIf",e.vendorRole),l.xp6(5),l.Q6J("ngIf",e.allPurchase))},directives:[r.Gu,r.sr,r.Sm,i.O5,r.YG,r.gu,r.W2,r.oU,r.cs,r.Nd,r.wI,i.sg,i.PC],pipes:[p.X$,i.uU,i.H9],styles:["ion-col[_ngcontent-%COMP%]   .inte[_ngcontent-%COMP%]{font-size:9px}.second-lastrow[_ngcontent-%COMP%]{background-color:#ebbd40}.header-row[_ngcontent-%COMP%], .second-lastrow[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.header-row[_ngcontent-%COMP%]{background-color:blue}.header-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:9px}.last-row[_ngcontent-%COMP%]{background-color:#ebbd40;padding-top:1px;padding-bottom:1px}@media (max-width:567px){ion-col[_ngcontent-%COMP%]   .inte[_ngcontent-%COMP%]{font-size:10px}}@media (min-width:570px){ion-col[_ngcontent-%COMP%]   .inte[_ngcontent-%COMP%]{font-size:12px}}@media (min-width:800px){ion-col[_ngcontent-%COMP%]   .inte[_ngcontent-%COMP%]{font-size:14px}}"]}),t})()}];let U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.ez,n.u5,r.Pc,c.Bz.forChild(w),p.aw.forChild()]]}),t})()}}]);