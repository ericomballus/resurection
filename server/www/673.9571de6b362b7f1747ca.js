(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[673],{673:(t,e,n)=>{"use strict";n.r(e),n.d(e,{StoreCustomerBalancePageModule:()=>T});var i=n(1511),o=n(6073),s=n(8158),a=n(8777),c=n(1064),r=n(4762),l=n(1572),u=n(4375),g=n(6529),h=n(731),d=n(4418),m=n(529),p=n(9063),Z=n(2968);let b=(()=>{class t{constructor(t,e){this.http=t,this.urlService=e,this.userName="unknown",this.url="http://192.168.100.10:3000/",this.takeUrl()}takeUrl(){m.N.production?this.urlService.getUrl().subscribe(t=>{this.url=t}):this.url=m.V}postBalance(t){let e=localStorage.getItem("adminId");return this.http.post(`${this.url}balance?db=${e}`,t)}getCustomerBalance(t){let e=localStorage.getItem("adminId");return this.http.get(`${this.url}balance/${t}?db=${e}`)}updateBalance(t){let e=localStorage.getItem("adminId");return this.http.patch(`${this.url}balance?db=${e}`,t)}}return t.\u0275fac=function(e){return new(e||t)(l.LFG(p.eN),l.LFG(Z.i))},t.\u0275prov=l.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const f=function(t){return{"background-color":t}},A=function(t){return[t,"FCFA","symbol","3.0-0","fr"]};function k(t,e){if(1&t&&(l.TgZ(0,"ion-row",10),l.TgZ(1,"ion-col",7),l.TgZ(2,"div",11),l._uU(3),l.ALo(4,"date"),l.qZA(),l.qZA(),l.TgZ(5,"ion-col",7),l.TgZ(6,"div",11),l._uU(7),l.ALo(8,"currency"),l.qZA(),l.qZA(),l.TgZ(9,"ion-col",7),l.TgZ(10,"div",11),l._uU(11),l.ALo(12,"currency"),l.qZA(),l.qZA(),l.TgZ(13,"ion-col",7),l.TgZ(14,"div",11),l._uU(15),l.ALo(16,"currency"),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(26,f,e.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.hij(" ",l.xi3(4,5,t.created,"short")," "),l.xp6(4),l.hij(" ",l.G7q(8,8,l.VKq(28,A,t.amountRecharge?t.amountRecharge:0))," "),l.xp6(4),l.hij(" ",l.G7q(12,14,l.VKq(30,A,t.amountWithdrawal?t.amountWithdrawal:0))," "),l.xp6(4),l.hij(" ",l.G7q(16,20,l.VKq(32,A,t.amount))," ")}}function q(t,e){if(1&t&&(l.TgZ(0,"ion-grid"),l.TgZ(1,"ion-row",6),l.TgZ(2,"ion-col",7),l.TgZ(3,"div",8),l._uU(4,"Date"),l.qZA(),l.qZA(),l.TgZ(5,"ion-col",7),l.TgZ(6,"div",8),l._uU(7,"Recharge"),l.qZA(),l.qZA(),l.TgZ(8,"ion-col",7),l.TgZ(9,"div",8),l._uU(10,"Retrait"),l.qZA(),l.qZA(),l.TgZ(11,"ion-col",7),l.TgZ(12,"div",8),l._uU(13,"Solde"),l.qZA(),l.qZA(),l.qZA(),l.YNc(14,k,17,34,"ion-row",9),l.qZA()),2&t){const t=l.oxw();l.xp6(14),l.Q6J("ngForOf",t.balanceList)}}const v=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,s){this.modalController=t,this.saveRandom=e,this.screensizeService=n,this.translateConfigService=i,this.manageSocket=o,this.customerService=s,this.balanceList=[],this.amount=0,this.customer={}}ngOnInit(){this.languageChanged(),this.screenCheck()}ionViewWillEnter(){this.customer=this.saveRandom.getData(),this.getBalanceList(this.customer._id)}screenCheck(){setTimeout(()=>{this.screensizeService.isDesktopView().subscribe(t=>{this.isDesktop=t})},10)}languageChanged(){console.log("lang shop page");let t=localStorage.getItem("language");console.log(t),t&&this.translateConfigService.setLanguage(t)}webServerSocket(){let t=localStorage.getItem("adminId");this.manageSocket.getSocket().subscribe(e=>{e.on(`${t}newBill`,t=>(0,r.mG)(this,void 0,void 0,function*(){this.balanceList.filter(e=>e._id!==t.invoicesId)})),e.on(`${t}newInvoiceChange`,t=>{let e=this.balanceList.findIndex(e=>e._id===t._id);e>=0&&this.balanceList.splice(e,1,t)})})}getBalanceList(t){this.customerService.getCustomerBalance(t).subscribe(t=>{this.balanceList=t,console.log(this.balanceList)})}updateAmount(){let t={};t.amountRecharge=this.amount,t.customerId=this.customer._id,t.recharge=!0,t.amount=this.balanceList.length?this.balanceList[0].amount+this.amount:this.amount,console.log(t),this.customerService.postBalance(t).subscribe(t=>{console.log(t),this.amount=0,this.getBalanceList(this.customer._id)})}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(s.IN),l.Y36(u.i),l.Y36(g.j),l.Y36(h.w),l.Y36(d.W),l.Y36(b))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-store-customer-balance"]],decls:12,vars:3,consts:[["slot","start"],["defaultHref","/start"],["position","floating"],["type","number",3,"ngModel","ngModelChange"],["color","danger","size","large","expand","block",3,"disabled","click"],[4,"ngIf"],[1,"header-component"],["size-sm","3","size-md","3","size-lg","3"],[1,"ion-text-center"],["class","data-row data-update","style","font-size: 12px",3,"ngStyle",4,"ngFor","ngForOf"],[1,"data-row","data-update",2,"font-size","12px",3,"ngStyle"],[1,"ion-text-center","ion-text-uppercase","smallSize"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l._UZ(3,"ion-back-button",1),l.qZA(),l.qZA(),l.qZA(),l.TgZ(4,"ion-content"),l.TgZ(5,"ion-item"),l.TgZ(6,"ion-label",2),l._uU(7,"ID Number"),l.qZA(),l.TgZ(8,"ion-input",3),l.NdJ("ngModelChange",function(t){return e.amount=t}),l.qZA(),l.qZA(),l.TgZ(9,"ion-button",4),l.NdJ("click",function(){return e.updateAmount()}),l._uU(10,"Register"),l.qZA(),l.YNc(11,q,15,1,"ion-grid",5),l.qZA()),2&t&&(l.xp6(8),l.Q6J("ngModel",e.amount),l.xp6(1),l.Q6J("disabled",!e.amount),l.xp6(2),l.Q6J("ngIf",e.balanceList.length))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.W2,s.Ie,s.Q$,s.pK,s.as,o.JJ,o.On,s.YG,i.O5,s.jY,s.Nd,s.wI,i.sg,i.PC],pipes:[i.uU,i.H9],styles:[""]}),t})()}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[a.Bz.forChild(v),c.aw.forChild()],a.Bz]}),t})(),T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.ez,o.u5,s.Pc,S]]}),t})()},4418:(t,e,n)=>{"use strict";n.d(e,{W:()=>r});var i=n(1344),o=n.n(i),s=n(8512),a=n(1572),c=n(2968);let r=(()=>{class t{constructor(t){this.urlService=t,this.mysocket=new s.X(null),this.sock=!1,this.takeUrl()}takeUrl(){console.log("je demmare ici url"),this.urlService.getUrl().subscribe(t=>{this.url=t,this.adminId=localStorage.getItem("adminId"),this.sockets=o()(this.url),this.mysocket.next(this.sockets)})}getSocket(){return this.mysocket}disconnectSocket(){this.sockets.disconnect()}getMySocket(){return this.sockets}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(c.i))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);