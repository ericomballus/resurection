(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[2413],{2413:(e,o,n)=>{"use strict";n.r(o),n.d(o,{DisplayBonusCustomerPageModule:()=>b});var t=n(1511),i=n(6073),s=n(8158),r=n(8777),l=n(1572),c=n(5511),d=n(2874),a=n(5946),g=n(4375),u=n(3764);function m(e,o){if(1&e&&(l.TgZ(0,"ion-col",17),l.TgZ(1,"pre"),l._uU(2),l.qZA(),l.qZA()),2&e){const e=l.oxw();l.xp6(2),l.lnq("",e.model.day,"/",e.model.month,"/",e.model.year,"")}}function Z(e,o){if(1&e&&(l.TgZ(0,"ion-col",17),l.TgZ(1,"pre"),l._uU(2),l.qZA(),l.qZA()),2&e){const e=l.oxw();l.xp6(2),l.lnq("",e.model2.day,"/",e.model2.month,"/",e.model2.year,"")}}function h(e,o){if(1&e){const e=l.EpF();l.TgZ(0,"ion-col",18),l.TgZ(1,"div",19),l.TgZ(2,"ion-button",20),l.NdJ("click",function(){return l.CHM(e),l.oxw().takeInventory()}),l._uU(3," submit"),l.qZA(),l.qZA(),l.qZA()}}const f=function(e){return{"background-color":e}};function p(e,o){if(1&e&&(l.TgZ(0,"ion-row",27),l.TgZ(1,"ion-col",24),l.TgZ(2,"div",23),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"ion-col",24),l.TgZ(5,"div",23),l._uU(6),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",24),l.TgZ(8,"div",23),l._uU(9),l.qZA(),l.qZA(),l.qZA()),2&e){const e=o.$implicit;l.Q6J("ngStyle",l.VKq(4,f,o.index%2==0?"#f1f1f1":"white")),l.xp6(3),l.hij(" ",e.client.name?e.client.name:"no Name"," "),l.xp6(3),l.hij(" ",e.data?e.data.length:""," "),l.xp6(3),l.hij(" ",e.bonus?e.bonus:0," ")}}function T(e,o){if(1&e&&(l.TgZ(0,"div"),l.TgZ(1,"ion-row",21),l.TgZ(2,"ion-col",22),l.TgZ(3,"div",23),l._uU(4,"Nom"),l.qZA(),l.qZA(),l.TgZ(5,"ion-col",24),l.TgZ(6,"div",23),l._uU(7,"facture"),l.qZA(),l.qZA(),l.TgZ(8,"ion-col",24),l.TgZ(9,"div",23),l._uU(10,"sv"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"ion-row"),l._UZ(12,"ion-col",25),l.qZA(),l.YNc(13,p,10,6,"ion-row",26),l.qZA()),2&e){const e=l.oxw();l.xp6(13),l.Q6J("ngForOf",e.bonusTab)}}const y=function(){return{padding:"15px"}},A=[{path:"",component:(()=>{class e{constructor(e,o,n,t,i){this.calendar=e,this.notif=o,this.adminService=n,this.saveRandom=t,this.groupByService=i,this.customerList=[],this.bonusTab=[]}ngOnInit(){this.model=this.calendar.getToday(),this.model2=this.calendar.getToday(),this.customerList=this.saveRandom.getCustomerList(),console.log(this.customerList)}takeInventory(){let e,o,n;if(n=`${this.model.year.toString()}`,this.model.day.toString(),e=`${this.model.day+1}`,this.model.month.toString(),o=`${this.model.month}`,new Date(this.model.year,this.model.month,this.model.day).getTime()>new Date(this.model2.year,this.model2.month,this.model2.day).getTime())console.log("impossible"),this.notif.presentError("Sorry, the start date must be less than the end date","danger");else{let e={};e.start=new Date(this.model.year,this.model.month-1,this.model.day+1).toISOString(),e.end=new Date(this.model2.year,this.model2.month-1,this.model2.day+1).toISOString(),e.start==e.end&&(e.start=new Date(this.model.year,this.model.month-1,this.model.day).toISOString()),console.log(e),this.adminService.getInvoiceBonus(e).subscribe(e=>{this.groupByService.groupByCustomerId(e.docs).then(e=>{console.log(e),this.bonusTab=[],e.forEach(e=>{let o=e[0].customerId,n=this.customerList.find(e=>e._id==o);if(n){let o=0;e.forEach(e=>{e.commandes.forEach(e=>{e.products.forEach(e=>{o=e.item.bonus+o})})}),this.bonusTab.push({client:n,data:e,bonus:o}),console.log(this.bonusTab)}})})})}}}return e.\u0275fac=function(o){return new(o||e)(l.Y36(c.vL),l.Y36(d.g),l.Y36(a.l),l.Y36(g.i),l.Y36(u.n))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-display-bonus-customer"]],decls:32,vars:8,consts:[["slot","start"],["defaultHref","/start"],[3,"ngStyle"],["size","3"],[1,"form-inline"],[1,"form-group"],[1,"input-group"],["placeholder","yyyy-mm-dd","name","dp","ngbDatepicker","",1,"form-control",2,"display","none",3,"ngModel","ngModelChange"],["d","ngbDatepicker"],[1,"input-group-append"],["fill","clear","size","small","type","button",1,"btn","btn-outline-secondary","calendar",3,"click"],["name","calendar"],["size","3","class","ion-padding ion-align-self-center",4,"ngIf"],["d2","ngbDatepicker"],[1,"ion-align-items-center"],["class","ion-align-self-center",4,"ngIf"],[4,"ngIf"],["size","3",1,"ion-padding","ion-align-self-center"],[1,"ion-align-self-center"],[1,"ion-text-center"],["size","small",3,"click"],[1,"row-header"],["size-sm","3","size-md","4","size-xm","4","size-lg","4",1,"ion-align-self-center"],[1,"ion-text-center","ion-text-uppercase","taille"],["size-sm","4","size-md","4","size-xm","4","size-lg","4",1,"ion-align-self-center"],["size-sm","12","size-md","12","size-xm","12","size-lg","12",1,"ion-align-self-center"],["color","primary",3,"ngStyle",4,"ngFor","ngForOf"],["color","primary",3,"ngStyle"]],template:function(e,o){if(1&e){const e=l.EpF();l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l._UZ(3,"ion-back-button",1),l.qZA(),l.qZA(),l.qZA(),l.TgZ(4,"ion-content"),l.TgZ(5,"div",2),l.TgZ(6,"ion-row"),l.TgZ(7,"ion-col",3),l.TgZ(8,"form",4),l.TgZ(9,"div",5),l.TgZ(10,"div",6),l.TgZ(11,"input",7,8),l.NdJ("ngModelChange",function(e){return o.model=e}),l.qZA(),l.TgZ(13,"div",9),l.TgZ(14,"ion-button",10),l.NdJ("click",function(){return l.CHM(e),l.MAs(12).toggle()}),l._uU(15,"start "),l._UZ(16,"ion-icon",11),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.YNc(17,m,3,3,"ion-col",12),l.YNc(18,Z,3,3,"ion-col",12),l.TgZ(19,"ion-col",3),l.TgZ(20,"form",4),l.TgZ(21,"div",5),l.TgZ(22,"div",6),l.TgZ(23,"input",7,13),l.NdJ("ngModelChange",function(e){return o.model2=e}),l.qZA(),l.TgZ(25,"div",9),l.TgZ(26,"ion-button",10),l.NdJ("click",function(){return l.CHM(e),l.MAs(24).toggle()}),l._uU(27,"End "),l._UZ(28,"ion-icon",11),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(29,"ion-row",14),l.YNc(30,h,4,0,"ion-col",15),l.qZA(),l.qZA(),l.YNc(31,T,14,1,"div",16),l.qZA()}2&e&&(l.xp6(5),l.Q6J("ngStyle",l.DdM(7,y)),l.xp6(6),l.Q6J("ngModel",o.model),l.xp6(6),l.Q6J("ngIf",o.model),l.xp6(1),l.Q6J("ngIf",o.model2),l.xp6(5),l.Q6J("ngModel",o.model2),l.xp6(7),l.Q6J("ngIf",o.model&&o.model2),l.xp6(1),l.Q6J("ngIf",o.bonusTab.length))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.W2,t.PC,s.Nd,s.wI,i.Y7,i.JL,i.F,c.J4,i.Fj,i.JJ,i.On,s.YG,s.gu,t.O5,t.sg],styles:[""]}),e})()}];let q=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[r.Bz.forChild(A)],r.Bz]}),e})(),b=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[t.ez,i.u5,s.Pc,q,c.IJ]]}),e})()},3764:(e,o,n)=>{"use strict";n.d(o,{n:()=>s});var t=n(1572),i=n(2874);let s=(()=>{class e{constructor(e){this.notifi=e}groupArticles(e,o){return new Promise((n,t)=>{o&&this.notifi.presentLoading();let i=[],s=e.reduce((e,o)=>(e[o.categoryName]=[...e[o.categoryName]||[],o],e),{});for(const e in s)i.push(s[e]);o&&this.notifi.dismissLoading(),n(i)})}groupByCustomerId(e){return new Promise((o,n)=>{let t=[],i=e.reduce((e,o)=>(e[o.customerId]=[...e[o.customerId]||[],o],e),{});for(const e in i)t.push(i[e]);o(t)})}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(i.g))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);