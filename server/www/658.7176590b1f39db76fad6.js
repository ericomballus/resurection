(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[658],{2157:(e,t,i)=>{"use strict";i.d(t,{w:()=>x});var o=i(4762),n=i(2034),s=i(3685),r=i(1572),a=i(8158),c=i(2874),l=i(1714),m=i(529),d=i(9063),g=i(2968);let u=(()=>{class e{constructor(e,t){this.http=e,this.urlService=t,this.userName="unknown",this.url="http://192.168.100.10:3000/",this.takeUrl()}takeUrl(){m.N.production?this.urlService.getUrl().subscribe(e=>{this.url=e}):this.url=m.V}postImages(e){return new Promise((t,i)=>{let o=localStorage.getItem("adminId");this.http.post(`${this.url}images/?db=${o}`,e).subscribe(e=>{t(e.url)},e=>{i(e)})})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(d.eN),r.LFG(g.i))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=i(4375),p=i(1511),f=i(6073),Z=i(1064);const T=["fileButton"];function v(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-button",18),r.NdJ("click",function(){return r.CHM(e),r.oxw().galerie()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"MENU.changeimage")," "))}function A(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-button",19),r.NdJ("click",function(){return r.CHM(e),r.oxw().galerie()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"MENU.addimage")," "))}function b(e,t){if(1&e&&(r.TgZ(0,"ion-card"),r._UZ(1,"img",20),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("src",e.gamme.url,r.LSH)}}function q(e,t){if(1&e&&(r.TgZ(0,"ion-select-option",23),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.s9C("value",e.id),r.xp6(1),r.Oqu(e.name)}}function L(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"ion-select",21),r.NdJ("ionChange",function(t){return r.CHM(e),r.oxw().assignStore(t)}),r.YNc(5,q,2,2,"ion-select-option",22),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,2,"MENU.store")),r.xp6(3),r.Q6J("ngForOf",e.userStore)}}const S=function(e){return{"background-color":e}};function k(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-row",24,25),r.TgZ(2,"ion-col",13),r.TgZ(3,"div",14),r._uU(4),r.qZA(),r.qZA(),r.TgZ(5,"ion-col",13),r.TgZ(6,"div",14),r._uU(7),r.qZA(),r.qZA(),r.TgZ(8,"ion-col",15),r.TgZ(9,"div",14),r.TgZ(10,"ion-input",26),r.NdJ("ionChange",function(i){r.CHM(e);const o=t.$implicit,n=t.index;return r.oxw().addQuantity(i,o,n)}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(11,"ion-col",15),r.TgZ(12,"div",14),r.TgZ(13,"ion-button",27),r.NdJ("click",function(){r.CHM(e);const i=t.$implicit;return r.oxw().remove(i)}),r._UZ(14,"ion-icon",28),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("ngStyle",r.VKq(4,S,t.index%2==0?"#f1f1f1":"white")),r.xp6(4),r.Oqu(e.name),r.xp6(3),r.Oqu(e.sellingPrice),r.xp6(3),r.s9C("placeholder",e.toRemove)}}let x=(()=>{class e{constructor(e,t,i,o,n,s,r){this.modalController=e,this.toastController=t,this.loadingController=i,this.notifi=o,this.gammeService=n,this.imageService=s,this.random=r,this.url=!1}ngOnInit(){let e=this.gammeService.getGamme();this.gamme=new n.R(e.name,e.productList,e.sellingPrice,e._id,e.created),e.url&&(this.gamme.url=e.url),e.newUrl&&(this.gamme.newUrl=e.newUrl),this.gamme.productType=e.productType,this.gamme.desabled=e.desabled,localStorage.setItem("oldGamme",JSON.stringify(e));let t=JSON.parse(localStorage.getItem("user"));this.userStore=t[0].storeId,this.gamme.storeId=e.storeId}update(){return(0,o.mG)(this,void 0,void 0,function*(){if(this.notifi.presentLoading(),this.gamme.productType="Gamme",this.storeId&&(this.gamme.storeId=this.storeId),this.url){var e=new FormData;e.append("image",this.file),this.imageService.postImages(e).then(e=>{this.gamme.newUrl=e,this.gammeService.updateGamme(this.gamme).subscribe(e=>{this.notifi.dismissLoading(),this.notifi.presentToast("update successfuly!!","primary"),this.modalController.dismiss()})}).catch(e=>{console.log(e)})}else delete this.gamme.url,delete this.gamme.newUrl,this.gammeService.updateGamme(this.gamme).subscribe(e=>{this.notifi.dismissLoading(),this.notifi.presentToast("update successfuly!!","primary"),this.modalController.dismiss()})})}closeModal(){localStorage.removeItem("oldGamme"),console.log("je sors ici",this.gammeService.getGamme()),this.modalController.dismiss({cancel:!0})}pickResource(){return(0,o.mG)(this,void 0,void 0,function*(){this.gammeService.setGamme(this.gamme),this.random.setStoreId(this.gamme.storeId);const e=yield this.modalController.create({component:s.E,componentProps:{},backdropDismiss:!1});return e.onDidDismiss().then(e=>{e.data&&1==e.data.cancel?(this.gamme.productList=[],this.gamme.productList=JSON.parse(localStorage.getItem("oldGamme")).productList,this.gammeService.setGamme(this.gamme)):this.gamme=this.gammeService.getGamme()}),yield e.present()})}remove(e){this.gamme.removeToProductList(e)}addQuantity(e,t,i){let o=parseInt(e.detail.value);console.log(Number.isNaN(o)),this.gamme.productList[i].toRemove=Number.isNaN(o)?1:o,console.log(this.gamme.productList)}readUrl(e){if(this.file=e.target.files[0],console.log(this.file),e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=e=>{this.gamme.url=e.target.result,this.url=!0},t.readAsDataURL(e.target.files[0])}}galerie(){this.fileButton.nativeElement.click()}assignStore(e){return(0,o.mG)(this,void 0,void 0,function*(){console.log(e.target.value),this.storeId=e.target.value})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(a.IN),r.Y36(a.yF),r.Y36(a.HT),r.Y36(c.g),r.Y36(l.K),r.Y36(u),r.Y36(h.i))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-gamme-update"]],viewQuery:function(e,t){if(1&e&&r.Gf(T,1),2&e){let e;r.iGM(e=r.CRH())&&(t.fileButton=e.first)}},decls:48,vars:22,consts:[["slot","end"],["color","primary","fill","outline","style","font-size: 8px","size","small",3,"click",4,"ngIf"],["color","primary","fill","outline","style","font-size: 10px","size","small",3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","close"],["type","file",1,"filebtn",3,"change"],["fileButton",""],[4,"ngIf"],["type","text","placeholder","Name",3,"ngModel","ngModelChange"],["type","number","placeholder","prix de vente",3,"ngModel","ngModelChange"],["button","",3,"click"],["slot","end","name","add-circle-outline"],[1,"header-row"],["size","4",1,"ion-align-self-center"],[1,"ion-text-center"],["size","2",1,"ion-align-self-center"],["class","data-row data-update",3,"ngStyle",4,"ngFor","ngForOf"],["color","danger","size","large","expand","block",3,"click"],["color","primary","fill","outline","size","small",2,"font-size","8px",3,"click"],["color","primary","fill","outline","size","small",2,"font-size","10px",3,"click"],[3,"src"],["cancelText","cancel","okText","Okay","interface","popover",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"data-row","data-update",3,"ngStyle"],["itemlist",""],["debounce","500","type","number",3,"placeholder","ionChange"],["color","danger","size","small",3,"click"],["slot","icon-only","name","trash"]],template:function(e,t){1&e&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r._UZ(2,"ion-title"),r.TgZ(3,"ion-buttons",0),r.YNc(4,v,3,3,"ion-button",1),r.YNc(5,A,3,3,"ion-button",2),r.TgZ(6,"ion-button",3),r.NdJ("click",function(){return t.closeModal()}),r._UZ(7,"ion-icon",4),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"ion-content"),r.TgZ(9,"input",5,6),r.NdJ("change",function(e){return t.readUrl(e)}),r.qZA(),r.YNc(11,b,2,1,"ion-card",7),r.TgZ(12,"ion-grid"),r.TgZ(13,"ion-row"),r.TgZ(14,"ion-col"),r.TgZ(15,"div"),r.TgZ(16,"ion-item"),r.TgZ(17,"ion-input",8),r.NdJ("ngModelChange",function(e){return t.gamme.name=e}),r.qZA(),r.qZA(),r.TgZ(18,"ion-item"),r.TgZ(19,"ion-input",9),r.NdJ("ngModelChange",function(e){return t.gamme.sellingPrice=e}),r.qZA(),r.qZA(),r.YNc(20,L,6,4,"ion-item",7),r.TgZ(21,"ion-item",10),r.NdJ("click",function(){return t.pickResource()}),r._UZ(22,"ion-icon",11),r.TgZ(23,"ion-label"),r._uU(24),r.ALo(25,"translate"),r.qZA(),r.qZA(),r.TgZ(26,"ion-row",12),r.TgZ(27,"ion-col",13),r.TgZ(28,"div",14),r._uU(29),r.ALo(30,"translate"),r.qZA(),r.qZA(),r.TgZ(31,"ion-col",13),r.TgZ(32,"div",14),r._uU(33),r.ALo(34,"translate"),r.qZA(),r.qZA(),r.TgZ(35,"ion-col",15),r.TgZ(36,"div",14),r._uU(37),r.ALo(38,"translate"),r.qZA(),r.qZA(),r.TgZ(39,"ion-col",15),r._UZ(40,"div",14),r.qZA(),r.qZA(),r.YNc(41,k,15,6,"ion-row",16),r.qZA(),r.qZA(),r.qZA(),r.TgZ(42,"ion-row"),r.TgZ(43,"ion-col"),r.TgZ(44,"div",14),r.TgZ(45,"ion-button",17),r.NdJ("click",function(){return t.update()}),r._uU(46),r.ALo(47,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Q6J("ngIf",t.gamme.url),r.xp6(1),r.Q6J("ngIf",!t.gamme.url),r.xp6(6),r.Q6J("ngIf",t.gamme.url),r.xp6(6),r.Q6J("ngModel",t.gamme.name),r.xp6(2),r.Q6J("ngModel",t.gamme.sellingPrice),r.xp6(1),r.Q6J("ngIf",t.userStore.length>1),r.xp6(4),r.Oqu(r.lcZ(25,12,"MENU.products")),r.xp6(5),r.Oqu(r.lcZ(30,14,"MENU.name")),r.xp6(4),r.Oqu(r.lcZ(34,16,"MENU.price")),r.xp6(4),r.hij(" ",r.lcZ(38,18,"MENU.quantity")," "),r.xp6(4),r.Q6J("ngForOf",t.gamme.productList),r.xp6(5),r.Oqu(r.lcZ(47,20,"MENU.save")))},directives:[a.Gu,a.sr,a.wd,a.Sm,p.O5,a.YG,a.gu,a.W2,a.jY,a.Nd,a.wI,a.Ie,a.pK,a.j9,f.JJ,f.On,a.as,a.Q$,p.sg,a.PM,a.t9,a.QI,a.n0,p.PC],pipes:[Z.X$],styles:[".filebtn[_ngcontent-%COMP%]{opacity:0;position:absolute;top:-100em;left:-100em}.filebtn[_ngcontent-%COMP%], .uploadBtn[_ngcontent-%COMP%]{display:none}"]}),e})()},658:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GammePageModule:()=>x});var o=i(1511),n=i(6073),s=i(8158),r=i(8777),a=i(4762),c=i(2157),l=i(1572),m=i(1714),d=i(4144),g=i(4418),u=i(2874),h=i(4375),p=i(9719),f=i(731),Z=i(1064);function T(e,t){if(1&e&&(l.TgZ(0,"ion-avatar",3),l._UZ(1,"ion-img",14),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.Q6J("src",e.url)}}function v(e,t){if(1&e&&(l.TgZ(0,"ion-select-option",17),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.hij(" ",e.name," ")}}function A(e,t){if(1&e&&(l.TgZ(0,"div"),l.TgZ(1,"ion-select",15),l.YNc(2,v,2,1,"ion-select-option",16),l.qZA(),l.qZA()),2&e){const e=l.oxw(4);l.xp6(2),l.Q6J("ngForOf",e.storeList)}}function b(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"ion-item"),l.YNc(1,T,2,1,"ion-avatar",9),l.TgZ(2,"ion-label"),l.TgZ(3,"p",10),l._uU(4),l.qZA(),l.TgZ(5,"p"),l._uU(6),l.qZA(),l.qZA(),l.TgZ(7,"div"),l.TgZ(8,"div"),l.TgZ(9,"ion-button",11),l.NdJ("click",function(){l.CHM(e);const i=t.$implicit;return l.oxw(3).updateGamme(i)}),l._uU(10),l.ALo(11,"translate"),l.qZA(),l.TgZ(12,"ion-button",11),l.NdJ("click",function(){l.CHM(e);const i=t.$implicit;return l.oxw(3).TransferOne(i)}),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.TgZ(15,"ion-button",12),l.NdJ("click",function(){l.CHM(e);const i=t.$implicit;return l.oxw(3).deleteGamme(i)}),l._UZ(16,"ion-icon",13),l.qZA(),l.qZA(),l.YNc(17,A,3,1,"div",8),l.qZA(),l.qZA()}if(2&e){const e=t.$implicit;l.xp6(1),l.Q6J("ngIf",e.url),l.xp6(3),l.Oqu(e.name),l.xp6(2),l.hij("Price: ",e.sellingPrice,""),l.xp6(4),l.hij(" ",l.lcZ(11,6,"MENU.modify")," "),l.xp6(3),l.hij(" ",l.lcZ(14,8,"MENU.transfer")," "),l.xp6(4),l.Q6J("ngIf",e.open)}}function q(e,t){if(1&e&&(l.TgZ(0,"ion-list"),l.TgZ(1,"ion-list-header"),l._uU(2," ALL "),l.qZA(),l.YNc(3,b,18,10,"ion-item",6),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(3),l.Q6J("ngForOf",e)}}function L(e,t){if(1&e&&(l.TgZ(0,"ion-slide"),l.TgZ(1,"ion-grid"),l.TgZ(2,"ion-row"),l.TgZ(3,"ion-col"),l.TgZ(4,"div",7),l.TgZ(5,"h4"),l._uU(6),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.YNc(7,q,4,1,"ion-list",8),l.qZA(),l.qZA()),2&e){const e=t.$implicit,i=l.oxw();l.xp6(6),l.Oqu(e.storeName?e.storeName:"no name"),l.xp6(1),l.Q6J("ngIf",i.gammeList.length)}}const S=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,s,r,a,c){this.gammeService=e,this.router=t,this.modalController=i,this.resApi=o,this.manageSocket=n,this.notifi=s,this.saveRandom=r,this.getStoreName=a,this.translateConfigService=c,this.gammeList=[],this.storeList=[],this.desactive=!0,this.multiStoreGamme=[],this.randomObj={},this.products=[]}ngOnInit(){this.takeGammeList(),this.takeBillardList(),this.webServerSocket(),this.storeList=this.saveRandom.getStoreList();let e=JSON.parse(localStorage.getItem("user"))[0];this.storeList=e.storeId,console.log(this.storeList)}ionViewWillEnter(){}webServerSocket(){let e=localStorage.getItem("adminId");this.manageSocket.getSocket().subscribe(t=>{t.on(`${e}newGamme`,e=>{this.gammeList.push(e)}),t.on(`${e}gammeUpdate`,e=>{console.log("update here",e);let t=this.gammeList.findIndex(t=>t._id==e._id);t>=0&&this.gammeList.splice(t,1,e)})})}addGamme(){this.router.navigateByUrl("gamme/gamme-add")}takeGammeList(){this.gammeService.getGammeList().subscribe(e=>{console.log(e),this.gammeList=e,this.rangeProductByStore()})}takeBillardList(){this.resApi.getBillardList().subscribe(e=>{this.gammeService.setProducts(e.product)})}updateGamme(e){return(0,a.mG)(this,void 0,void 0,function*(){this.gammeService.setGamme(e);const t=yield this.modalController.create({component:c.w,componentProps:{},backdropDismiss:!1});return t.onDidDismiss().then(t=>{if(t.data&&1==t.data.cancel){e=this.gammeService.getGamme(),console.log(e);let t=this.gammeList.findIndex(t=>t._id==e._id);t>=0&&(this.gammeList.splice(t,1,e),this.rangeProductByStore())}}),yield t.present()})}deleteGamme(e){this.notifi.dismissLoading(),this.gammeService.deleteOneGamme(e).subscribe(t=>{this.notifi.dismissLoading(),this.notifi.presentToast("succesffuly","primary"),this.gammeList=this.gammeList.filter(t=>t._id!=e._id),this.rangeProductByStore()})}addToAllStore(){this.notifi.presentLoading(),console.log(this.storeList),this.storeList.forEach(e=>{this.gammeList.forEach(t=>{t.storeId!==e.id&&(t.storeId=e.id,this.buildGamme(t,e))})}),this.notifi.dismissLoading(),setTimeout(()=>{this.takeGammeList()},3e3)}TransferOne(e){this.storeList.forEach(t=>{t.id==e.storeId||this.buildGamme(e,t)})}buildGamme(e,t){return(0,a.mG)(this,void 0,void 0,function*(){this.notifi.presentLoading();let i=[];0==e.filename.length&&(e.filename=`${(new Date).getTime()}`,e.originalname=`${(new Date).getTime()}`);try{i=yield this.findProductLIst(e.productList,t),i.length==e.productList.length&&this.gammeService.transfertGamme({adminId:e.adminId,name:e.name,sellingPrice:e.sellingPrice,storeId:t.id,url:e.url,filename:e.filename,originalname:e.originalname,productList:i}).subscribe(e=>{this.notifi.presentToast("gamme created !","primary"),this.notifi.dismissLoading(),setTimeout(()=>{this.takeGammeList()},3e3)})}catch(o){this.notifi.dismissLoading(),this.notifi.presentToast("some error found please try against","danger")}})}rangeProductByStore(){let e=this.gammeList.reduce((e,t)=>(e[t.storeId]=[...e[t.storeId]||[],t],e),{});this.multiStoreGamme=[],this.randomObj=e;for(const t in e)this.multiStoreGamme.push(e[t]);this.multiStoreGamme.length>1&&(this.desactive=!1),this.multiStoreGamme.forEach(e=>(0,a.mG)(this,void 0,void 0,function*(){let t=yield this.getStoreName.takeName(e);e.storeName=t}))}addToStore(e){e.open=!0,console.log(e)}selectStore(e,t){t.open=!1,console.log(e)}findProductLIst(e,t){return new Promise((i,o)=>{let n=[];this.products=this.gammeService.getProducts(),e.forEach(o=>(0,a.mG)(this,void 0,void 0,function*(){try{let t=yield this.chercherProduit(o);n.push(t),n.length==e.length&&i(n)}catch(s){let r=yield this.buildProduct(o,t);n.push(r),n.length==e.length&&i(n)}}))})}chercherProduit(e){return new Promise((e,t)=>{this.products=this.gammeService.getProducts();let i=this.products.find(e=>{});i?e(i):t(!1)})}buildProduct(e,t){return new Promise((i,o)=>{this.resApi.transferBillardGame({adminId:e.adminId,name:e.name,sellingPrice:e.sellingPrice,purchasingPrice:e.purchasingPrice,categoryName:e.categoryName,categoryId:e.categoryId,superCategory:e.superCategory,storeId:t.id,url:e.url,filename:e.filename,originalname:e.originalname}).subscribe(e=>{console.log("result",e),i(e.data)},e=>{console.log(e),o(!1)})})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(m.K),l.Y36(r.F0),l.Y36(s.IN),l.Y36(d.e),l.Y36(g.W),l.Y36(u.g),l.Y36(h.i),l.Y36(p.$),l.Y36(f.w))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-gamme"]],decls:11,vars:1,consts:[["slot","end"],[3,"click"],["slot","icon-only","name","add"],["slot","start"],["autoHide","false"],["pager","true"],[4,"ngFor","ngForOf"],[1,"ion-text-center","ion-text-uppercase"],[4,"ngIf"],["slot","start",4,"ngIf"],[1,"p1"],["color","primary","slot","end","small","",3,"click"],["color","danger","slot","end","small","",3,"click"],["slot","icon-only","name","trash"],[3,"src"],["cancel-text","cancelar"],["value","store",4,"ngFor","ngForOf"],["value","store"]],template:function(e,t){1&e&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l._UZ(2,"ion-title"),l.TgZ(3,"ion-buttons",0),l.TgZ(4,"ion-button",1),l.NdJ("click",function(){return t.addGamme()}),l._UZ(5,"ion-icon",2),l.qZA(),l.qZA(),l.TgZ(6,"ion-buttons",3),l._UZ(7,"ion-menu-button",4),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"ion-content"),l.TgZ(9,"ion-slides",5),l.YNc(10,L,8,2,"ion-slide",6),l.qZA(),l.qZA()),2&e&&(l.xp6(10),l.Q6J("ngForOf",t.multiStoreGamme))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.YG,s.gu,s.fG,s.W2,s.Hr,o.sg,s.A$,s.jY,s.Nd,s.wI,o.O5,s.q_,s.yh,s.Ie,s.Q$,s.BJ,s.Xz,s.t9,s.QI,s.n0],pipes:[Z.X$],styles:["ion-button[_ngcontent-%COMP%]{margin:5px}p[_ngcontent-%COMP%]{text-transform:uppercase}"]}),e})()},{path:"gamme-add",loadChildren:()=>i.e(9205).then(i.bind(i,9205)).then(e=>e.GammeAddPageModule)},{path:"gamme-update",loadChildren:()=>i.e(445).then(i.bind(i,445)).then(e=>e.GammeUpdatePageModule)},{path:"product-for-gamme",loadChildren:()=>i.e(7015).then(i.bind(i,7015)).then(e=>e.ProductForGammePageModule)},{path:"gamme-before-sale",loadChildren:()=>Promise.all([i.e(728),i.e(345)]).then(i.bind(i,345)).then(e=>e.GammeBeforeSalePageModule)}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[r.Bz.forChild(S)],r.Bz]}),e})(),x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[o.ez,n.u5,s.Pc,k,Z.aw.forChild()]]}),e})()},3685:(e,t,i)=>{"use strict";i.d(t,{E:()=>p});var o=i(4762),n=i(1572),s=i(8158),r=i(731),a=i(1064),c=i(2874),l=i(1714),m=i(4375),d=i(1511);function g(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"ion-checkbox",7),n.NdJ("ionChange",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw().selectProduct(t)}),n.qZA()}}function u(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"ion-checkbox",8),n.NdJ("ionChange",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw().selectProduct(t)}),n.qZA()}}function h(e,t){if(1&e&&(n.TgZ(0,"ion-item"),n.TgZ(1,"ion-label"),n._uU(2),n.qZA(),n.YNc(3,g,1,0,"ion-checkbox",5),n.YNc(4,u,1,0,"ion-checkbox",6),n.qZA()),2&e){const e=t.$implicit;n.xp6(2),n.Oqu(e.name),n.xp6(1),n.Q6J("ngIf",e.isChecked),n.xp6(1),n.Q6J("ngIf",!e.isChecked)}}let p=(()=>{class e{constructor(e,t,i,o,n,s,r){this.modalController=e,this.translateConfigService=t,this.translate=i,this.notification=o,this.gammeService=n,this.notifi=s,this.random=r}ngOnInit(){return(0,o.mG)(this,void 0,void 0,function*(){let e=this.gammeService.getProducts(),t=this.random.getStoreId();console.log("storeId here",t),e&&e.length?(console.log("liste take",e),this.productTab=e):(this.notifi.presentLoading(),yield this.gammeService.getProductService(),this.productTab=this.gammeService.getProducts(),this.notifi.dismissLoading()),this.productTab=this.productTab.filter(e=>e.storeId==t),this.productTab=this.productTab.sort((e,t)=>e.name>t.name?1:-1),this.product=this.gammeService.getGamme(),this.productClone=this.gammeService.getGamme().productList,this.checkIfSelect()})}closeModal(){this.notification.presentLoading(),this.product.productList=this.productClone,this.productTab.forEach(e=>{e.isChecked=!1}),this.notification.dismissLoading(),this.modalController.dismiss({cancel:!0})}saveAndCloseModal(){this.notification.presentLoading(),this.gammeService.setGamme(this.product),this.productTab.forEach(e=>{e.isChecked=!1}),this.notification.dismissLoading(),this.modalController.dismiss()}selectProduct(e){e.isChecked?(e.isChecked=!1,this.product.removeToProductList(e),this.gammeService.removeToProducList(e)):(e.isChecked=!0,e.toRemove=1,this.product.addToProductList(e),this.gammeService.saveToAddProductList(e))}checkIfSelect(){this.product.productList.length?(this.product.productList.forEach(e=>{this.productTab.forEach(t=>{t._id==e._id&&(t.isChecked=!0)})}),this.productTab.forEach(e=>{e.isChecked||(e.isChecked=!1)})):this.productTab.forEach(e=>{e.isChecked=!1})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(s.IN),n.Y36(r.w),n.Y36(a.sK),n.Y36(c.g),n.Y36(l.K),n.Y36(c.g),n.Y36(m.i))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-product-for-gamme"]],decls:14,vars:7,consts:[["slot","end"],["size","small","fill","outline","color","primary",3,"click"],["size","small","fill","outline","color","danger",3,"click"],["slot","icon-only","name","close"],[4,"ngFor","ngForOf"],["checked","true","slot","end",3,"ionChange",4,"ngIf"],["slot","end",3,"ionChange",4,"ngIf"],["checked","true","slot","end",3,"ionChange"],["slot","end",3,"ionChange"]],template:function(e,t){1&e&&(n.TgZ(0,"ion-header"),n.TgZ(1,"ion-toolbar"),n._UZ(2,"ion-title"),n.TgZ(3,"ion-buttons",0),n.TgZ(4,"ion-button",1),n.NdJ("click",function(){return t.saveAndCloseModal()}),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.TgZ(7,"ion-button",2),n.NdJ("click",function(){return t.closeModal()}),n._uU(8),n.ALo(9,"translate"),n._UZ(10,"ion-icon",3),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(11,"ion-content"),n.TgZ(12,"ion-list"),n.YNc(13,h,5,3,"ion-item",4),n.qZA(),n.qZA()),2&e&&(n.xp6(5),n.hij(" ",n.lcZ(6,3,"MENU.save")," "),n.xp6(3),n.hij(" ",n.lcZ(9,5,"MENU.cancel")," "),n.xp6(5),n.Q6J("ngForOf",t.productTab))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.YG,s.gu,s.W2,s.q_,d.sg,s.Ie,s.Q$,d.O5,s.nz,s.w],pipes:[a.X$],styles:[""]}),e})()},2034:(e,t,i)=>{"use strict";i.d(t,{R:()=>o});class o{constructor(e,t,i,o,n){this.removeProductList=[],this.addProductList=[],this._id="",this.desabled=!1,this.nbr=0,this.quantityToSale=1,this.productType="Gamme",this.url=" ",this.originalname="",this.filename="",this.newUrl="",this.remove=!1,this.nbrRandom=0,this.name=e,this.productList=t,this.sellingPrice=i,this._id=o,this.adminId=localStorage.getItem("adminId"),this.created=n||Date.now()}addToProductList(e){this.productList.find(t=>t._id==e._id)?console.log("existe deja"):(this.productList.push(e),console.log("resultat==>",this.productList))}removeToProductList(e,t){this.productList=this.productList.filter(t=>t._id!==e._id)}getProductList(){return this.productList}}},4418:(e,t,i)=>{"use strict";i.d(t,{W:()=>c});var o=i(1344),n=i.n(o),s=i(8512),r=i(1572),a=i(2968);let c=(()=>{class e{constructor(e){this.urlService=e,this.mysocket=new s.X(null),this.sock=!1,this.takeUrl()}takeUrl(){console.log("je demmare ici url"),this.urlService.getUrl().subscribe(e=>{this.url=e,this.adminId=localStorage.getItem("adminId"),this.sockets=n()(this.url),this.mysocket.next(this.sockets)})}getSocket(){return this.mysocket}disconnectSocket(){this.sockets.disconnect()}getMySocket(){return this.sockets}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(a.i))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);