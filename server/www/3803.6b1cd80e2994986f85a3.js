(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[3803],{3803:(t,e,i)=>{"use strict";i.r(e),i.d(e,{LeaderListPageModule:()=>T});var s=i(1511),o=i(6073),n=i(8158),r=i(8777),c=i(1572),a=i(5946),u=i(2968),l=i(4375),h=i(2874),g=i(4418),d=i(731),m=i(1064),f=i(3764);const p=function(t){return{"background-color":t}};function Z(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-row",7),c.NdJ("click",function(){c.CHM(t);const i=e.$implicit;return c.oxw(2).manageCustumer(i)}),c.TgZ(1,"ion-col",3),c.TgZ(2,"div",4),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"ion-col",3),c.TgZ(5,"div",4),c._uU(6),c.qZA(),c.qZA(),c.TgZ(7,"ion-col",3),c.TgZ(8,"div",4),c._uU(9),c.qZA(),c.qZA(),c.TgZ(10,"ion-col",3),c.TgZ(11,"div",4),c._uU(12),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.Q6J("ngStyle",c.VKq(5,p,e.index%2==0?"#f1f1f1":"white")),c.xp6(3),c.hij(" ",t.name?t.name:"no Name"," "),c.xp6(3),c.hij(" ",t.phone?t.phone:"no phone"," "),c.xp6(3),c.hij(" ",t.ville?t.ville:"no ville"," "),c.xp6(3),c.hij(" ",t.quartier?t.quartier:"no quartier"," ")}}function v(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Z,13,7,"ion-row",6),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.leaderList)}}const b=[{path:"",component:(()=>{class t{constructor(t,e,i,s,o,n,r,c,a,u,l,h){this.modalController=t,this.adminService=e,this.urlService=i,this.actionSheetController=s,this.alertController=o,this.saveRandom=n,this.notifi=r,this.manageSocket=c,this.translateConfigService=a,this.translate=u,this.router=l,this.groupByService=h,this.customerList=[],this.leaderList=[],this.useBonus=!1,this.clients=[],this.tab=[],this.bonusTab=[]}ngOnInit(){this.leaderList=this.saveRandom.getData(),console.log(this.leaderList),this.customerList=this.saveRandom.getCustomerList()}manageCustumer(t){this.notifi.presentLoading(),this.getCustomerInvoices(t._id)}getCustomerInvoices(t){console.log("la list",this.customerList);let e=this.customerList.filter(e=>e.chefEquipe==t);this.clients=[],this.tab=[],this.clients=e,this.clients.length?this.clients.forEach((t,e)=>{this.getInvoice(t._id,e)}):this.notifi.dismissLoading()}getInvoice(t,e){this.adminService.getInvoiceByCustomer(t).subscribe(t=>{this.tab=[...this.tab,...t],this.clients.length-1==e&&(this.groupByService.groupByCustomerId(this.tab),this.groupByService.groupByCustomerId(this.tab).then(t=>{console.log(t),this.bonusTab=[],t.forEach(t=>{let e=t[0].customerId,i=this.customerList.find(t=>t._id==e);if(i){let e=0;t.forEach(t=>{t.commandes.forEach(t=>{t.products.forEach(t=>{e=t.item.bonus+e})})}),this.bonusTab.push({client:i,data:t,bonus:e})}}),this.notifi.dismissLoading(),this.saveRandom.setCustomerInvoices(this.bonusTab),this.router.navigateByUrl("leader-bonus")}))})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(n.IN),c.Y36(a.l),c.Y36(u.i),c.Y36(n.BX),c.Y36(n.Br),c.Y36(l.i),c.Y36(h.g),c.Y36(g.W),c.Y36(d.w),c.Y36(m.sK),c.Y36(r.F0),c.Y36(f.n))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-leader-list"]],decls:19,vars:1,consts:[["slot","start"],["defaultHref","/start"],[1,"row-header"],["size-sm","3","size-md","3","size-xm","3","size-lg","3",1,"ion-align-self-center"],[1,"ion-text-center","ion-text-uppercase","taille"],[4,"ngIf"],["color","primary",3,"ngStyle","click",4,"ngFor","ngForOf"],["color","primary",3,"ngStyle","click"]],template:function(t,e){1&t&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.qZA(),c.qZA(),c.TgZ(4,"ion-content"),c.TgZ(5,"ion-row",2),c.TgZ(6,"ion-col",3),c.TgZ(7,"div",4),c._uU(8,"Nom"),c.qZA(),c.qZA(),c.TgZ(9,"ion-col",3),c.TgZ(10,"div",4),c._uU(11,"phone"),c.qZA(),c.qZA(),c.TgZ(12,"ion-col",3),c.TgZ(13,"div",4),c._uU(14,"ville"),c.qZA(),c.qZA(),c.TgZ(15,"ion-col",3),c.TgZ(16,"div",4),c._uU(17,"quartier"),c.qZA(),c.qZA(),c.qZA(),c.YNc(18,v,2,1,"div",5),c.qZA()),2&t&&(c.xp6(18),c.Q6J("ngIf",e.customerList))},directives:[n.Gu,n.sr,n.Sm,n.oU,n.cs,n.W2,n.Nd,n.wI,s.O5,s.sg,s.PC],styles:[""]}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[r.Bz.forChild(b)],r.Bz]}),t})(),T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[s.ez,o.u5,n.Pc,q]]}),t})()},3764:(t,e,i)=>{"use strict";i.d(e,{n:()=>n});var s=i(1572),o=i(2874);let n=(()=>{class t{constructor(t){this.notifi=t}groupArticles(t,e){return new Promise((i,s)=>{e&&this.notifi.presentLoading();let o=[],n=t.reduce((t,e)=>(t[e.categoryName]=[...t[e.categoryName]||[],e],t),{});for(const t in n)o.push(n[t]);e&&this.notifi.dismissLoading(),i(o)})}groupByCustomerId(t){return new Promise((e,i)=>{let s=[],o=t.reduce((t,e)=>(t[e.customerId]=[...t[e.customerId]||[],e],t),{});for(const t in o)s.push(o[t]);e(s)})}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(o.g))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4418:(t,e,i)=>{"use strict";i.d(e,{W:()=>a});var s=i(1344),o=i.n(s),n=i(8512),r=i(1572),c=i(2968);let a=(()=>{class t{constructor(t){this.urlService=t,this.mysocket=new n.X(null),this.sock=!1,this.takeUrl()}takeUrl(){console.log("je demmare ici url"),this.urlService.getUrl().subscribe(t=>{this.url=t,this.adminId=localStorage.getItem("adminId"),this.sockets=o()(this.url),this.mysocket.next(this.sockets)})}getSocket(){return this.mysocket}disconnectSocket(){this.sockets.disconnect()}getMySocket(){return this.sockets}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(c.i))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);