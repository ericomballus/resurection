(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[9611],{9611:(e,t,o)=>{"use strict";o.d(t,{f:()=>Q});var n=o(4762),i=o(7207),r=o(1572),s=o(8158),c=o(5897),l=o(4144),a=o(2874),u=o(731),g=o(4375),d=o(1511),p=o(6073),Z=o(1064);function h(e,t){if(1&e&&(r.TgZ(0,"ion-card"),r._UZ(1,"img",19),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("src",e.product.url,r.LSH)}}function m(e,t){if(1&e&&(r.TgZ(0,"ion-list"),r.YNc(1,h,2,1,"ion-card",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.product.url)}}function f(e,t){if(1&e&&(r.TgZ(0,"ion-select-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.s9C("value",e._id),r.xp6(1),r.Oqu(e.name)}}function q(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"ion-select",20),r.NdJ("ionChange",function(t){return r.CHM(e),r.oxw().test(t)}),r.YNc(5,f,2,2,"ion-select-option",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.AsE("",r.lcZ(3,3,"MENU.categories"),": ",e.product.categoryName?e.product.categoryName:"",""),r.xp6(3),r.Q6J("ngForOf",e.categorys)}}function A(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-input",23),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().product.acceptPrice=t}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngModel",e.product.acceptPrice)}}function b(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2,"prix bouteille vide"),r.qZA(),r.TgZ(3,"ion-input",24),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().product.bottle_empty_Price=t}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("ngModel",e.product.bottle_empty_Price)}}function T(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2,"bouteille pleine"),r.qZA(),r.TgZ(3,"ion-input",25),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().product.bottle_full=t}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("ngModel",e.product.bottle_full)}}function x(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2,"bouteille vide"),r.qZA(),r.TgZ(3,"ion-input",26),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().product.bottle_empty=t}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("ngModel",e.product.bottle_empty)}}function M(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2,"bouteille total"),r.qZA(),r.TgZ(3,"ion-input",27),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().product.bottle_total=t}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("ngModel",e.product.bottle_total)}}function _(e,t){if(1&e&&(r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.userStore[0].name)}}function N(e,t){if(1&e&&(r.TgZ(0,"ion-select-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.s9C("value",e.id),r.xp6(1),r.Oqu(e.name)}}function y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"ion-select",28),r.NdJ("ionChange",function(t){return r.CHM(e),r.oxw().assignStore(t)}),r.YNc(5,N,2,2,"ion-select-option",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,2,"MENU.store")),r.xp6(3),r.Q6J("ngForOf",e.userStore)}}function J(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-item"),r.TgZ(1,"ion-label"),r._uU(2,"Bonus"),r.qZA(),r.TgZ(3,"ion-input",29),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().product.bonus=t}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("ngModel",e.product.bonus)}}function v(e,t){1&e&&(r.TgZ(0,"ion-row"),r.TgZ(1,"ion-col",5),r.TgZ(2,"div",30),r.TgZ(3,"small"),r._uU(4,"resources"),r.qZA(),r.qZA(),r.qZA(),r.qZA())}function C(e,t){1&e&&(r.TgZ(0,"ion-row",31),r.TgZ(1,"ion-col",32),r.TgZ(2,"div",33),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"ion-col",32),r.TgZ(6,"div",33),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.TgZ(9,"ion-col",32),r.TgZ(10,"div",33),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.TgZ(13,"ion-col",32),r.TgZ(14,"div",33),r._uU(15,"Action"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Oqu(r.lcZ(4,3,"MENU.name")),r.xp6(4),r.Oqu(r.lcZ(8,5,"MENU.quantity")),r.xp6(4),r.Oqu(r.lcZ(12,7,"MENU.unit")))}function w(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"ion-button",36),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw().deleteResource(t)}),r._UZ(1,"ion-icon",37),r.qZA()}}const U=function(e){return{"background-color":e}};function R(e,t){if(1&e&&(r.TgZ(0,"ion-row",34),r.TgZ(1,"ion-col",32),r.TgZ(2,"div",33),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"ion-col",32),r.TgZ(5,"div",33),r._uU(6),r.qZA(),r.qZA(),r.TgZ(7,"ion-col",32),r.TgZ(8,"div",33),r._uU(9),r.qZA(),r.qZA(),r.TgZ(10,"ion-col",32),r.TgZ(11,"div",33),r.YNc(12,w,2,0,"ion-button",35),r.qZA(),r.qZA(),r.qZA()),2&e){const e=t.$implicit,o=t.index,n=r.oxw();r.Q6J("ngStyle",r.VKq(5,U,o%2==0?"#f1f1f1":"white")),r.xp6(3),r.Oqu(e.name),r.xp6(3),r.Oqu(e.quantity),r.xp6(3),r.Oqu(e.unitName),r.xp6(3),r.Q6J("ngIf",!n.tabRoles.includes(7))}}let Q=(()=>{class e{constructor(e,t,o,n,i,r){this.modalController=e,this.categorieSerice=t,this.restApi=o,this.notif=n,this.translateConfigService=i,this.saveRandom=r,this.resourceList=[],this.updateResoure=!1,this.useBonus=!1,this.stock_min=0,this.tabRoles=[],this.getCategories()}ngOnInit(){console.log(this.page),console.log(this.product),this.product.acceptPrice||(this.product.acceptPrice=this.product.sellingPrice),this.saveRandom.getSetting().sale_Gaz&&!this.product.bottle_full&&(this.product.bottle_full=0),this.saveRandom.getSetting().sale_Gaz&&!this.product.bottle_empty&&(this.product.bottle_empty=0),this.saveRandom.getSetting().sale_Gaz&&!this.product.bottle_total&&(this.product.bottle_total=0),this.selectedLanguage=this.translateConfigService.getDefaultLanguage(),this.tabRoles=JSON.parse(localStorage.getItem("roles"));let e=JSON.parse(localStorage.getItem("user"));this.userStore=this.tabRoles.includes(7)?[]:e[0].storeId,this.product.quantityToAlert&&(this.stock_min=this.product.quantityToAlert);let t=JSON.parse(localStorage.getItem("setting"))[0];t&&t.use_bonus&&(this.useBonus=!0),this.product.resourceList&&this.product.resourceList.length&&(this.resourceList=this.product.resourceList)}assignStore(e){this.storeId=e.target.value,this.product.storeId=this.storeId}getCategories(){this.categorieSerice.getCategories().subscribe(e=>{this.categorys=e.category.filter(e=>{if(e.page)return e.page==this.page||e.page==this.page+".page";e._id==this.product._id&&e.categoryName&&(this.product.categoryName=e.categoryName)}),console.log(this.categorys)})}test(e){console.log(e),console.log(e.target.value);let t=e.target.value;this.categorystab=this.categorys.filter(e=>e._id===t)[0],this.product.categoryName=this.categorystab.name}closeModal(){this.modalController.dismiss()}update(){return(0,n.mG)(this,void 0,void 0,function*(){if(this.notif.presentLoading(),this.categorystab&&(this.product.categoryName=this.categorystab.name),this.stock_min&&(this.product.quantityToAlert=this.stock_min),(this.resourceList.length||this.updateResoure)&&(this.product.resourceList=this.resourceList),this.file)try{let e=this.updateWithFile();this.product.filename=e.filename,this.product.originalname=e.originalname}catch(e){console.log(e)}this.restApi.updateBillardGame(this.product).subscribe(e=>{this.notif.dismissLoading(),e.url=this.product.url,this.modalController.dismiss({product:e})})})}pickResource(){return(0,n.mG)(this,void 0,void 0,function*(){console.log("ok");const e=yield this.modalController.create({component:i.j,componentProps:{tabs:this.resourceList,page:this.page}});return e.onDidDismiss().then(e=>{console.log(e),e.data&&(this.resourceList=[...this.resourceList,...e.data])}),yield e.present()})}deleteResource(e){console.log(e),this.resourceList=this.resourceList.filter(t=>t.resourceId!==e.resourceId),this.updateResoure=!0,console.log(this.resourceList)}readUrl(e){if(this.file=e.target.files[0],e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=e=>{this.product.url=e.target.result},t.readAsDataURL(e.target.files[0])}}updateWithFile(){return(0,n.mG)(this,void 0,void 0,function*(){return new Promise((e,t)=>{var o=new FormData;o.append("image",this.file),this.restApi.updateProductWithImage(o).subscribe(t=>{console.log(t),e(t)},e=>{t(e)})})})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.IN),r.Y36(c.q),r.Y36(l.e),r.Y36(a.g),r.Y36(u.w),r.Y36(g.i))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-billard-update"]],inputs:{product:"product",page:"page"},decls:54,vars:22,consts:[["color","primary"],["slot","end"],[3,"click"],["slot","icon-only","name","close"],[4,"ngIf"],["size","12"],["padding",""],["desabled","!tabRoles.includes(7)","name","name","type","text","placeholder","Name","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","purchasingPrice","type","number","placeholder","prix d'achat","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","sellingPrice","type","number","placeholder","prix de vente","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","superMarketPrice","type","number","placeholder","prix super March\xe9","required","",3,"ngModel","ngModelChange"],[1,"ion-text-wrap"],["type","number",3,"ngModel","ngModelChange"],["name","image","type","file","required","",3,"change"],["button","",3,"click"],["slot","end","name","add-circle-outline"],["class","header-row",4,"ngIf"],["class","data-row data-update",3,"ngStyle",4,"ngFor","ngForOf"],["color","danger","size","large","expand","block",3,"click"],[3,"src"],["interface","popover",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["desabled","!tabRoles.includes(7)","name","acceptPrice","type","number","placeholder","prix de vente min","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","bottle_empty_Price","type","number","placeholder","bouteille vide","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","bottle_full","type","number","placeholder","prix de vente min","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","bottle_empty","type","number","placeholder","prix de vente min","required","",3,"ngModel","ngModelChange"],["desabled","!tabRoles.includes(7)","name","bottle_total","type","number","placeholder","prix de vente min","required","",3,"ngModel","ngModelChange"],["cancelText","cancel","okText","Okay","interface","popover",3,"ionChange"],["desabled","!tabRoles.includes(7)","name","bonus","type","number","placeholder","product point","required","",3,"ngModel","ngModelChange"],[1,"ion-text-uppercase","ion-text-center"],[1,"header-row"],["size","3",1,"ion-align-self-center"],[1,"ion-text-center"],[1,"data-row","data-update",3,"ngStyle"],["fill","clear","color","primary",3,"click",4,"ngIf"],["fill","clear","color","primary",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(e,t){1&e&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar",0),r._UZ(2,"ion-title"),r.TgZ(3,"ion-buttons",1),r.TgZ(4,"ion-button",2),r.NdJ("click",function(){return t.closeModal()}),r._UZ(5,"ion-icon",3),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"ion-content"),r.YNc(7,m,2,1,"ion-list",4),r.TgZ(8,"ion-row",0),r.TgZ(9,"ion-col",5),r.TgZ(10,"div",6),r.TgZ(11,"ion-item"),r.TgZ(12,"ion-input",7),r.NdJ("ngModelChange",function(e){return t.product.name=e}),r.qZA(),r.qZA(),r.YNc(13,q,6,5,"ion-item",4),r.TgZ(14,"ion-item"),r.TgZ(15,"ion-input",8),r.NdJ("ngModelChange",function(e){return t.product.purchasingPrice=e}),r.qZA(),r.qZA(),r.TgZ(16,"ion-item"),r.TgZ(17,"ion-input",9),r.NdJ("ngModelChange",function(e){return t.product.sellingPrice=e}),r.qZA(),r.qZA(),r.YNc(18,A,2,1,"ion-item",4),r.TgZ(19,"ion-item"),r.TgZ(20,"ion-input",10),r.NdJ("ngModelChange",function(e){return t.product.superMarketPrice=e}),r.qZA(),r.qZA(),r.YNc(21,b,4,1,"ion-item",4),r.YNc(22,T,4,1,"ion-item",4),r.YNc(23,x,4,1,"ion-item",4),r.YNc(24,M,4,1,"ion-item",4),r.YNc(25,_,3,1,"ion-item",4),r.YNc(26,y,6,4,"ion-item",4),r.TgZ(27,"ion-item"),r.TgZ(28,"ion-label",11),r.TgZ(29,"h2"),r._uU(30,"Masse (g):"),r.qZA(),r.qZA(),r.TgZ(31,"ion-input",12),r.NdJ("ngModelChange",function(e){return t.product.masse=e}),r.qZA(),r.qZA(),r.YNc(32,J,4,1,"ion-item",4),r.TgZ(33,"ion-item"),r.TgZ(34,"ion-input",13),r.NdJ("change",function(e){return t.readUrl(e)}),r.qZA(),r.qZA(),r.TgZ(35,"ion-item"),r.TgZ(36,"ion-label",11),r.TgZ(37,"h2"),r._uU(38,"Stock Min Alert"),r.qZA(),r.qZA(),r.TgZ(39,"ion-input",12),r.NdJ("ngModelChange",function(e){return t.stock_min=e}),r.qZA(),r.qZA(),r.TgZ(40,"ion-item",14),r.NdJ("click",function(){return t.pickResource()}),r._UZ(41,"ion-icon",15),r.TgZ(42,"ion-label"),r._uU(43,"Resources"),r.qZA(),r.qZA(),r.qZA(),r.YNc(44,v,5,0,"ion-row",4),r.YNc(45,C,16,9,"ion-row",16),r.YNc(46,R,13,7,"ion-row",17),r._UZ(47,"div",6),r.qZA(),r.qZA(),r.TgZ(48,"ion-row"),r.TgZ(49,"ion-col"),r.TgZ(50,"div",6),r.TgZ(51,"ion-button",18),r.NdJ("click",function(){return t.update()}),r._uU(52),r.ALo(53,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(7),r.Q6J("ngIf",t.product),r.xp6(5),r.Q6J("ngModel",t.product.name),r.xp6(1),r.Q6J("ngIf",!t.tabRoles.includes(7)),r.xp6(2),r.Q6J("ngModel",t.product.purchasingPrice),r.xp6(2),r.Q6J("ngModel",t.product.sellingPrice),r.xp6(1),r.Q6J("ngIf",t.saveRandom.getSetting().change_price),r.xp6(2),r.Q6J("ngModel",t.product.superMarketPrice),r.xp6(1),r.Q6J("ngIf",t.saveRandom.getSetting().sale_Gaz),r.xp6(1),r.Q6J("ngIf",t.saveRandom.getSetting().sale_Gaz),r.xp6(1),r.Q6J("ngIf",t.saveRandom.getSetting().sale_Gaz),r.xp6(1),r.Q6J("ngIf",t.saveRandom.getSetting().sale_Gaz),r.xp6(1),r.Q6J("ngIf",1==t.userStore.length),r.xp6(1),r.Q6J("ngIf",t.userStore.length>1&&!t.tabRoles.includes(7)),r.xp6(5),r.Q6J("ngModel",t.product.masse),r.xp6(1),r.Q6J("ngIf",t.useBonus),r.xp6(7),r.Q6J("ngModel",t.stock_min),r.xp6(5),r.Q6J("ngIf",t.resourceList),r.xp6(1),r.Q6J("ngIf",t.resourceList&&t.resourceList.length),r.xp6(1),r.Q6J("ngForOf",t.resourceList),r.xp6(6),r.Oqu(r.lcZ(53,20,"MENU.save")))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.YG,s.gu,s.W2,d.O5,s.Nd,s.wI,s.Ie,s.pK,s.j9,p.Q7,p.JJ,p.On,s.as,s.Q$,d.sg,s.q_,s.PM,s.t9,s.QI,s.n0,d.PC],pipes:[Z.X$],styles:[""]}),e})()}}]);