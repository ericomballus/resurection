(self.webpackChunkWebsite=self.webpackChunkWebsite||[]).push([[9389],{9389:(t,e,o)=>{"use strict";o.r(e),o.d(e,{ManageitemsPageModule:()=>k});var i=o(1511),s=o(6073),a=o(8777),r=o(8158),n=o(1064),l=o(4762),c=o(1344),d=o.n(c),g=o(1572),u=o(4144),h=o(5946),m=o(4892),p=o(731),Z=o(2968),I=o(866),S=o(4375),f=o(2874);const A=function(t){return{"stock-alert":t}};function q(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-row",6),g.TgZ(1,"ion-col",3),g.TgZ(2,"div",7),g.TgZ(3,"ion-item",8),g.TgZ(4,"ion-avatar",0),g._UZ(5,"img",9),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(6,"ion-col",3),g.TgZ(7,"div",7),g.TgZ(8,"small",10),g._uU(9),g.qZA(),g.qZA(),g.qZA(),g.TgZ(10,"ion-col",3),g.TgZ(11,"div",7),g.TgZ(12,"small",10),g._uU(13),g.qZA(),g.qZA(),g.qZA(),g.TgZ(14,"ion-col",3),g.TgZ(15,"div",7),g.TgZ(16,"small",10),g._uU(17),g.qZA(),g.qZA(),g.qZA(),g.TgZ(18,"ion-col",3),g.TgZ(19,"div",7),g.TgZ(20,"small",10),g._uU(21),g.qZA(),g.qZA(),g.qZA(),g.TgZ(22,"ion-col",3),g.TgZ(23,"div",11),g.NdJ("click",function(){g.CHM(t);const o=e.$implicit;return g.oxw().updateStore(o)}),g.TgZ(24,"small",10),g._uU(25),g.ALo(26,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit,o=g.oxw();g.Q6J("ngClass",g.VKq(10,A,t.quantityItems<=o.stock_min)),g.xp6(5),g.s9C("src",t.url,g.LSH),g.xp6(4),g.hij(" ",t.name,""),g.xp6(4),g.AsE(" ",t.sizeUnitProduct,"",t.unitNameProduct,""),g.xp6(4),g.hij(" ",t.glace?t.quantityStore-t.glace:t.quantityStore,""),g.xp6(4),g.hij(" ",t.glace?t.glace:0,""),g.xp6(4),g.hij(" ",g.lcZ(26,8,"MENU.fresh"),"")}}const b=[{path:"",component:(()=>{class t{constructor(t,e,o,i,s,a,r,n,l,c,d,g){this.restApiService=t,this.alertController=e,this.toastController=o,this.adminService=i,this.socket=s,this.router=a,this.translateConfigService=r,this.translate=n,this.urlService=l,this.warehouseService=c,this.saveRadom=d,this.notification=g,this.checkPack=!1}ngOnInit(){let t=JSON.parse(localStorage.getItem("setting"));Array.isArray(t)?(console.log("is array here"),t[0].SaleInPack?(this.checkPack=!0,localStorage.setItem("saleAsPack","true")):this.checkPack=!1):(console.log("not arra"),t.SaleInPack?(this.checkPack=!0,localStorage.setItem("saleAsPack","true")):this.checkPack=!1),this.checkPack?(this.notification.presentToast("you are using a mode that does not allow you to open this page","danger"),this.router.navigateByUrl("/point-of-sale")):(this.getSetting(),this.takeUrl(),this.adminId=localStorage.getItem("adminId"),this.webServerSocket(this.adminId),setTimeout(()=>{this.takeProductItems()},1e3))}takeUrl(){this.urlService.getUrl().subscribe(t=>{this.url=t})}languageChanged(){console.log("lang shop page");let t=localStorage.getItem("language");t&&this.translateConfigService.setLanguage(t)}takeProductItems(){this.restApiService.getProductItem().subscribe(t=>{let e=JSON.parse(localStorage.getItem("user")).storeId;console.log(t),this.productsItem=t.filter(t=>t.storeId==e)})}webServerSocket(t){this.sockets=d()(this.url),this.sockets.on("connect",function(){}),this.sockets.on(`${t}productItemGlace`,t=>(0,l.mG)(this,void 0,void 0,function*(){if(console.log(t),t&&t._id){let e=yield this.productsItem.findIndex(e=>e._id===t._id);console.log(this.productsItem[e]);let o=this.productsItem[e].url;this.productsItem.splice(e,1,t),this.productsItem[e].url=o}}))}getSetting(){this.adminService.getCompanySetting().subscribe(t=>{console.log(t),t.company.length&&(this.stock_min=t.company[0].stock_min)})}updateStore(t){return(0,l.mG)(this,void 0,void 0,function*(){let e={};console.log(t),this.translate.get("add").subscribe(t=>{console.log("hello translate"),console.log(t),e.title=t}),this.translate.get("cancel").subscribe(t=>{e.cancel=t}),this.translate.get("placeholder").subscribe(t=>{e.placeholder=t});const o=yield this.alertController.create({header:"Available "+(t.quantityStore-t.glace),inputs:[{name:"quantity",type:"number",placeholder:"quantity"}],buttons:[{text:e.cancel,role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:e.title,handler:e=>{console.log("Confirm Ok"),console.log(e),console.log(t),t.glace?t.quantityStore-parseInt(t.glace)-parseInt(e.quantity)<0?this.presentAlert():this.warehouseService.updateIce({id:t._id,quantity:parseInt(e.quantity),prod:t}).subscribe(t=>{console.log(t)},t=>{console.log(t)}):t.quantityStore-parseInt(e.quantity)<0?this.presentAlert():this.warehouseService.updateIce({id:t._id,quantity:parseInt(e.quantity),prod:t}).subscribe(t=>{console.log(t)},t=>{console.log(t)})}}]});yield o.present()})}presentAlert(){return(0,l.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"ALERT",message:"NOT ENOUGTH IN STOCK.",cssClass:"AlertStock",buttons:["OK"]});yield t.present()})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.e),g.Y36(r.Br),g.Y36(r.yF),g.Y36(h.l),g.Y36(m.sk),g.Y36(a.F0),g.Y36(p.w),g.Y36(n.sK),g.Y36(Z.i),g.Y36(I.l),g.Y36(S.i),g.Y36(f.g))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-manageitems"]],decls:35,vars:7,consts:[["slot","start"],["autoHide","false"],[1,"header-row"],["size","2","size-md","2"],[1,"ion-text-center"],["class","data-row data-update",3,"ngClass",4,"ngFor","ngForOf"],[1,"data-row","data-update",3,"ngClass"],[1,"ion-text-center","ion-text-uppercase","ion-text-nowrap"],["lines","none"],[3,"src"],[1,"namesmall"],[1,"ion-text-center","ion-text-uppercase","ion-text-nowrap","smallborder",3,"click"]],template:function(t,e){1&t&&(g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar"),g.TgZ(2,"ion-title"),g._uU(3,"stock"),g.qZA(),g.TgZ(4,"ion-buttons",0),g._UZ(5,"ion-menu-button",1),g.qZA(),g.qZA(),g.qZA(),g.TgZ(6,"ion-content"),g.TgZ(7,"ion-row",2),g.TgZ(8,"ion-col",3),g.TgZ(9,"div",4),g.TgZ(10,"small"),g._uU(11,"logo"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(12,"ion-col",3),g.TgZ(13,"div",4),g.TgZ(14,"small"),g._uU(15,"name"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(16,"ion-col",3),g.TgZ(17,"div",4),g.TgZ(18,"small"),g._uU(19,"capacity"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(20,"ion-col",3),g.TgZ(21,"div",4),g.TgZ(22,"small"),g._uU(23),g.ALo(24,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(25,"ion-col",3),g.TgZ(26,"div",4),g.TgZ(27,"small"),g._uU(28),g.ALo(29,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(30,"ion-col",3),g.TgZ(31,"div",4),g.TgZ(32,"small"),g._uU(33,"action"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.YNc(34,q,27,12,"ion-row",5),g.qZA()),2&t&&(g.xp6(23),g.hij(" ",g.lcZ(24,3,"MENU.noglace"),""),g.xp6(5),g.hij(" ",g.lcZ(29,5,"MENU.glace"),""),g.xp6(6),g.Q6J("ngForOf",e.productsItem))},directives:[r.Gu,r.sr,r.wd,r.Sm,r.fG,r.W2,r.Nd,r.wI,i.sg,i.mk,r.Ie,r.BJ],pipes:[n.X$],styles:[".instock[_ngcontent-%COMP%], .instore[_ngcontent-%COMP%]{font-size:60%;font-weight:700}.instore[_ngcontent-%COMP%]{color:#1c74f7}.btnWarehouse[_ngcontent-%COMP%]{font-size:50%}.stock-alert[_ngcontent-%COMP%]{--ion-background-color:#f85252;--color:#fff;opacity:.9}.stock-alert[_ngcontent-%COMP%]   .instock[_ngcontent-%COMP%], .stock-alert[_ngcontent-%COMP%]   .instore[_ngcontent-%COMP%]{color:#fff}.stock-alert[_ngcontent-%COMP%]   .btnWarehouse[_ngcontent-%COMP%]{--border-color:#000;--color:#000}.smallborder[_ngcontent-%COMP%]{border:1px solid #f1f1f1;border-radius:5px}"]}),t})()}];let k=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[i.ez,s.u5,r.Pc,a.Bz.forChild(b),n.aw.forChild()]]}),t})()},866:(t,e,o)=>{"use strict";o.d(e,{l:()=>l});var i=o(529),s=o(1036),a=o(1572),r=o(9063),n=o(2968);let l=(()=>{class t{constructor(t,e){this.http=t,this.urlService=e,this.url="http://192.168.100.10:3000/",this.takeUrl()}takeUrl(){i.N.production?this.urlService.getUrl().subscribe(t=>{this.url=t,console.log("url",this.url)}):this.url=i.V}updateProductItemStore(t){return this.id=localStorage.getItem("adminId"),this.database=localStorage.getItem("adminemail"),this.http.patch(`${this.url}productsitem/${this.id}/products/store?db=${this.id}`,t)}updateProductItemStore1(t){return this.id=localStorage.getItem("adminId"),this.database=localStorage.getItem("adminemail"),this.http.put(`${this.url}productsitem/${this.id}/products/store?db=${this.id}`,t)}confirmProductItemStore(t){this.id=localStorage.getItem("adminId"),this.database=localStorage.getItem("adminemail");let e="";if(localStorage.getItem("openCashDateId")?e=localStorage.getItem("openCashDateId"):JSON.parse(localStorage.getItem("openCashDateObj"))&&(e=JSON.parse(localStorage.getItem("openCashDateObj"))._id),e)return this.http.patch(`${this.url}productsitem/${this.id}/products/store/confirm?db=${this.id}&openCashDate=${e}`,t)}updateManufacturedItemStore(t){this.id=localStorage.getItem("adminId");let e=localStorage.getItem("openCashDateId");return this.database=localStorage.getItem("adminemail"),this.http.patch(`${this.url}products_resto_item/${this.id}/manufacturedItems/store?db=${this.id}&openCashDate=${e}`,t).pipe()}updateManufacturedItemStoreConfirm(t){this.id=localStorage.getItem("adminId"),this.database=localStorage.getItem("adminemail");let e=localStorage.getItem("openCashDateId");return this.http.patch(`${this.url}products_resto_item/${this.id}/manufacturedItems/store/confirm?db=${this.id}&openCashDate=${e}`,t).pipe()}updateIce(t){return this.id=localStorage.getItem("adminId"),this.database=localStorage.getItem("adminemail"),this.http.patch(`${this.url}productsitem/${this.id}/products/store/confirm/glacer?db=${this.id}`,t)}setProductItem(t){console.log(t),this.product=t}getProductItem(){return(0,s.isNullOrUndefined)(this.product)?0:this.product}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(r.eN),a.LFG(n.i))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);